!function o(s,a,l){function c(t,e){if(!a[t]){if(!s[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(u)return u(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var i=a[t]={exports:{}};s[t][0].call(i.exports,function(e){return c(s[t][1][e]||e)},i,i.exports,o,s,a,l)}return a[t].exports}for(var u="function"==typeof require&&require,e=0;e<l.length;e++)c(l[e]);return c}({1:[function(e,t,r){"use strict";r.__esModule=!0;var n=e("./styles/editor"),i=e("./styles/injector"),o=e("./styles/theme-default"),s=e("./utils/html-escape"),a=e("prismjs"),l=(c.prototype.startEditor=function(){if(!i.injectCss(n.editorCss,null,this.opts.styleParent))throw Error("Failed to inject CodeFlask CSS.");this.createWrapper(),this.createTextarea(),this.createPre(),this.createCode(),this.runOptions(),this.listenTextarea(),this.populateDefault(),this.updateCode(this.code)},c.prototype.createWrapper=function(){this.code=this.editorRoot.innerHTML,this.editorRoot.innerHTML="",this.elWrapper=this.createElement("div",this.editorRoot),this.elWrapper.classList.add("codeflask")},c.prototype.createTextarea=function(){this.elTextarea=this.createElement("textarea",this.elWrapper),this.elTextarea.classList.add("codeflask__textarea","codeflask__flatten")},c.prototype.createPre=function(){this.elPre=this.createElement("pre",this.elWrapper),this.elPre.classList.add("codeflask__pre","codeflask__flatten")},c.prototype.createCode=function(){this.elCode=this.createElement("code",this.elPre),this.elCode.classList.add("codeflask__code","language-"+(this.opts.language||"html"))},c.prototype.createLineNumbers=function(){this.elLineNumbers=this.createElement("div",this.elWrapper),this.elLineNumbers.classList.add("codeflask__lines"),this.setLineNumber()},c.prototype.createElement=function(e,t){var r=document.createElement(e);return t.appendChild(r),r},c.prototype.runOptions=function(){this.opts.rtl=this.opts.rtl||!1,this.opts.tabSize=this.opts.tabSize||2,this.opts.enableAutocorrect=this.opts.enableAutocorrect||!1,this.opts.lineNumbers=this.opts.lineNumbers||!1,this.opts.defaultTheme=!1!==this.opts.defaultTheme,this.opts.areaId=this.opts.areaId||null,this.opts.ariaLabelledby=this.opts.ariaLabelledby||null,this.opts.readonly=this.opts.readonly||null,"boolean"!=typeof this.opts.handleTabs&&(this.opts.handleTabs=!0),"boolean"!=typeof this.opts.handleSelfClosingCharacters&&(this.opts.handleSelfClosingCharacters=!0),"boolean"!=typeof this.opts.handleNewLineIndentation&&(this.opts.handleNewLineIndentation=!0),!0===this.opts.rtl&&(this.elTextarea.setAttribute("dir","rtl"),this.elPre.setAttribute("dir","rtl")),!1===this.opts.enableAutocorrect&&(this.elTextarea.setAttribute("spellcheck","false"),this.elTextarea.setAttribute("autocapitalize","off"),this.elTextarea.setAttribute("autocomplete","off"),this.elTextarea.setAttribute("autocorrect","off")),this.opts.lineNumbers&&(this.elWrapper.classList.add("codeflask--has-line-numbers"),this.createLineNumbers()),this.opts.defaultTheme&&i.injectCss(o.defaultCssTheme,"theme-default",this.opts.styleParent),this.opts.areaId&&this.elTextarea.setAttribute("id",this.opts.areaId),this.opts.ariaLabelledby&&this.elTextarea.setAttribute("aria-labelledby",this.opts.ariaLabelledby),this.opts.readonly&&this.enableReadonlyMode()},c.prototype.updateLineNumbersCount=function(){for(var e="",t=1;t<=this.lineNumber;t++)e=e+'<span class="codeflask__lines__line">'+t+"</span>";this.elLineNumbers.innerHTML=e},c.prototype.listenTextarea=function(){var t=this;this.elTextarea.addEventListener("input",function(e){t.code=e.target.value,t.elCode.innerHTML=s.escapeHtml(e.target.value),t.highlight(),setTimeout(function(){t.runUpdate(),t.setLineNumber()},1)}),this.elTextarea.addEventListener("keydown",function(e){t.handleTabs(e),t.handleSelfClosingCharacters(e),t.handleNewLineIndentation(e)}),this.elTextarea.addEventListener("scroll",function(e){t.elPre.style.transform="translate3d(-"+e.target.scrollLeft+"px, -"+e.target.scrollTop+"px, 0)",t.elLineNumbers&&(t.elLineNumbers.style.transform="translate3d(0, -"+e.target.scrollTop+"px, 0)")})},c.prototype.handleTabs=function(e){if(this.opts.handleTabs){if(9!==e.keyCode)return;e.preventDefault();var t=this.elTextarea,r=t.selectionDirection,n=t.selectionStart,i=t.selectionEnd,o=t.value,s=o.substr(0,n),a=o.substring(n,i),l=o.substring(i),c=" ".repeat(this.opts.tabSize);if(n!==i&&a.length>=c.length){var u=n-s.split("\n").pop().length,h=c.length,f=c.length;a=e.shiftKey?(o.substr(u,c.length)===c?(h=-h,n<u?(a=a.substring(0,u)+a.substring(u+c.length),f=0):u===n?(f=h=0,a=a.substring(c.length)):(f=-f,s=s.substring(0,u)+s.substring(u+c.length))):f=h=0,a.replace(new RegExp("\n"+c.split("").join("\\"),"g"),"\n")):(s=s.substr(0,u)+c+s.substring(u,n),a.replace(/\n/g,"\n"+c)),t.value=s+a+l,t.selectionStart=n+h,t.selectionEnd=n+a.length+f,t.selectionDirection=r}else t.value=s+c+l,t.selectionStart=n+c.length,t.selectionEnd=n+c.length;var d=t.value;this.updateCode(d),this.elTextarea.selectionEnd=i+this.opts.tabSize}},c.prototype.handleSelfClosingCharacters=function(e){if(this.opts.handleSelfClosingCharacters){var t=e.key;if(["(","[","{","<","'",'"'].includes(t)||[")","]","}",">","'",'"'].includes(t))switch(t){case"(":case")":this.closeCharacter(t);break;case"[":case"]":this.closeCharacter(t);break;case"{":case"}":this.closeCharacter(t);break;case"<":case">":case"'":case'"':this.closeCharacter(t)}}},c.prototype.setLineNumber=function(){this.lineNumber=this.code.split("\n").length,this.opts.lineNumbers&&this.updateLineNumbersCount()},c.prototype.handleNewLineIndentation=function(e){if(this.opts.handleNewLineIndentation&&13===e.keyCode){e.preventDefault();var t=this.elTextarea,r=t.selectionStart,n=t.selectionEnd,i=t.value,o=i.substr(0,r),s=i.substring(n),a=i.lastIndexOf("\n",r-1),l=a+i.slice(a+1).search(/[^ ]|$/),c=a<l?l-a:0,u=o+"\n"+" ".repeat(c)+s;t.value=u,t.selectionStart=r+c+1,t.selectionEnd=r+c+1,this.updateCode(t.value)}},c.prototype.closeCharacter=function(e){var t=this.elTextarea.selectionStart,r=this.elTextarea.selectionEnd;if(this.skipCloseChar(e)){var n=this.code.substr(r,1)===e,i=n?r+1:r;o=!n&&["'",'"'].includes(e)?e:"",a=""+this.code.substring(0,t)+o+this.code.substring(i),this.updateCode(a),this.elTextarea.selectionEnd=++this.elTextarea.selectionStart}else{var o=e;switch(e){case"(":o=String.fromCharCode(e.charCodeAt()+1);break;case"<":case"{":case"[":o=String.fromCharCode(e.charCodeAt()+2)}var s=this.code.substring(t,r),a=""+this.code.substring(0,t)+s+o+this.code.substring(r);this.updateCode(a)}this.elTextarea.selectionEnd=t},c.prototype.skipCloseChar=function(e){var t=this.elTextarea.selectionStart,r=this.elTextarea.selectionEnd,n=0<Math.abs(r-t);return[")","}","]",">"].includes(e)||["'",'"'].includes(e)&&!n},c.prototype.updateCode=function(e){this.code=e,this.elTextarea.value=e,this.elCode.innerHTML=s.escapeHtml(e),this.highlight(),this.setLineNumber(),setTimeout(this.runUpdate.bind(this),1)},c.prototype.updateLanguage=function(e){var t=this.opts.language;this.elCode.classList.remove("language-"+t),this.elCode.classList.add("language-"+e),this.opts.language=e,this.highlight()},c.prototype.addLanguage=function(e,t){a.languages[e]=t},c.prototype.populateDefault=function(){this.updateCode(this.code)},c.prototype.highlight=function(){a.highlightElement(this.elCode,!1)},c.prototype.onUpdate=function(e){if(e&&"[object Function]"!=={}.toString.call(e))throw Error("CodeFlask expects callback of type Function");this.updateCallBack=e},c.prototype.getCode=function(){return this.code},c.prototype.runUpdate=function(){this.updateCallBack&&this.updateCallBack(this.code)},c.prototype.enableReadonlyMode=function(){this.elTextarea.setAttribute("readonly",!0)},c.prototype.disableReadonlyMode=function(){this.elTextarea.removeAttribute("readonly")},c);function c(e,t){if(!e)throw Error("CodeFlask expects a parameter which is Element or a String selector");if(!t)throw Error("CodeFlask expects an object containing options as second parameter");if(e.nodeType)this.editorRoot=e;else{var r=document.querySelector(e);r&&(this.editorRoot=r)}this.opts=t,this.startEditor()}r.default=l},{"./styles/editor":2,"./styles/injector":3,"./styles/theme-default":4,"./utils/html-escape":6,prismjs:10}],2:[function(e,t,r){"use strict";r.__esModule=!0;var n=e("./theme-default"),i='"SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace',o=e("../utils/css-supports").cssSupports("caret-color","#000")?n.BACKGROUND_COLOR:"#ccc",s="40px";r.editorCss="\n  .codeflask {\n    position: relative;\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n  }\n\n  .codeflask, .codeflask * {\n    box-sizing: border-box;\n  }\n\n  .codeflask__pre {\n    pointer-events: none;\n    z-index: 0;\n    overflow: hidden;\n  }\n\n  .codeflask__textarea {\n    background: none;\n    border: none;\n    color: "+o+";\n    resize: none;\n    font-family: "+i+";\n    -webkit-appearance: pre;\n    caret-color: #111;\n    z-index: 0;\n    width: 100%;\n    height: 100%;\n  }\n\n  .codeflask--has-line-numbers .codeflask__textarea {\n    width: calc(100% - "+s+");\n  }\n\n  .codeflask__code {\n    display: block;\n    font-family: "+i+";\n    overflow: hidden;\n  }\n\n  .codeflask__flatten {\n    padding: 10px;\n    padding-left: 0px;\n    font-size: "+n.FONT_SIZE+";\n    line-height: "+n.LINE_HEIGHT+";\n    white-space: pre;\n    position: absolute;\n    top: 0;\n    left: 0;\n    overflow: auto;\n    margin: 0 !important;\n    outline: none;\n    text-align: left;\n  }\n\n  .codeflask--has-line-numbers .codeflask__flatten {\n    width: calc(100% - "+s+");\n    left: "+s+";\n  }\n\n  .codeflask__line-highlight {\n    position: absolute;\n    top: 10px;\n    left: 0;\n    width: 100%;\n    height: "+n.LINE_HEIGHT+";\n    background: rgba(0,0,0,0.1);\n    z-index: 1;\n  }\n\n  .codeflask__lines {\n    padding: 10px 4px;\n    font-size: 12px;\n    line-height: "+n.LINE_HEIGHT+";\n    font-family: 'Cousine', monospace;\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: "+s+";\n    height: 100%;\n    text-align: right;\n    color: #999;\n    z-index: 2;\n  }\n\n  .codeflask__lines__line {\n    display: block;\n  }\n\n  .codeflask.codeflask--has-line-numbers {\n    padding-left: "+s+";\n  }\n\n  .codeflask.codeflask--has-line-numbers:before {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: "+s+";\n    height: 100%;\n    background: #eee;\n    z-index: 1;\n  }\n"},{"../utils/css-supports":5,"./theme-default":4}],3:[function(e,t,r){"use strict";r.__esModule=!0,r.injectCss=function(e,t,r){var n=t||"codeflask-style",i=r||document.head;if(!e)return!1;if(document.getElementById(n))return!0;var o=document.createElement("style");return o.innerHTML=e,o.id=n,i.appendChild(o),!0}},{}],4:[function(e,t,r){"use strict";r.__esModule=!0,r.BACKGROUND_COLOR="#fff",r.LINE_HEIGHT="20px",r.FONT_SIZE="13px",r.defaultCssTheme="\n.codeflask {\n  background: "+r.BACKGROUND_COLOR+";\n  color: #4f559c;\n}\n\n.codeflask .token.punctuation {\n  color: #4a4a4a;\n}\n\n.codeflask .token.keyword {\n  color: #8500ff;\n}\n\n.codeflask .token.operator {\n  color: #ff5598;\n}\n\n.codeflask .token.string {\n  color: #41ad8f;\n}\n\n.codeflask .token.comment {\n  color: #9badb7;\n}\n\n.codeflask .token.function {\n  color: #8500ff;\n}\n\n.codeflask .token.boolean {\n  color: #8500ff;\n}\n\n.codeflask .token.number {\n  color: #8500ff;\n}\n\n.codeflask .token.selector {\n  color: #8500ff;\n}\n\n.codeflask .token.property {\n  color: #8500ff;\n}\n\n.codeflask .token.tag {\n  color: #8500ff;\n}\n\n.codeflask .token.attr-value {\n  color: #8500ff;\n}\n"},{}],5:[function(e,t,r){"use strict";function n(e){return(e=e.split("-").filter(function(e){return!!e}).map(function(e){return e[0].toUpperCase()+e.substr(1)}).join(""))[0].toLowerCase()+e.substr(1)}r.__esModule=!0,r.cssSupports=function(e,t){return"undefined"!=typeof CSS?CSS.supports(e,t):"undefined"!=typeof document&&n(e)in document.body.style},r.toCamelCase=n},{}],6:[function(e,t,r){"use strict";r.__esModule=!0;var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};r.escapeHtml=function(e){return String(e).replace(/[&<>"'`=/]/g,function(e){return n[e]})}},{}],7:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(o,s,a,l){return new(a=a||Promise)(function(e,t){function r(e){try{i(l.next(e))}catch(e){t(e)}}function n(e){try{i(l.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(r,n)}i((l=l.apply(o,s||[])).next())})},__generator=this&&this.__generator||function(r,n){var i,o,s,e,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(s=2&t[0]?o.return:t[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,t[1])).done)return s;switch(o=0,s&&(t=[2&t[0],s.value]),t[0]){case 0:case 1:s=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,o=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){a.label=t[1];break}if(6===t[0]&&a.label<s[1]){a.label=s[1],s=t;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(t);break}s[2]&&a.ops.pop(),a.trys.pop();continue}t=n.call(r,a)}catch(e){t=[6,e],o=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},_this=this;exports.__esModule=!0;var element=function(e,t){return document.createElement(e,t)},append=function(e,t){return e.appendChild(t)},load_text=function(t){return __awaiter(_this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,Promise.all(t.map(function(e){return fetch(e).then(function(e){return e.text()})}))];case 1:return[2,e.sent()]}})})},rand=function(e,t){return void 0===t&&(t=e,e=0),e+Math.random()*(t-e)},twgl_js_1=require("twgl.js"),typestyle_1=require("typestyle"),codeflask_1=require("./editor/codeflask"),localforage_1=require("localforage"),xterm_1=require("xterm"),fit=require("xterm/lib/addons/fit/fit"),log=console.log,error=console.error,clear=console.clear;clear();var instance_demo=function(h,e,t){for(var f=twgl_js_1.createProgramInfo(h,[e,t]),r=new Float32Array(16e5),n=new Array,i=0;i<1e5;++i){var o=new Float32Array(r.buffer,16*i*4,16);twgl_js_1.m4.translation([rand(-70,70),rand(-70,70),rand(-70,70)],o),twgl_js_1.m4.rotateZ(o,rand(0,2*Math.PI),o),twgl_js_1.m4.rotateX(o,rand(0,2*Math.PI),o),n.push(rand(1),rand(1),rand(1))}var s=twgl_js_1.primitives.createPlaneVertices();Object.assign(s,{instanceWorld:{numComponents:16,data:r,divisor:1},instanceColor:{numComponents:3,data:n,divisor:1}});var a=twgl_js_1.createBufferInfoFromArrays(h,s),d=twgl_js_1.createVertexArrayInfo(h,f,a);return function(e){e/=1e3;var t=window.devicePixelRatio,r=h.canvas;r.width=r.clientWidth*t,r.height=r.clientHeight*t,h.viewport(0,0,h.canvas.width,h.canvas.height),h.enable(h.DEPTH_TEST),h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT);var n=30*Math.PI/180,i=h.canvas.clientWidth/h.canvas.clientHeight,o=twgl_js_1.m4.perspective(n,i,.5,500),s=.1*e,a=[25*Math.sin(s),10*Math.sin(.7*s),25*Math.cos(s)],l=twgl_js_1.m4.lookAt(a,[0,0,0],[0,1,0]),c=twgl_js_1.m4.inverse(l),u={u_lightWorldPos:[1,8,-30],u_lightColor:[1,1,1,1],u_ambient:[0,0,0,1],u_specular:[1,1,1,1],u_shininess:50,u_specularFactor:1,u_viewProjection:twgl_js_1.m4.multiply(o,c),u_viewInverse:l};h.useProgram(f.program),twgl_js_1.setBuffersAndAttributes(h,f,d),twgl_js_1.setUniforms(f,u),twgl_js_1.drawBufferInfo(h,d,h.TRIANGLES,d.numElements,0,1e5)}},RenderLoop=(Dc.prototype.start=function(){return requestAnimationFrame(this.loop),this},Dc.prototype.add=function(e){return this.callback_arr.push(e),this},Dc);function Dc(e){var n=this;this.loop=function(r){if(r/=1e3,n.max_frame<0||n.frame_count<n.max_frame){if(requestAnimationFrame(n.loop),0<n.frame_count)try{n.callback_arr.forEach(function(t){return __awaiter(n,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,t(r)];case 1:return[2,e.sent()]}})})})}catch(e){error(e)}n.frame_count+=1,n.prev_time=r}},this.callback_arr=[],this.frame_count=0,this.max_frame=-1,this.prev_time=0,"number"==typeof e&&0<=e&&(this.max_frame=e)}var Element=(Lc.prototype.style=function(e){return this.element.className=typestyle_1.style(e),this},Lc.prototype.child=function(e){return e instanceof Lc?this.element.appendChild(e.element):this.element.appendChild(e),this},Lc.prototype.content=function(e){return this.element.textContent=e,this},Lc);function Lc(e,t){e instanceof HTMLElement?this.element=e:this.element=document.createElement(e,t)}var Vec2=function(e,t){this.x=0,this.y=0,this.x="number"==typeof e?e:0,this.y="number"==typeof t?t:0},MatrixRP2=function(e,t,r,n,i,o){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this.a="number"==typeof e?e:1,this.b="number"==typeof t?t:0,this.c="number"==typeof r?r:0,this.d="number"==typeof n?n:1,this.e="number"==typeof i?i:0,this.f="number"==typeof o?o:0},multiply=function(e,t){return new MatrixRP2(e.a*t.a+e.c*t.b,e.b*t.a+e.d*t.b,e.a*t.c+e.c*t.d,e.b*t.c+e.d*t.d,e.a*t.e+e.c*t.f+e.e,e.b*t.e+e.d*t.f+e.f)},scale=function(e,t){return void 0===e&&(e=1),void 0===t&&(t=1),new MatrixRP2(e,0,0,t)},rotate=function(e){void 0===e&&(e=0);var t=[Math.cos(e),Math.sin(e)],r=t[0],n=t[1];return new MatrixRP2(r,n,-n,r)},translate=function(e,t){return void 0===e&&(e=0),new MatrixRP2(1,0,0,1,e,t)},shear=function(e,t){return new MatrixRP2(1,t,e)},multimatrix=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];switch(e.length){case 0:throw new Error("no matrices provided");case 1:return e[0];case 2:return multiply(e[0],e[1]);default:return e.reduce(function(e,t,r){return 0===r?t:multiply(e,t)})}},drawPath=function(t,e,r,n){for(var i in t.save(),n)"fill"!==i&&(t[i]=n[i]);var o=r.a,s=r.b,a=r.c,l=r.d,c=r.e,u=r.f;t.transform(o,s,a,l,c,u),t.beginPath(),0<e.length&&(t.moveTo(e[0].x,e[0].y),e.forEach(function(e){t.lineTo(e.x,e.y)}),t.lineTo(e[0].x,e[0].y)),t.stroke(),n&&!0===n.fill&&t.fill(),t.restore()},vec2Array=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce(function(e,t,r){return r%2==0?e.push(new Vec2(t,0)):e[e.length-1].y=t,e},new Array)},bullet_editor=function(){return __awaiter(_this,void 0,void 0,function(){var canvas,crc,max_frame,render_loop,sin,cos,atan2,repeat,toward_speed_vector,game,div_editor,div_canvas,div_setting,editor_1,code_1,csk_1,saved_code,runCode_1,reload_code_button,load_code_button,clear_bullet_button,saveCode_1,bullets,drawEditor;return __generator(this,function(_a){switch(_a.label){case 0:return canvas=new Element("canvas").style({width:"100%",height:"100%"}).element,crc=canvas.getContext("2d"),max_frame=-1,render_loop=new RenderLoop(max_frame),sin=Math.sin,cos=Math.cos,atan2=Math.atan2,repeat=function(i){return function(e,t){if(t<e)return[];for(var r=[],n=((0,Math.floor)(e/i)+1)*i;n<t;)r.push(n),n+=i;return r}},toward_speed_vector=function(e,t){var r={x:e.x-t.x,y:e.y-t.y},n=0,i=1;return atan2(n*r.y-i*r.x,n*r.x+i*r.y)},game=void 0,div_editor=new Element("div").style({paddingLeft:10,width:"100%",height:400}).element,div_canvas=new Element("div").style({width:400,height:400}).child(canvas),div_setting=new Element("div"),new Element(document.body).style({overflow:"hidden",display:"flex",flexWrap:"wrap"}).child(div_editor).child(div_canvas).child(div_setting),editor_1=new codeflask_1.default(div_editor,{language:"js"}),code_1="// Test code\nconst bullet = (init_time, x, y) => {\n  const v = { x, y };\n  return (t, pt) => {\n    const st = t - init_time;\n    const pst = pt - init_time;\n    const p = { x: st * v.x, y: st * v.y };\n    const pp = { x: pst * v.x, y: pst * v.y };\n    return multimatrix(\n      translate(p.x, p.y),\n      rotate(toward_speed_vector(p, pp)),\n    );\n  }\n};\nconst spawn = (t, pt) => repeat(0.05)(pt, t).map(v => {\n  const s = 100; // speed\n  return [\n    bullet(v, s * cos(v), s * sin(v)),\n    bullet(v, -s * cos(v), s * sin(v)),\n    bullet(v, s * cos(v), -s * sin(v)),\n    bullet(v, -s * cos(v), -s * sin(v)),\n  ];\n});\n\n({spawn});",csk_1="code",[4,localforage_1.getItem(csk_1)];case 1:return saved_code=_a.sent(),editor_1.updateCode(saved_code||code_1),runCode_1=function(code){var game_setting=eval(code);game=function(){return game_setting}},runCode_1(editor_1.getCode()),reload_code_button=new Element("button").content("init code").element,reload_code_button.addEventListener("click",function(){return editor_1.updateCode(code_1)}),load_code_button=new Element("button").content("load code").element,load_code_button.addEventListener("click",function(){return runCode_1(editor_1.getCode())}),clear_bullet_button=new Element("button").content("clear bullet").element,clear_bullet_button.addEventListener("click",function(){return bullets=[]}),div_setting.child(load_code_button).child(reload_code_button).child(clear_bullet_button),saveCode_1=function(e){e&&localforage_1.setItem(csk_1,e)},document.addEventListener("keydown",function(e){("Enter"===e.key&&!0===e.altKey||"r"===e.key&&!0===e.altKey||"s"===e.key&&!0===e.ctrlKey||"Alt"===e.key)&&e.preventDefault()}),document.addEventListener("keyup",function(e){if("Enter"===e.key&&!0===e.altKey||"r"===e.key&&!0===e.altKey||"s"===e.key&&!0===e.ctrlKey){var t=editor_1.getCode();runCode_1(t);"s"===e.key&&!0===e.ctrlKey&&(saveCode_1(t),log("["+(new Date).toLocaleTimeString()+"] Code has been saved."))}}),render_loop.start(),bullets=new Array,drawEditor=function(e){var t=window.devicePixelRatio||1,o=canvas.width=canvas.clientWidth*t,s=canvas.height=canvas.clientHeight*t;crc.clearRect(0,0,canvas.width,canvas.height),crc.translate(canvas.width/2,canvas.height/2),crc.scale(1,-1);var i={strokeStyle:"#aaa",lineWidth:1*t},r=Math.ceil,a=o/15,n=[-o/2,-s/2,o/2,s/2],l=n[0],c=n[1],u=n[2],h=n[3];new Array(r(7.5)).fill(0).map(function(e,t){return t}).forEach(function(e){var t=[e*a,e*a],r=t[0],n=t[1];drawPath(crc,vec2Array(l,n,u,n),new MatrixRP2,i),drawPath(crc,vec2Array(r,c,r,h),new MatrixRP2,i),drawPath(crc,vec2Array(l,-n,u,-n),new MatrixRP2,i),drawPath(crc,vec2Array(-r,c,-r,h),new MatrixRP2,i)}),drawPath(crc,vec2Array(0,0,0,0,0,0),new MatrixRP2,{strokeStyle:"#777",lineWidth:6,lineCap:"round"});var f=e,d=render_loop.prev_time,p=200*t,_=translate(p*cos(e),p*sin(e));drawPath(crc,vec2Array(0,0,0,0,0,0),_,{strokeStyle:"#f00",lineWidth:8,lineCap:"round"});var m=10*e;drawPath(crc,vec2Array(10,10,10,-10,-10,-10,-10,10),rotate(m)),drawPath(crc,vec2Array(12,12,12,-12,-12,-12,-12,12),rotate(m));var y={strokeStyle:"blue",lineWidth:1};game().spawn(f,d).forEach(function(e){Array.isArray(e)?e.forEach(function(e){return bullets.push(e)}):bullets.push(e)}),bullets=bullets.filter(function(e){var t=e(f,d);return!function(e,t){var r=o/2,n=s/2,i=[-r,r,-n,n];return!(i[0]<e&&e<i[1]&&i[2]<t&&t<i[3])}(t.e,t.f)}).map(function(e){return function(e,t){void 0===t&&(t=2),drawPath(crc,vec2Array(-2*t,-t,0,4*t,2*t,-t),multimatrix(e),y)}(e(f,d)),e})},render_loop.add(drawEditor),[2]}})})};bullet_editor(),xterm_1.Terminal.applyAddon(fit);var term=new xterm_1.Terminal({allowTransparency:!0,theme:{background:"rgb(0,0,0,0)"}}),div_terminal=new Element("div").style({position:"absolute",left:"10%",right:"10%",top:"10%",bottom:"10%"}).element,div_fullscreen=new Element("div").style({position:"fixed",width:"100%",height:"100%",background:"rgb(0,0,0,0.8)"}).child(div_terminal).element;new Element(document.body).child(div_fullscreen),term.open(div_terminal),term.on("key",function(e){log(e,e.charAt(0),e.charCodeAt(0)),13==e.charCodeAt(0)&&term.write("\n"),term.write(e)}),window.addEventListener("resize",function(){return term.fit()});var hello_word='Welcome to dmk.js shell!\n\rPress "`" to hide This terminal.';window.addEventListener("load",function(){term.fit(),term.write(hello_word)}),window.addEventListener("keypress",function(e){"`"===e.key&&(div_fullscreen.hidden=!div_fullscreen.hidden)})},{"./editor/codeflask":1,localforage:9,"twgl.js":12,typestyle:13,xterm:55,"xterm/lib/addons/fit/fit":37}],8:[function(e,t,H){(function(n){"use strict";var i,e=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(H,"__esModule",{value:!0});var b=0;H.IS_UNIQUE="__DO_NOT_DEDUPE_STYLE__";for(var t=/[A-Z]/g,r=/^ms-/,o=/&/g,s=/[ !#$%&()*+,./;<=>?@[\]^`{|}~"'\\]/g,a=function(e){return"-"+e.toLowerCase()},l={"animation-iteration-count":!0,"border-image-outset":!0,"border-image-slice":!0,"border-image-width":!0,"box-flex":!0,"box-flex-group":!0,"box-ordinal-group":!0,"column-count":!0,columns:!0,"counter-increment":!0,"counter-reset":!0,flex:!0,"flex-grow":!0,"flex-positive":!0,"flex-shrink":!0,"flex-negative":!0,"flex-order":!0,"font-weight":!0,"grid-area":!0,"grid-column":!0,"grid-column-end":!0,"grid-column-span":!0,"grid-column-start":!0,"grid-row":!0,"grid-row-end":!0,"grid-row-span":!0,"grid-row-start":!0,"line-clamp":!0,"line-height":!0,opacity:!0,order:!0,orphans:!0,"tab-size":!0,widows:!0,"z-index":!0,zoom:!0,"fill-opacity":!0,"flood-opacity":!0,"stop-opacity":!0,"stroke-dasharray":!0,"stroke-dashoffset":!0,"stroke-miterlimit":!0,"stroke-opacity":!0,"stroke-width":!0},c=0,u=Object.keys(l);c<u.length;c++)for(var h=u[c],f=0,d=["-webkit-","-ms-","-moz-","-o-",""];f<d.length;f++){l[d[f]+h]=!0}function p(e){return e.replace(t,a).replace(r,"-ms-")}function _(e){for(var t=5381,r=e.length;r--;)t=33*t^e.charCodeAt(r);return(t>>>0).toString(36)}function m(e,t){return"number"!=typeof t||0===t||l.hasOwnProperty(e)?e+":"+t:e+":"+t+"px"}function y(e){return e.sort(function(e,t){return e[0]>t[0]?1:-1})}function v(e,t){for(var r=[],n=[],i=!1,o=0,s=Object.keys(e);o<s.length;o++){var a=s[o],l=e[a];null!=l&&(a===H.IS_UNIQUE?i=!0:"object"!=typeof l||Array.isArray(l)?r.push([p(a.trim()),l]):n.push([a.trim(),l]))}return{style:function(e){return e.map(function(e){var t=e[0],r=e[1];return Array.isArray(r)?r.map(function(e){return m(t,e)}).join(";"):m(t,r)}).join(";")}(y(r)),nested:t?n:y(n),isUnique:i}}function C(e,t){return-1===e.indexOf("&")?t+" "+e:e.replace(o,t)}function w(e,t,r,n,i){var o=v(t,""!==e),s=o.style,a=o.nested,l=o.isUnique,c=s;if(64===e.charCodeAt(0)){var u={selector:e,styles:[],rules:[],style:i?"":s};r.push(u),s&&i&&u.styles.push({selector:i,style:s,isUnique:l});for(var h=0,f=a;h<f.length;h++){var d=f[h];c+=(y=d[0])+w(y,d[1],u.rules,u.styles,i)}}else{var p=i?C(e,i):e;s&&n.push({selector:p,style:s,isUnique:l});for(var _=0,m=a;_<m.length;_++){var y,g=m[_];c+=(y=g[0])+w(y,g[1],r,n,p)}}return c}function E(e,t,r,n,i,o){for(var s=0,a=n;s<a.length;s++){var l=a[s],c=l.selector,u=l.style,h=l.isUnique,f=o?C(c,i):c,d=h?"u\0"+(++b).toString(36):"s\0"+t+"\0"+u;(m=new k(u,d)).add(new T(f,"k\0"+t+"\0"+f)),e.add(m)}for(var p=0,_=r;p<_.length;p++){var m,y=_[p],g=(c=y.selector,u=y.style,y.rules),v=y.styles;E(m=new D(c,u,"r\0"+t+"\0"+c+"\0"+u),t,g,v,i,o),e.add(m)}}function g(e){for(var t="",r=0;r<e.length;r++)t+=e[r];return t}H.escape=function(e){return e.replace(s,"\\$&")},H.hyphenate=p,H.stringHash=_;var S={add:function(){},change:function(){},remove:function(){}},x=(A.prototype.add=function(e){var t=this._counters[e.id]||0,r=this._children[e.id]||e.clone();if(this._counters[e.id]=t+1,0===t)this._children[r.id]=r,this._keys.push(r.id),this.sheet.push(r.getStyles()),this.changeId++,this.changes.add(r,this._keys.length-1);else if(r instanceof A&&e instanceof A){var n=this._keys.indexOf(e.id),i=r.changeId;r.merge(e),r.changeId!==i&&(this.sheet.splice(n,1,r.getStyles()),this.changeId++,this.changes.change(r,n,n))}return r},A.prototype.remove=function(e){var t=this._counters[e.id];if(void 0!==t&&0<t){this._counters[e.id]=t-1;var r=this._children[e.id],n=this._keys.indexOf(r.id);if(1===t)delete this._counters[e.id],delete this._children[e.id],this._keys.splice(n,1),this.sheet.splice(n,1),this.changeId++,this.changes.remove(r,n);else if(r instanceof A&&e instanceof A){var i=r.changeId;r.unmerge(e),r.changeId!==i&&(this.sheet.splice(n,1,r.getStyles()),this.changeId++,this.changes.change(r,n,n))}}},A.prototype.values=function(){var t=this;return this._keys.map(function(e){return t._children[e]})},A.prototype.merge=function(e){for(var t=0,r=e.values();t<r.length;t++){var n=r[t];this.add(n)}return this},A.prototype.unmerge=function(e){for(var t=0,r=e.values();t<r.length;t++){var n=r[t];this.remove(n)}return this},A.prototype.clone=function(){return(new A).merge(this)},A);function A(e){void 0===e&&(e=S),this.changes=e,this.sheet=[],this.changeId=0,this._keys=[],this._children=Object.create(null),this._counters=Object.create(null)}H.Cache=x;var T=(R.prototype.getStyles=function(){return this.selector},R.prototype.clone=function(){return new R(this.selector,this.id)},R);function R(e,t){this.selector=e,this.id=t}H.Selector=T;var L,k=(e(M,L=x),M.prototype.getStyles=function(){return this.sheet.join(",")+"{"+this.style+"}"},M.prototype.clone=function(){return new M(this.style,this.id).merge(this)},M);function M(e,t){var r=L.call(this)||this;return r.style=e,r.id=t,r}H.Style=k;var O,D=(e(F,O=x),F.prototype.getStyles=function(){return this.rule+"{"+this.style+g(this.sheet)+"}"},F.prototype.clone=function(){return new F(this.rule,this.style,this.id).merge(this)},F);function F(e,t,r){var n=O.call(this)||this;return n.rule=e,n.style=t,n.id=r,n}H.Rule=D;var P,B=(e(I,P=x),I.prototype.registerStyle=function(e,t){var r=[],n=[],i=w("&",e,r,n),o="f"+this.hash(i),s=this.debug&&t?t+"_"+o:o;return E(this,i,r,n,"."+H.escape(s),!0),s},I.prototype.registerKeyframes=function(e,t){return this.registerHashRule("@keyframes",e,t)},I.prototype.registerHashRule=function(e,t,r){var n=[],i=[],o=w("",t,n,i),s="f"+this.hash(o),a=this.debug&&r?r+"_"+s:s,l=new D(e+" "+H.escape(a),"","h\0"+o+"\0"+e);return E(l,o,n,i,"",!1),this.add(l),a},I.prototype.registerRule=function(e,t){var r=[],n=[];E(this,w(e,t,r,n),r,n,"",!1)},I.prototype.registerCss=function(e){return this.registerRule("",e)},I.prototype.getStyles=function(){return g(this.sheet)},I.prototype.clone=function(){return new I(this.hash,this.debug,this.id,this.changes).merge(this)},I);function I(e,t,r,n){var i=P.call(this,n)||this;return i.hash=e,i.debug=t,i.id=r,i}H.FreeStyle=B,H.create=function(e,t,r){return void 0===e&&(e=_),void 0===t&&(t=void 0!==n&&"production"!==n.env.NODE_ENV),void 0===r&&(r=S),new B(e,t,"f"+(++b).toString(36),r)}}).call(this,e("_process"))},{_process:11}],9:[function(h,t,r){(function(n){!function(e){if("object"==typeof r&&void 0!==t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:this).localforage=e()}}(function(){return function o(s,a,l){function c(r,e){if(!a[r]){if(!s[r]){var t="function"==typeof h&&h;if(!e&&t)return t(r,!0);if(u)return u(r,!0);var n=new Error("Cannot find module '"+r+"'");throw n.code="MODULE_NOT_FOUND",n}var i=a[r]={exports:{}};s[r][0].call(i.exports,function(e){var t=s[r][1][e];return c(t||e)},i,i.exports,o,s,a,l)}return a[r].exports}for(var u="function"==typeof h&&h,e=0;e<l.length;e++)c(l[e]);return c}({1:[function(e,u,t){(function(t){"use strict";var r,n,e=t.MutationObserver||t.WebKitMutationObserver;if(e){var i=0,o=new e(c),s=t.document.createTextNode("");o.observe(s,{characterData:!0}),r=function(){s.data=i=++i%2}}else if(t.setImmediate||void 0===t.MessageChannel)r="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){c(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(c,0)};else{var a=new t.MessageChannel;a.port1.onmessage=c,r=function(){a.port2.postMessage(0)}}var l=[];function c(){var e,t;n=!0;for(var r=l.length;r;){for(t=l,l=[],e=-1;++e<r;)t[e]();r=l.length}n=!1}u.exports=function(e){1!==l.push(e)||n||r()}}).call(this,void 0!==n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,r){"use strict";var i=e(1);function c(){}var u={},o=["REJECTED"],s=["FULFILLED"],n=["PENDING"];function a(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=n,this.queue=[],this.outcome=void 0,e!==c&&d(this,e)}function l(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function h(t,r,n){i(function(){var e;try{e=r(n)}catch(e){return u.reject(t,e)}e===t?u.reject(t,new TypeError("Cannot resolve promise with itself")):u.resolve(t,e)})}function f(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function d(t,e){var r=!1;function n(e){r||(r=!0,u.reject(t,e))}function i(e){r||(r=!0,u.resolve(t,e))}var o=p(function(){e(i,n)});"error"===o.status&&n(o.value)}function p(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}(t.exports=a).prototype.catch=function(e){return this.then(null,e)},a.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===o)return this;var r=new this.constructor(c);this.state!==n?h(r,this.state===s?e:t,this.outcome):this.queue.push(new l(r,e,t));return r},l.prototype.callFulfilled=function(e){u.resolve(this.promise,e)},l.prototype.otherCallFulfilled=function(e){h(this.promise,this.onFulfilled,e)},l.prototype.callRejected=function(e){u.reject(this.promise,e)},l.prototype.otherCallRejected=function(e){h(this.promise,this.onRejected,e)},u.resolve=function(e,t){var r=p(f,t);if("error"===r.status)return u.reject(e,r.value);var n=r.value;if(n)d(e,n);else{e.state=s,e.outcome=t;for(var i=-1,o=e.queue.length;++i<o;)e.queue[i].callFulfilled(t)}return e},u.reject=function(e,t){e.state=o,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},a.resolve=function(e){if(e instanceof this)return e;return u.resolve(new this(c),e)},a.reject=function(e){var t=new this(c);return u.reject(t,e)},a.all=function(e){var r=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,i=!1;if(!n)return this.resolve([]);var o=new Array(n),s=0,t=-1,a=new this(c);for(;++t<n;)l(e[t],t);return a;function l(e,t){r.resolve(e).then(function(e){o[t]=e,++s!==n||i||(i=!0,u.resolve(a,o))},function(e){i||(i=!0,u.reject(a,e))})}},a.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);var i=-1,o=new this(c);for(;++i<r;)s=e[i],t.resolve(s).then(function(e){n||(n=!0,u.resolve(o,e))},function(e){n||(n=!0,u.reject(o,e))});var s;return o}},{1:1}],3:[function(t,e,r){(function(e){"use strict";"function"!=typeof e.Promise&&(e.Promise=t(2))}).call(this,void 0!==n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var a=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function s(t,r){t=t||[],r=r||{};try{return new Blob(t,r)}catch(e){if("TypeError"!==e.name)throw e;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),i=0;i<t.length;i+=1)n.append(t[i]);return n.getBlob(r.type)}}"undefined"==typeof Promise&&e(3);var h=Promise;function f(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}function l(e,t,r){"function"==typeof t&&e.then(t),"function"==typeof r&&e.catch(r)}function d(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function o(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var c="local-forage-detect-blob-support",i=void 0,u={},p=Object.prototype.toString,_="readonly",m="readwrite";function y(e){return"boolean"==typeof i?h.resolve(i):function(n){return new h(function(r){var e=n.transaction(c,m),t=s([""]);e.objectStore(c).put(t,"key"),e.onabort=function(e){e.preventDefault(),e.stopPropagation(),r(!1)},e.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),t=navigator.userAgent.match(/Edge\//);r(t||!e||43<=parseInt(e[1],10))}}).catch(function(){return!1})}(e).then(function(e){return i=e})}function g(e){var t=u[e.name],r={};r.promise=new h(function(e,t){r.resolve=e,r.reject=t}),t.deferredOperations.push(r),t.dbReady?t.dbReady=t.dbReady.then(function(){return r.promise}):t.dbReady=r.promise}function v(e){var t=u[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function b(e,t){var r=u[e.name].deferredOperations.pop();if(r)return r.reject(t),r.promise}function C(i,o){return new h(function(e,t){if(u[i.name]=u[i.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},i.db){if(!o)return e(i.db);g(i),i.db.close()}var r=[i.name];o&&r.push(i.version);var n=a.open.apply(a,r);o&&(n.onupgradeneeded=function(t){var e=n.result;try{e.createObjectStore(i.storeName),t.oldVersion<=1&&e.createObjectStore(c)}catch(e){if("ConstraintError"!==e.name)throw e;console.warn('The database "'+i.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+i.storeName+'" already exists.')}}),n.onerror=function(e){e.preventDefault(),t(n.error)},n.onsuccess=function(){e(n.result),v(i)}})}function w(e){return C(e,!1)}function E(e){return C(e,!0)}function S(e,t){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),n=e.version<e.db.version,i=e.version>e.db.version;if(n&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),i||r){if(r){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function x(e){return s([function(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r),i=0;i<t;i++)n[i]=e.charCodeAt(i);return r}(atob(e.data))],{type:e.type})}function A(e){return e&&e.__local_forage_encoded_blob}function T(e){var t=this,r=t._initReady().then(function(){var e=u[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return l(r,e,e),r}function R(t,r,n,i){void 0===i&&(i=1);try{var e=t.db.transaction(t.storeName,r);n(null,e)}catch(e){if(0<i&&(!t.db||"InvalidStateError"===e.name||"NotFoundError"===e.name))return h.resolve().then(function(){if(!t.db||"NotFoundError"===e.name&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),E(t)}).then(function(){return function(r){g(r);for(var n=u[r.name],i=n.forages,e=0;e<i.length;e++){var t=i[e];t._dbInfo.db&&(t._dbInfo.db.close(),t._dbInfo.db=null)}return r.db=null,w(r).then(function(e){return r.db=e,S(r)?E(r):e}).then(function(e){r.db=n.db=e;for(var t=0;t<i.length;t++)i[t]._dbInfo.db=e}).catch(function(e){throw b(r,e),e})}(t).then(function(){R(t,r,n,i-1)})}).catch(n);n(e)}}var L={_driver:"asyncStorage",_initStorage:function(e){var n=this,i={db:null};if(e)for(var t in e)i[t]=e[t];var o=u[i.name];o||(o={forages:[],db:null,dbReady:null,deferredOperations:[]},u[i.name]=o),o.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=T);var r=[];function s(){return h.resolve()}for(var a=0;a<o.forages.length;a++){var l=o.forages[a];l!==n&&r.push(l._initReady().catch(s))}var c=o.forages.slice(0);return h.all(r).then(function(){return i.db=o.db,w(i)}).then(function(e){return i.db=e,S(i,n._defaultConfig.version)?E(i):e}).then(function(e){i.db=o.db=e,n._dbInfo=i;for(var t=0;t<c.length;t++){var r=c[t];r!==n&&(r._dbInfo.db=i.db,r._dbInfo.version=i.version)}})},_support:function(){try{if(!a)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(s,e){var a=this,t=new h(function(o,r){a.ready().then(function(){R(a._dbInfo,_,function(e,t){if(e)return r(e);try{var n=t.objectStore(a._dbInfo.storeName).openCursor(),i=1;n.onsuccess=function(){var e=n.result;if(e){var t=e.value;A(t)&&(t=x(t));var r=s(t,e.key,i++);void 0!==r?o(r):e.continue()}else o()},n.onerror=function(){r(n.error)}}catch(e){r(e)}})}).catch(r)});return f(t,e),t},getItem:function(o,e){var s=this;o=d(o);var t=new h(function(n,i){s.ready().then(function(){R(s._dbInfo,_,function(e,t){if(e)return i(e);try{var r=t.objectStore(s._dbInfo.storeName).get(o);r.onsuccess=function(){var e=r.result;void 0===e&&(e=null),A(e)&&(e=x(e)),n(e)},r.onerror=function(){i(r.error)}}catch(e){i(e)}})}).catch(i)});return f(t,e),t},setItem:function(a,t,e){var l=this;a=d(a);var r=new h(function(o,s){var e;l.ready().then(function(){return e=l._dbInfo,"[object Blob]"===p.call(t)?y(e.db).then(function(e){return e?t:function(n){return new h(function(r,e){var t=new FileReader;t.onerror=e,t.onloadend=function(e){var t=btoa(e.target.result||"");r({__local_forage_encoded_blob:!0,data:t,type:n.type})},t.readAsBinaryString(n)})}(t)}):t}).then(function(i){R(l._dbInfo,m,function(e,t){if(e)return s(e);try{var r=t.objectStore(l._dbInfo.storeName);null===i&&(i=void 0);var n=r.put(i,a);t.oncomplete=function(){void 0===i&&(i=null),o(i)},t.onabort=t.onerror=function(){var e=n.error?n.error:n.transaction.error;s(e)}}catch(e){s(e)}})}).catch(s)});return f(r,e),r},removeItem:function(o,e){var s=this;o=d(o);var t=new h(function(n,i){s.ready().then(function(){R(s._dbInfo,m,function(e,t){if(e)return i(e);try{var r=t.objectStore(s._dbInfo.storeName).delete(o);t.oncomplete=function(){n()},t.onerror=function(){i(r.error)},t.onabort=function(){var e=r.error?r.error:r.transaction.error;i(e)}}catch(e){i(e)}})}).catch(i)});return f(t,e),t},clear:function(e){var o=this,t=new h(function(n,i){o.ready().then(function(){R(o._dbInfo,m,function(e,t){if(e)return i(e);try{var r=t.objectStore(o._dbInfo.storeName).clear();t.oncomplete=function(){n()},t.onabort=t.onerror=function(){var e=r.error?r.error:r.transaction.error;i(e)}}catch(e){i(e)}})}).catch(i)});return f(t,e),t},length:function(e){var o=this,t=new h(function(n,i){o.ready().then(function(){R(o._dbInfo,_,function(e,t){if(e)return i(e);try{var r=t.objectStore(o._dbInfo.storeName).count();r.onsuccess=function(){n(r.result)},r.onerror=function(){i(r.error)}}catch(e){i(e)}})}).catch(i)});return f(t,e),t},key:function(a,e){var l=this,t=new h(function(o,s){a<0?o(null):l.ready().then(function(){R(l._dbInfo,_,function(e,t){if(e)return s(e);try{var r=t.objectStore(l._dbInfo.storeName),n=!1,i=r.openCursor();i.onsuccess=function(){var e=i.result;e?0===a?o(e.key):n?o(e.key):(n=!0,e.advance(a)):o(null)},i.onerror=function(){s(i.error)}}catch(e){s(e)}})}).catch(s)});return f(t,e),t},keys:function(e){var s=this,t=new h(function(i,o){s.ready().then(function(){R(s._dbInfo,_,function(e,t){if(e)return o(e);try{var r=t.objectStore(s._dbInfo.storeName).openCursor(),n=[];r.onsuccess=function(){var e=r.result;e?(n.push(e.key),e.continue()):i(n)},r.onerror=function(){o(r.error)}}catch(e){o(e)}})}).catch(o)});return f(t,e),t},dropInstance:function(s,e){e=o.apply(this,arguments);var t,r=this.config();if((s="function"!=typeof s&&s||{}).name||(s.name=s.name||r.name,s.storeName=s.storeName||r.storeName),s.name){var n=s.name===r.name&&this._dbInfo.db?h.resolve(this._dbInfo.db):w(s).then(function(e){var t=u[s.name],r=t.forages;t.db=e;for(var n=0;n<r.length;n++)r[n]._dbInfo.db=e;return e});t=s.storeName?n.then(function(e){if(e.objectStoreNames.contains(s.storeName)){var i=e.version+1;g(s);var n=u[s.name],o=n.forages;e.close();for(var t=0;t<o.length;t++){var r=o[t];r._dbInfo.db=null,r._dbInfo.version=i}return new h(function(t,r){var n=a.open(s.name,i);n.onerror=function(e){n.result.close(),r(e)},n.onupgradeneeded=function(){n.result.deleteObjectStore(s.storeName)},n.onsuccess=function(){var e=n.result;e.close(),t(e)}}).then(function(e){n.db=e;for(var t=0;t<o.length;t++){var r=o[t];r._dbInfo.db=e,v(r._dbInfo)}}).catch(function(e){throw(b(s,e)||h.resolve()).catch(function(){}),e})}}):n.then(function(e){g(s);var r=u[s.name],n=r.forages;e.close();for(var t=0;t<n.length;t++){n[t]._dbInfo.db=null}return new h(function(t,r){var n=a.deleteDatabase(s.name);n.onerror=n.onblocked=function(e){var t=n.result;t&&t.close(),r(e)},n.onsuccess=function(){var e=n.result;e&&e.close(),t(e)}}).then(function(e){r.db=e;for(var t=0;t<n.length;t++){v(n[t]._dbInfo)}}).catch(function(e){throw(b(s,e)||h.resolve()).catch(function(){}),e})})}else t=h.reject("Invalid arguments");return f(t,e),t}};var k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",M=/^~~local_forage_type~([^~]+)~/,O="__lfsc__:",D=O.length,F="arbf",P="blob",B=D+F.length,I=Object.prototype.toString;function H(e){var t,r,n,i,o,s=.75*e.length,a=e.length,l=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var c=new ArrayBuffer(s),u=new Uint8Array(c);for(t=0;t<a;t+=4)r=k.indexOf(e[t]),n=k.indexOf(e[t+1]),i=k.indexOf(e[t+2]),o=k.indexOf(e[t+3]),u[l++]=r<<2|n>>4,u[l++]=(15&n)<<4|i>>2,u[l++]=(3&i)<<6|63&o;return c}function U(e){var t,r=new Uint8Array(e),n="";for(t=0;t<r.length;t+=3)n+=k[r[t]>>2],n+=k[(3&r[t])<<4|r[t+1]>>4],n+=k[(15&r[t+1])<<2|r[t+2]>>6],n+=k[63&r[t+2]];return r.length%3==2?n=n.substring(0,n.length-1)+"=":r.length%3==1&&(n=n.substring(0,n.length-2)+"=="),n}var j={serialize:function(t,r){var e="";if(t&&(e=I.call(t)),t&&("[object ArrayBuffer]"===e||t.buffer&&"[object ArrayBuffer]"===I.call(t.buffer))){var n,i=O;t instanceof ArrayBuffer?(n=t,i+=F):(n=t.buffer,"[object Int8Array]"===e?i+="si08":"[object Uint8Array]"===e?i+="ui08":"[object Uint8ClampedArray]"===e?i+="uic8":"[object Int16Array]"===e?i+="si16":"[object Uint16Array]"===e?i+="ur16":"[object Int32Array]"===e?i+="si32":"[object Uint32Array]"===e?i+="ui32":"[object Float32Array]"===e?i+="fl32":"[object Float64Array]"===e?i+="fl64":r(new Error("Failed to get type for BinaryArray"))),r(i+U(n))}else if("[object Blob]"===e){var o=new FileReader;o.onload=function(){var e="~~local_forage_type~"+t.type+"~"+U(this.result);r(O+P+e)},o.readAsArrayBuffer(t)}else try{r(JSON.stringify(t))}catch(e){console.error("Couldn't convert value into a JSON string: ",t),r(null,e)}},deserialize:function(e){if(e.substring(0,D)!==O)return JSON.parse(e);var t,r=e.substring(B),n=e.substring(D,B);if(n===P&&M.test(r)){var i=r.match(M);t=i[1],r=r.substring(i[0].length)}var o=H(r);switch(n){case F:return o;case P:return s([o],{type:t});case"si08":return new Int8Array(o);case"ui08":return new Uint8Array(o);case"uic8":return new Uint8ClampedArray(o);case"si16":return new Int16Array(o);case"ur16":return new Uint16Array(o);case"si32":return new Int32Array(o);case"ui32":return new Uint32Array(o);case"fl32":return new Float32Array(o);case"fl64":return new Float64Array(o);default:throw new Error("Unkown type: "+n)}},stringToBuffer:H,bufferToString:U};function N(e,t,r,n){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,n)}function W(e,n,i,o,s,a){e.executeSql(i,o,s,function(e,r){r.code===r.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[n.storeName],function(e,t){t.rows.length?a(e,r):N(e,n,function(){e.executeSql(i,o,s,a)},a)},a):a(e,r)},a)}var z={_driver:"webSQLStorage",_initStorage:function(e){var n=this,i={db:null};if(e)for(var t in e)i[t]="string"!=typeof e[t]?e[t].toString():e[t];var r=new h(function(t,r){try{i.db=openDatabase(i.name,String(i.version),i.description,i.size)}catch(e){return r(e)}i.db.transaction(function(e){N(e,i,function(){n._dbInfo=i,t()},function(e,t){r(t)})},r)});return i.serializer=j,r},_support:"function"==typeof openDatabase,iterate:function(c,e){var t=this,r=new h(function(l,r){t.ready().then(function(){var a=t._dbInfo;a.db.transaction(function(e){W(e,a,"SELECT * FROM "+a.storeName,[],function(e,t){for(var r=t.rows,n=r.length,i=0;i<n;i++){var o=r.item(i),s=o.value;if(s=s&&a.serializer.deserialize(s),void 0!==(s=c(s,o.key,i+1)))return void l(s)}l()},function(e,t){r(t)})})}).catch(r)});return f(r,e),r},getItem:function(t,e){var o=this;t=d(t);var r=new h(function(i,r){o.ready().then(function(){var n=o._dbInfo;n.db.transaction(function(e){W(e,n,"SELECT * FROM "+n.storeName+" WHERE key = ? LIMIT 1",[t],function(e,t){var r=t.rows.length?t.rows.item(0).value:null;r=r&&n.serializer.deserialize(r),i(r)},function(e,t){r(t)})})}).catch(r)});return f(r,e),r},setItem:function(e,t,r){return function s(a,e,l,c){var u=this;a=d(a);var t=new h(function(i,o){u.ready().then(function(){void 0===e&&(e=null);var r=e,n=u._dbInfo;n.serializer.serialize(e,function(t,e){e?o(e):n.db.transaction(function(e){W(e,n,"INSERT OR REPLACE INTO "+n.storeName+" (key, value) VALUES (?, ?)",[a,t],function(){i(r)},function(e,t){o(t)})},function(e){if(e.code===e.QUOTA_ERR){if(0<c)return void i(s.apply(u,[a,r,l,c-1]));o(e)}})})}).catch(o)});return f(t,l),t}.apply(this,[e,t,r,1])},removeItem:function(i,e){var o=this;i=d(i);var t=new h(function(r,n){o.ready().then(function(){var t=o._dbInfo;t.db.transaction(function(e){W(e,t,"DELETE FROM "+t.storeName+" WHERE key = ?",[i],function(){r()},function(e,t){n(t)})})}).catch(n)});return f(t,e),t},clear:function(e){var i=this,t=new h(function(r,n){i.ready().then(function(){var t=i._dbInfo;t.db.transaction(function(e){W(e,t,"DELETE FROM "+t.storeName,[],function(){r()},function(e,t){n(t)})})}).catch(n)});return f(t,e),t},length:function(e){var i=this,t=new h(function(n,r){i.ready().then(function(){var t=i._dbInfo;t.db.transaction(function(e){W(e,t,"SELECT COUNT(key) as c FROM "+t.storeName,[],function(e,t){var r=t.rows.item(0).c;n(r)},function(e,t){r(t)})})}).catch(r)});return f(t,e),t},key:function(i,e){var o=this,t=new h(function(n,r){o.ready().then(function(){var t=o._dbInfo;t.db.transaction(function(e){W(e,t,"SELECT key FROM "+t.storeName+" WHERE id = ? LIMIT 1",[i+1],function(e,t){var r=t.rows.length?t.rows.item(0).key:null;n(r)},function(e,t){r(t)})})}).catch(r)});return f(t,e),t},keys:function(e){var n=this,t=new h(function(i,r){n.ready().then(function(){var t=n._dbInfo;t.db.transaction(function(e){W(e,t,"SELECT key FROM "+t.storeName,[],function(e,t){for(var r=[],n=0;n<t.rows.length;n++)r.push(t.rows.item(n).key);i(r)},function(e,t){r(t)})})}).catch(r)});return f(t,e),t},dropInstance:function(r,e){e=o.apply(this,arguments);var n=this.config();(r="function"!=typeof r&&r||{}).name||(r.name=r.name||n.name,r.storeName=r.storeName||n.storeName);var t,i=this;return f(t=r.name?new h(function(e){var t;t=r.name===n.name?i._dbInfo.db:openDatabase(r.name,"","",0),r.storeName?e({db:t,storeNames:[r.storeName]}):e(function(o){return new h(function(i,r){o.transaction(function(e){e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(e,t){for(var r=[],n=0;n<t.rows.length;n++)r.push(t.rows.item(n).name);i({db:o,storeNames:r})},function(e,t){r(t)})},function(e){r(e)})})}(t))}).then(function(a){return new h(function(o,s){a.db.transaction(function(n){function e(t){return new h(function(e,r){n.executeSql("DROP TABLE IF EXISTS "+t,[],function(){e()},function(e,t){r(t)})})}for(var t=[],r=0,i=a.storeNames.length;r<i;r++)t.push(e(a.storeNames[r]));h.all(t).then(function(){o()}).catch(function(e){s(e)})},function(e){s(e)})})}):h.reject("Invalid arguments"),e),t}};function G(e,t){var r=e.name+"/";return e.storeName!==t.storeName&&(r+=e.storeName+"/"),r}function K(){return!function(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}()||0<localStorage.length}function X(e,t){for(var r,n,i=e.length,o=0;o<i;){if((r=e[o])===(n=t)||"number"==typeof r&&"number"==typeof n&&isNaN(r)&&isNaN(n))return!0;o++}return!1}var V={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var r in e)t[r]=e[r];return t.keyPrefix=G(e,this._defaultConfig),K()?((this._dbInfo=t).serializer=j,h.resolve()):h.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(l,e){var c=this,t=c.ready().then(function(){for(var e=c._dbInfo,t=e.keyPrefix,r=t.length,n=localStorage.length,i=1,o=0;o<n;o++){var s=localStorage.key(o);if(0===s.indexOf(t)){var a=localStorage.getItem(s);if(a=a&&e.serializer.deserialize(a),void 0!==(a=l(a,s.substring(r),i++)))return a}}});return f(t,e),t},getItem:function(r,e){var n=this;r=d(r);var t=n.ready().then(function(){var e=n._dbInfo,t=localStorage.getItem(e.keyPrefix+r);return t=t&&e.serializer.deserialize(t)});return f(t,e),t},setItem:function(s,e,t){var a=this;s=d(s);var r=a.ready().then(function(){void 0===e&&(e=null);var o=e;return new h(function(r,n){var i=a._dbInfo;i.serializer.serialize(e,function(e,t){if(t)n(t);else try{localStorage.setItem(i.keyPrefix+s,e),r(o)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||n(e),n(e)}})})});return f(r,t),r},removeItem:function(t,e){var r=this;t=d(t);var n=r.ready().then(function(){var e=r._dbInfo;localStorage.removeItem(e.keyPrefix+t)});return f(n,e),n},clear:function(e){var n=this,t=n.ready().then(function(){for(var e=n._dbInfo.keyPrefix,t=localStorage.length-1;0<=t;t--){var r=localStorage.key(t);0===r.indexOf(e)&&localStorage.removeItem(r)}});return f(t,e),t},length:function(e){var t=this.keys().then(function(e){return e.length});return f(t,e),t},key:function(r,e){var n=this,t=n.ready().then(function(){var t,e=n._dbInfo;try{t=localStorage.key(r)}catch(e){t=null}return t=t&&t.substring(e.keyPrefix.length)});return f(t,e),t},keys:function(e){var o=this,t=o.ready().then(function(){for(var e=o._dbInfo,t=localStorage.length,r=[],n=0;n<t;n++){var i=localStorage.key(n);0===i.indexOf(e.keyPrefix)&&r.push(i.substring(e.keyPrefix.length))}return r});return f(t,e),t},dropInstance:function(t,e){if(e=o.apply(this,arguments),!(t="function"!=typeof t&&t||{}).name){var r=this.config();t.name=t.name||r.name,t.storeName=t.storeName||r.storeName}var n,i=this;return f(n=t.name?new h(function(e){t.storeName?e(G(t,i._defaultConfig)):e(t.name+"/")}).then(function(e){for(var t=localStorage.length-1;0<=t;t--){var r=localStorage.key(t);0===r.indexOf(e)&&localStorage.removeItem(r)}}):h.reject("Invalid arguments"),e),n}},q=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Y={},Z={},J={INDEXEDDB:L,WEBSQL:z,LOCALSTORAGE:V},$=[J.INDEXEDDB._driver,J.WEBSQL._driver,J.LOCALSTORAGE._driver],Q=["dropInstance"],ee=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Q),te={description:"",driver:$.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function re(t,r){t[r]=function(){var e=arguments;return t.ready().then(function(){return t[r].apply(t,e)})}}function ne(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];if(r)for(var n in r)r.hasOwnProperty(n)&&(q(r[n])?e[n]=r[n].slice():e[n]=r[n])}return e}function ie(e){for(var t in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ie),J)if(J.hasOwnProperty(t)){var r=J[t],n=r._driver;this[t]=n,Y[n]||this.defineDriver(r)}this._defaultConfig=ne({},te),this._config=ne({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}var oe=new(ie.prototype.config=function(e){if("object"!==(void 0===e?"undefined":n(e)))return"string"==typeof e?this._config[e]:this._config;if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e&&e.driver)||this.setDriver(this._config.driver)},ie.prototype.defineDriver=function(c,e,t){var r=new h(function(t,r){try{var n=c._driver,e=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!c._driver)return void r(e);for(var i=ee.concat("_initStorage"),o=0,s=i.length;o<s;o++){var a=i[o];if((!X(Q,a)||c[a])&&"function"!=typeof c[a])return void r(e)}!function(){for(var e=function(r){return function(){var e=new Error("Method "+r+" is not implemented by the current driver"),t=h.reject(e);return f(t,arguments[arguments.length-1]),t}},t=0,r=Q.length;t<r;t++){var n=Q[t];c[n]||(c[n]=e(n))}}();var l=function(e){Y[n]&&console.info("Redefining LocalForage driver: "+n),Y[n]=c,Z[n]=e,t()};"_support"in c?c._support&&"function"==typeof c._support?c._support().then(l,r):l(!!c._support):l(!0)}catch(e){r(e)}});return l(r,e,t),r},ie.prototype.driver=function(){return this._driver||null},ie.prototype.getDriver=function(e,t,r){var n=Y[e]?h.resolve(Y[e]):h.reject(new Error("Driver not found."));return l(n,t,r),n},ie.prototype.getSerializer=function(e){var t=h.resolve(j);return l(t,e),t},ie.prototype.ready=function(e){var t=this,r=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return l(r,e,e),r},ie.prototype.setDriver=function(e,t,r){var o=this;q(e)||(e=[e]);var n=this._getSupportedDrivers(e);function s(){o._config.driver=o.driver()}function a(e){return o._extend(e),s(),o._ready=o._initStorage(o._config),o._ready}var i=null!==this._driverSet?this._driverSet.catch(function(){return h.resolve()}):h.resolve();return this._driverSet=i.then(function(){var e=n[0];return o._dbInfo=null,o._ready=null,o.getDriver(e).then(function(e){o._driver=e._driver,s(),o._wrapLibraryMethodsWithReady(),o._initDriver=function(i){return function(){var n=0;return function e(){for(;n<i.length;){var t=i[n];return n++,o._dbInfo=null,o._ready=null,o.getDriver(t).then(a).catch(e)}s();var r=new Error("No available storage method found.");return o._driverSet=h.reject(r),o._driverSet}()}}(n)})}).catch(function(){s();var e=new Error("No available storage method found.");return o._driverSet=h.reject(e),o._driverSet}),l(this._driverSet,t,r),this._driverSet},ie.prototype.supports=function(e){return!!Z[e]},ie.prototype._extend=function(e){ne(this,e)},ie.prototype._getSupportedDrivers=function(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r];this.supports(i)&&t.push(i)}return t},ie.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=ee.length;e<t;e++)re(this,ee[e])},ie.prototype.createInstance=function(e){return new ie(e)},ie);t.exports=oe},{3:3}]},{},[4])(4)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],10:[function(e,t,r){(function(e){var c=function(c){var u=/\blang(?:uage)?-([\w-]+)\b/i,t=0,M={manual:c.Prism&&c.Prism.manual,disableWorkerMessageHandler:c.Prism&&c.Prism.disableWorkerMessageHandler,util:{encode:function(e){return e instanceof O?new O(e.type,M.util.encode(e.content),e.alias):Array.isArray(e)?e.map(M.util.encode):e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).slice(8,-1)},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++t}),e.__id},clone:function r(e,n){var i,t,o=M.util.type(e);switch(n=n||{},o){case"Object":if(t=M.util.objId(e),n[t])return n[t];for(var s in i={},n[t]=i,e)e.hasOwnProperty(s)&&(i[s]=r(e[s],n));return i;case"Array":return t=M.util.objId(e),n[t]?n[t]:(i=[],n[t]=i,e.forEach(function(e,t){i[t]=r(e,n)}),i);default:return e}}},languages:{extend:function(e,t){var r=M.util.clone(M.languages[e]);for(var n in t)r[n]=t[n];return r},insertBefore:function(r,e,t,n){var i=(n=n||M.languages)[r],o={};for(var s in i)if(i.hasOwnProperty(s)){if(s==e)for(var a in t)t.hasOwnProperty(a)&&(o[a]=t[a]);t.hasOwnProperty(s)||(o[s]=i[s])}var l=n[r];return n[r]=o,M.languages.DFS(M.languages,function(e,t){t===l&&e!=r&&(this[e]=o)}),o},DFS:function e(t,r,n,i){i=i||{};var o=M.util.objId;for(var s in t)if(t.hasOwnProperty(s)){r.call(t,s,t[s],n||s);var a=t[s],l=M.util.type(a);"Object"!==l||i[o(a)]?"Array"!==l||i[o(a)]||(i[o(a)]=!0,e(a,r,s,i)):(i[o(a)]=!0,e(a,r,null,i))}}},plugins:{},highlightAll:function(e,t){M.highlightAllUnder(document,e,t)},highlightAllUnder:function(e,t,r){var n={callback:r,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};M.hooks.run("before-highlightall",n);for(var i,o=n.elements||e.querySelectorAll(n.selector),s=0;i=o[s++];)M.highlightElement(i,!0===t,n.callback)},highlightElement:function(e,t,r){for(var n,i,o=e;o&&!u.test(o.className);)o=o.parentNode;o&&(n=(o.className.match(u)||[,""])[1].toLowerCase(),i=M.languages[n]),e.className=e.className.replace(u,"").replace(/\s+/g," ")+" language-"+n,e.parentNode&&(o=e.parentNode,/pre/i.test(o.nodeName)&&(o.className=o.className.replace(u,"").replace(/\s+/g," ")+" language-"+n));function s(e){a.highlightedCode=e,M.hooks.run("before-insert",a),a.element.innerHTML=a.highlightedCode,M.hooks.run("after-highlight",a),M.hooks.run("complete",a),r&&r.call(a.element)}var a={element:e,language:n,grammar:i,code:e.textContent};if(M.hooks.run("before-sanity-check",a),a.code)if(M.hooks.run("before-highlight",a),a.grammar)if(t&&c.Worker){var l=new Worker(M.filename);l.onmessage=function(e){s(e.data)},l.postMessage(JSON.stringify({language:a.language,code:a.code,immediateClose:!0}))}else s(M.highlight(a.code,a.grammar,a.language));else s(M.util.encode(a.code));else M.hooks.run("complete",a)},highlight:function(e,t,r){var n={code:e,grammar:t,language:r};return M.hooks.run("before-tokenize",n),n.tokens=M.tokenize(n.code,n.grammar),M.hooks.run("after-tokenize",n),O.stringify(M.util.encode(n.tokens),n.language)},matchGrammar:function(e,t,r,n,i,o,s){for(var a in r)if(r.hasOwnProperty(a)&&r[a]){if(a==s)return;var l=r[a];l="Array"===M.util.type(l)?l:[l];for(var c=0;c<l.length;++c){var u=l[c],h=u.inside,f=!!u.lookbehind,d=!!u.greedy,p=0,_=u.alias;if(d&&!u.pattern.global){var m=u.pattern.toString().match(/[imuy]*$/)[0];u.pattern=RegExp(u.pattern.source,m+"g")}u=u.pattern||u;for(var y=n,g=i;y<t.length;g+=t[y].length,++y){var v=t[y];if(t.length>e.length)return;if(!(v instanceof O)){if(d&&y!=t.length-1){if(u.lastIndex=g,!(x=u.exec(e)))break;for(var b=x.index+(f?x[1].length:0),C=x.index+x[0].length,w=y,E=g,S=t.length;w<S&&(E<C||!t[w].type&&!t[w-1].greedy);++w)(E+=t[w].length)<=b&&(++y,g=E);if(t[y]instanceof O)continue;A=w-y,v=e.slice(g,E),x.index-=g}else{u.lastIndex=0;var x=u.exec(v),A=1}if(x){f&&(p=x[1]?x[1].length:0);C=(b=x.index+p)+(x=x[0].slice(p)).length;var T=v.slice(0,b),R=v.slice(C),L=[y,A];T&&(++y,g+=T.length,L.push(T));var k=new O(a,h?M.tokenize(x,h):x,_,x,d);if(L.push(k),R&&L.push(R),Array.prototype.splice.apply(t,L),1!=A&&M.matchGrammar(e,t,r,y,g,!0,a),o)break}else if(o)break}}}}},tokenize:function(e,t){var r=[e],n=t.rest;if(n){for(var i in n)t[i]=n[i];delete t.rest}return M.matchGrammar(e,r,t,0,0,!1),r},hooks:{all:{},add:function(e,t){var r=M.hooks.all;r[e]=r[e]||[],r[e].push(t)},run:function(e,t){var r=M.hooks.all[e];if(r&&r.length)for(var n,i=0;n=r[i++];)n(t)}},Token:O};function O(e,t,r,n,i){this.type=e,this.content=t,this.alias=r,this.length=0|(n||"").length,this.greedy=!!i}if(c.Prism=M,O.stringify=function(t,r,e){if("string"==typeof t)return t;if(Array.isArray(t))return t.map(function(e){return O.stringify(e,r,t)}).join("");var n={type:t.type,content:O.stringify(t.content,r,e),tag:"span",classes:["token",t.type],attributes:{},language:r,parent:e};if(t.alias){var i=Array.isArray(t.alias)?t.alias:[t.alias];Array.prototype.push.apply(n.classes,i)}M.hooks.run("wrap",n);var o=Object.keys(n.attributes).map(function(e){return e+'="'+(n.attributes[e]||"").replace(/"/g,"&quot;")+'"'}).join(" ");return"<"+n.tag+' class="'+n.classes.join(" ")+'"'+(o?" "+o:"")+">"+n.content+"</"+n.tag+">"},!c.document)return c.addEventListener&&(M.disableWorkerMessageHandler||c.addEventListener("message",function(e){var t=JSON.parse(e.data),r=t.language,n=t.code,i=t.immediateClose;c.postMessage(M.highlight(n,M.languages[r],r)),i&&c.close()},!1)),M;var e=document.currentScript||[].slice.call(document.getElementsByTagName("script")).pop();return e&&(M.filename=e.src,M.manual||e.hasAttribute("data-manual")||("loading"!==document.readyState?window.requestAnimationFrame?window.requestAnimationFrame(M.highlightAll):window.setTimeout(M.highlightAll,16):document.addEventListener("DOMContentLoaded",M.highlightAll))),M}("undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{});void 0!==t&&t.exports&&(t.exports=c),void 0!==e&&(e.Prism=c),c.languages.markup={comment:/<!--[\s\S]*?-->/,prolog:/<\?[\s\S]+?\?>/,doctype:/<!DOCTYPE[\s\S]+?>/i,cdata:/<!\[CDATA\[[\s\S]*?]]>/i,tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/i,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/i,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/i,inside:{punctuation:[/^=/,{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:/&#?[\da-z]{1,8};/i},c.languages.markup.tag.inside["attr-value"].inside.entity=c.languages.markup.entity,c.hooks.add("wrap",function(e){"entity"===e.type&&(e.attributes.title=e.content.replace(/&amp;/,"&"))}),Object.defineProperty(c.languages.markup.tag,"addInlined",{value:function(e,t){var r={};r["language-"+t]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:c.languages[t]},r.cdata=/^<!\[CDATA\[|\]\]>$/i;var n={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:r}};n["language-"+t]={pattern:/[\s\S]+/,inside:c.languages[t]};var i={};i[e]={pattern:RegExp(/(<__[\s\S]*?>)(?:<!\[CDATA\[[\s\S]*?\]\]>\s*|[\s\S])*?(?=<\/__>)/.source.replace(/__/g,e),"i"),lookbehind:!0,greedy:!0,inside:n},c.languages.insertBefore("markup","cdata",i)}}),c.languages.xml=c.languages.extend("markup",{}),c.languages.html=c.languages.markup,c.languages.mathml=c.languages.markup,c.languages.svg=c.languages.markup,function(e){var t=/("|')(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:/@[\w-]+?[\s\S]*?(?:;|(?=\s*\{))/i,inside:{rule:/@[\w-]+/}},url:RegExp("url\\((?:"+t.source+"|.*?)\\)","i"),selector:RegExp("[^{}\\s](?:[^{};\"']|"+t.source+")*?(?=\\s*\\{)"),string:{pattern:t,greedy:!0},property:/[-_a-z\xA0-\uFFFF][-\w\xA0-\uFFFF]*(?=\s*:)/i,important:/!important\b/i,function:/[-a-z0-9]+(?=\()/i,punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var r=e.languages.markup;r&&(r.tag.addInlined("style","css"),e.languages.insertBefore("inside","attr-value",{"style-attr":{pattern:/\s*style=("|')(?:\\[\s\S]|(?!\1)[^\\])*\1/i,inside:{"attr-name":{pattern:/^\s*style/i,inside:r.tag.inside},punctuation:/^\s*=\s*['"]|['"]\s*$/,"attr-value":{pattern:/.+/i,inside:e.languages.css}},alias:"language-css"}},r.tag))}(c),c.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/((?:\b(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,boolean:/\b(?:true|false)\b/,function:/\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+\.?\d*|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*|\/|~|\^|%/,punctuation:/[{}[\];(),.:]/},c.languages.javascript=c.languages.extend("clike",{"class-name":[c.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])[_$A-Z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\.(?:prototype|constructor))/,lookbehind:!0}],keyword:[{pattern:/((?:^|})\s*)(?:catch|finally)\b/,lookbehind:!0},{pattern:/(^|[^.])\b(?:as|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],number:/\b(?:(?:0[xX][\dA-Fa-f]+|0[bB][01]+|0[oO][0-7]+)n?|\d+n|NaN|Infinity)\b|(?:\b\d+\.?\d*|\B\.\d+)(?:[Ee][+-]?\d+)?/,function:/[_$a-zA-Z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,operator:/-[-=]?|\+[+=]?|!=?=?|<<?=?|>>?>?=?|=(?:==?|>)?|&[&=]?|\|[|=]?|\*\*?=?|\/=?|~|\^=?|%=?|\?|\.{3}/}),c.languages.javascript["class-name"][0].pattern=/(\b(?:class|interface|extends|implements|instanceof|new)\s+)[\w.\\]+/,c.languages.insertBefore("javascript","keyword",{regex:{pattern:/((?:^|[^$\w\xA0-\uFFFF."'\])\s])\s*)\/(\[(?:[^\]\\\r\n]|\\.)*]|\\.|[^/\\\[\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})\]]))/,lookbehind:!0,greedy:!0},"function-variable":{pattern:/[_$a-zA-Z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|[_$a-zA-Z\xA0-\uFFFF][$\w\xA0-\uFFFF]*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+[_$A-Za-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*)?\s*\(\s*)(?!\s)(?:[^()]|\([^()]*\))+?(?=\s*\))/,lookbehind:!0,inside:c.languages.javascript},{pattern:/[_$a-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\s*=>)/i,inside:c.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()]|\([^()]*\))+?(?=\s*\)\s*=>)/,lookbehind:!0,inside:c.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:[_$A-Za-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*\s*)\(\s*)(?!\s)(?:[^()]|\([^()]*\))+?(?=\s*\)\s*\{)/,lookbehind:!0,inside:c.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),c.languages.insertBefore("javascript","string",{"template-string":{pattern:/`(?:\\[\s\S]|\${[^}]+}|[^\\`])*`/,greedy:!0,inside:{interpolation:{pattern:/\${[^}]+}/,inside:{"interpolation-punctuation":{pattern:/^\${|}$/,alias:"punctuation"},rest:c.languages.javascript}},string:/[\s\S]+/}}}),c.languages.markup&&c.languages.markup.tag.addInlined("script","javascript"),c.languages.js=c.languages.javascript,"undefined"!=typeof self&&self.Prism&&self.document&&document.querySelector&&(self.Prism.fileHighlight=function(e){e=e||document;var l={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"};Array.prototype.slice.call(e.querySelectorAll("pre[data-src]")).forEach(function(e){if(!e.hasAttribute("data-src-loaded")){for(var t,r=e.getAttribute("data-src"),n=e,i=/\blang(?:uage)?-([\w-]+)\b/i;n&&!i.test(n.className);)n=n.parentNode;if(n&&(t=(e.className.match(i)||[,""])[1]),!t){var o=(r.match(/\.(\w+)$/)||[,""])[1];t=l[o]||o}var s=document.createElement("code");s.className="language-"+t,e.textContent="",s.textContent="Loading",e.appendChild(s);var a=new XMLHttpRequest;a.open("GET",r,!0),a.onreadystatechange=function(){4==a.readyState&&(a.status<400&&a.responseText?(s.textContent=a.responseText,c.highlightElement(s),e.setAttribute("data-src-loaded","")):400<=a.status?s.textContent=" Error "+a.status+" while fetching file: "+a.statusText:s.textContent=" Error: File does not exist or is empty")},a.send(null)}}),c.plugins.toolbar&&c.plugins.toolbar.registerButton("download-file",function(e){var t=e.element.parentNode;if(t&&/pre/i.test(t.nodeName)&&t.hasAttribute("data-src")&&t.hasAttribute("data-download-link")){var r=t.getAttribute("data-src"),n=document.createElement("a");return n.textContent=t.getAttribute("data-download-link-label")||"Download",n.setAttribute("download",""),n.href=r,n}})},document.addEventListener("DOMContentLoaded",function(){self.Prism.fileHighlight()}))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],11:[function(e,t,r){var n,i,o=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function l(t){if(n===setTimeout)return setTimeout(t,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var c,u=[],h=!1,f=-1;function d(){h&&c&&(h=!1,c.length?u=c.concat(u):f=-1,u.length&&p())}function p(){if(!h){var e=l(d);h=!0;for(var t=u.length;t;){for(c=u,u=[];++f<t;)c&&c[f].run();f=-1,t=u.length}c=null,h=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(e)}}function _(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new _(e,t)),1!==u.length||h||l(p)},_.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],12:[function(e,t,r){var n,i;n="undefined"!=typeof self?self:this,i=function(){return n={},i.m=r={"./src/attributes.js":function(e,t,r){"use strict";t.__esModule=!0,t.createAttribsFromArrays=c,t.createBuffersFromArrays=function(t,r){var n={};Object.keys(r).forEach(function(e){n[e]=h(t,r[e],e)}),r.indices?(n.numElements=r.indices.length,n.elementType=p.getGLTypeForTypedArray(b(r.indices),"indices")):n.numElements=function(e){var t,r;for(r=0;r<u.length&&!((t=u[r])in e);++r);r===u.length&&(t=Object.keys(e)[0]);var n=e[t],i=a(n).length,o=v(n,t),s=i/o;if(0<i%o)throw new Error("numComponents ".concat(o," not correct for length ").concat(i));return s}(r);return n},t.createBufferFromArray=h,t.createBufferFromTypedArray=m,t.createBufferInfoFromArrays=function(e,t,r){var n=c(e,t),i=Object.assign({},r||{});i.attribs=Object.assign({},r?r.attribs:{},n);var o=t.indices;if(o){var s=b(o,"indices");i.indices=m(e,s,e.ELEMENT_ARRAY_BUFFER),i.numElements=s.length,i.elementType=p.getGLTypeForTypedArray(s)}else i.numElements||(i.numElements=function(e,t){var r,n;for(n=0;n<u.length&&!((r=u[n])in t)&&!((r=_.attribPrefix+r)in t);++n);n===u.length&&(r=Object.keys(t)[0]);var i=t[r];e.bindBuffer(e.ARRAY_BUFFER,i.buffer);var o=e.getBufferParameter(e.ARRAY_BUFFER,e.BUFFER_SIZE);e.bindBuffer(e.ARRAY_BUFFER,null);var s=function(e,t){return t===e.BYTE?1:t===e.UNSIGNED_BYTE?1:t===e.SHORT?2:t===e.UNSIGNED_SHORT?2:t===e.INT?4:t===e.UNSIGNED_INT?4:t===e.FLOAT?4:0}(e,i.type),a=o/s,l=i.numComponents||i.size,c=a/l;if(c%1==0)return c;throw new Error("numComponents ".concat(l," not correct for length ").concat(length))}(e,i.attribs));return i},t.setAttribInfoBufferFromArray=function(e,t,r,n){r=b(r),void 0!==n?(e.bindBuffer(e.ARRAY_BUFFER,t.buffer),e.bufferSubData(e.ARRAY_BUFFER,n,r)):s(e,e.ARRAY_BUFFER,t.buffer,r,t.drawType)},t.setAttributePrefix=function(e){_.attribPrefix=e},t.setAttributeDefaults_=function(e){o.copyExistingProperties(e,_)},t.getNumComponents_=v,t.getArray_=a;var p=n(r("./src/typedarrays.js")),o=n(r("./src/helper.js"));function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var _={attribPrefix:""};function s(e,t,r,n,i){e.bindBuffer(t,r),e.bufferData(t,n,i||e.STATIC_DRAW)}function m(e,t,r,n){if(o.isBuffer(e,t))return t;r=r||e.ARRAY_BUFFER;var i=e.createBuffer();return s(e,r,i,t,n),i}function y(e){return"indices"===e}function a(e){return e.length?e:e.data}var i=/coord|texture/i,l=/color|colour/i;function g(e,t){var r;if(0<t%(r=i.test(e)?2:l.test(e)?4:3))throw new Error("Can not guess numComponents for attribute '".concat(e,"'. Tried ").concat(r," but ").concat(t," values is not evenly divisible by ").concat(r,". You should specify it."));return r}function v(e,t){return e.numComponents||e.size||g(t,a(e).length)}function b(e,t){if(p.isArrayBuffer(e))return e;if(p.isArrayBuffer(e.data))return e.data;Array.isArray(e)&&(e={data:e});var r=e.type;return new(r=r||(y(t)?Uint16Array:Float32Array))(e.data)}function c(h,f){var d={};return Object.keys(f).forEach(function(e){if(!y(e)){var t=f[e],r=t.attrib||t.name||t.attribName||_.attribPrefix+e;if(t.value){if(!Array.isArray(t.value)&&!p.isArrayBuffer(t.value))throw new Error("array.value is not array or typedarray");d[r]={value:t.value}}else{var n,i,o,s;if(t.buffer&&t.buffer instanceof WebGLBuffer)n=t.buffer,s=t.numComponents||t.size,i=t.type,o=t.normalize;else if("number"==typeof t||"number"==typeof t.data){var a=t.data||t,l=t.type||Float32Array,c=a*l.BYTES_PER_ELEMENT;i=p.getGLTypeForTypedArrayType(l),o=void 0!==t.normalize?t.normalize:function(e){return e===Int8Array||e===Uint8Array}(l),s=t.numComponents||t.size||g(e,a),n=h.createBuffer(),h.bindBuffer(h.ARRAY_BUFFER,n),h.bufferData(h.ARRAY_BUFFER,c,t.drawType||h.STATIC_DRAW)}else{var u=b(t,e);n=m(h,u,void 0,t.drawType),i=p.getGLTypeForTypedArray(u),o=void 0!==t.normalize?t.normalize:function(e){return e instanceof Int8Array||e instanceof Uint8Array}(u),s=v(t,e)}d[r]={buffer:n,numComponents:s,type:i,normalize:o,stride:t.stride||0,offset:t.offset||0,divisor:void 0===t.divisor?void 0:t.divisor,drawType:t.drawType}}}}),h.bindBuffer(h.ARRAY_BUFFER,null),d}var u=["position","positions","a_position"];function h(e,t,r){var n="indices"===r?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;return m(e,b(t,r),n)}},"./src/draw.js":function(e,t,r){"use strict";t.__esModule=!0,t.drawBufferInfo=c,t.drawObjectList=function(o,e){var s=null,a=null;e.forEach(function(e){if(!1!==e.active){var t=e.programInfo,r=e.vertexArrayInfo||e.bufferInfo,n=!1,i=void 0===e.type?o.TRIANGLES:e.type;t!==s&&(s=t,o.useProgram(t.program),n=!0),!n&&r===a||(a&&a.vertexArrayObject&&!r.vertexArrayObject&&o.bindVertexArray(null),a=r,l.setBuffersAndAttributes(o,t,r)),l.setUniforms(t,e.uniforms),c(o,r,i,e.count,e.offset,e.instanceCount)}}),a.vertexArrayObject&&o.bindVertexArray(null)};var l=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}}(r("./src/programs.js"));function c(e,t,r,n,i,o){r=void 0===r?e.TRIANGLES:r;var s=t.indices,a=t.elementType,l=void 0===n?t.numElements:n;i=void 0===i?0:i,a||s?void 0!==o?e.drawElementsInstanced(r,l,void 0===a?e.UNSIGNED_SHORT:t.elementType,i,o):e.drawElements(r,l,void 0===a?e.UNSIGNED_SHORT:t.elementType,i):void 0!==o?e.drawArraysInstanced(r,i,l,o):e.drawArrays(r,i,l)}},"./src/framebuffers.js":function(e,t,r){"use strict";t.__esModule=!0,t.bindFramebufferInfo=function(e,t,r){r=r||e.FRAMEBUFFER,t?(e.bindFramebuffer(r,t.framebuffer),e.viewport(0,0,t.width,t.height)):(e.bindFramebuffer(r,null),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight))},t.createFramebufferInfo=function(o,e,s,a){var l=o.FRAMEBUFFER,t=o.createFramebuffer();o.bindFramebuffer(l,t),s=s||o.drawingBufferWidth,a=a||o.drawingBufferHeight;var c=0,u={framebuffer:t,attachments:[],width:s,height:a};return(e=e||p).forEach(function(e){var t=e.attachment,r=e.format,n=function(e){return _[e]}(r);if(n=n||d+c++,!t)if(function(e){return m[e]}(r))t=o.createRenderbuffer(),o.bindRenderbuffer(o.RENDERBUFFER,t),o.renderbufferStorage(o.RENDERBUFFER,r,s,a);else{var i=Object.assign({},e);i.width=s,i.height=a,void 0===i.auto&&(i.auto=!1,i.min=i.min||i.minMag||o.LINEAR,i.mag=i.mag||i.minMag||o.LINEAR,i.wrapS=i.wrapS||i.wrap||o.CLAMP_TO_EDGE,i.wrapT=i.wrapT||i.wrap||o.CLAMP_TO_EDGE),t=h.createTexture(o,i)}if(f.isRenderbuffer(o,t))o.framebufferRenderbuffer(l,n,o.RENDERBUFFER,t);else{if(!f.isTexture(o,t))throw new Error("unknown attachment type");o.framebufferTexture2D(l,n,e.texTarget||o.TEXTURE_2D,t,e.level||0)}u.attachments.push(t)}),u},t.resizeFramebufferInfo=function(i,o,e,s,a){s=s||i.drawingBufferWidth,a=a||i.drawingBufferHeight,o.width=s,o.height=a,(e=e||p).forEach(function(e,t){var r=o.attachments[t],n=e.format;if(f.isRenderbuffer(i,r))i.bindRenderbuffer(i.RENDERBUFFER,r),i.renderbufferStorage(i.RENDERBUFFER,n,s,a);else{if(!f.isTexture(i,r))throw new Error("unknown attachment type");h.resizeTexture(i,r,e,s,a)}})};var h=n(r("./src/textures.js")),f=n(r("./src/helper.js"));function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var d=36064,p=[{format:6408,type:5121,min:9729,wrap:33071},{format:34041}],_={};_[34041]=33306,_[6401]=36128,_[36168]=36128,_[6402]=36096,_[33189]=36096;var m={};m[32854]=!0,m[32855]=!0,m[36194]=!0,m[34041]=!0,m[33189]=!0,m[6401]=!0,m[36168]=!0},"./src/helper.js":function(e,t,r){"use strict";t.__esModule=!0,t.copyExistingProperties=function(t,r){Object.keys(r).forEach(function(e){r.hasOwnProperty(e)&&t.hasOwnProperty(e)&&(r[e]=t[e])})},t.copyNamedProperties=function(e,r,n){e.forEach(function(e){var t=r[e];void 0!==t&&(n[e]=t)})},t.isBuffer=function(e,t){return"undefined"!=typeof WebGLBuffer&&t instanceof WebGLBuffer},t.isRenderbuffer=function(e,t){return"undefined"!=typeof WebGLRenderbuffer&&t instanceof WebGLRenderbuffer},t.isShader=function(e,t){return"undefined"!=typeof WebGLShader&&t instanceof WebGLShader},t.isTexture=function(e,t){return"undefined"!=typeof WebGLTexture&&t instanceof WebGLTexture},t.isSampler=function(e,t){return"undefined"!=typeof WebGLSampler&&t instanceof WebGLSampler},t.warn=t.error=void 0;var n="undefined"!=typeof console&&console.error&&"function"==typeof console.error?console.error.bind(console):function(){};t.error=n;var i="undefined"!=typeof console&&console.warn&&"function"==typeof console.warn?console.warn.bind(console):function(){};t.warn=i},"./src/m4.js":function(e,t,r){"use strict";t.__esModule=!0,t.axisRotate=function(e,t,r,n){n=n||new V(16);var i=t[0],o=t[1],s=t[2],a=Math.sqrt(i*i+o*o+s*s),l=(i/=a)*i,c=(o/=a)*o,u=(s/=a)*s,h=Math.cos(r),f=Math.sin(r),d=1-h,p=l+(1-l)*h,_=i*o*d+s*f,m=i*s*d-o*f,y=i*o*d-s*f,g=c+(1-c)*h,v=o*s*d+i*f,b=i*s*d+o*f,C=o*s*d-i*f,w=u+(1-u)*h,E=e[0],S=e[1],x=e[2],A=e[3],T=e[4],R=e[5],L=e[6],k=e[7],M=e[8],O=e[9],D=e[10],F=e[11];n[0]=p*E+_*T+m*M,n[1]=p*S+_*R+m*O,n[2]=p*x+_*L+m*D,n[3]=p*A+_*k+m*F,n[4]=y*E+g*T+v*M,n[5]=y*S+g*R+v*O,n[6]=y*x+g*L+v*D,n[7]=y*A+g*k+v*F,n[8]=b*E+C*T+w*M,n[9]=b*S+C*R+w*O,n[10]=b*x+C*L+w*D,n[11]=b*A+C*k+w*F,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]);return n},t.axisRotation=function(e,t,r){r=r||new V(16);var n=e[0],i=e[1],o=e[2],s=Math.sqrt(n*n+i*i+o*o),a=(n/=s)*n,l=(i/=s)*i,c=(o/=s)*o,u=Math.cos(t),h=Math.sin(t),f=1-u;return r[0]=a+(1-a)*u,r[1]=n*i*f+o*h,r[2]=n*o*f-i*h,r[3]=0,r[4]=n*i*f-o*h,r[5]=l+(1-l)*u,r[6]=i*o*f+n*h,r[7]=0,r[8]=n*o*f+i*h,r[9]=i*o*f-n*h,r[10]=c+(1-c)*u,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},t.copy=o,t.frustum=function(e,t,r,n,i,o,s){s=s||new V(16);var a=t-e,l=n-r,c=i-o;return s[0]=2*i/a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2*i/l,s[6]=0,s[7]=0,s[8]=(e+t)/a,s[9]=(n+r)/l,s[10]=o/c,s[11]=-1,s[12]=0,s[13]=0,s[14]=i*o/c,s[15]=0,s},t.getAxis=function(e,t,r){r=r||a.create();var n=4*t;return r[0]=e[0+n],r[1]=e[1+n],r[2]=e[2+n],r},t.getTranslation=function(e,t){return(t=t||a.create())[0]=e[12],t[1]=e[13],t[2]=e[14],t},t.identity=n,t.inverse=h,t.lookAt=function(e,t,r,n){n=n||new V(16);var i=l,o=c,s=u;return a.normalize(a.subtract(e,t,s),s),a.normalize(a.cross(r,s,i),i),a.normalize(a.cross(s,i,o),o),n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=0,n[4]=o[0],n[5]=o[1],n[6]=o[2],n[7]=0,n[8]=s[0],n[9]=s[1],n[10]=s[2],n[11]=0,n[12]=e[0],n[13]=e[1],n[14]=e[2],n[15]=1,n},t.multiply=function(e,t,r){r=r||new V(16);var n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=e[9],d=e[10],p=e[11],_=e[12],m=e[13],y=e[14],g=e[15],v=t[0],b=t[1],C=t[2],w=t[3],E=t[4],S=t[5],x=t[6],A=t[7],T=t[8],R=t[9],L=t[10],k=t[11],M=t[12],O=t[13],D=t[14],F=t[15];return r[0]=n*v+a*b+h*C+_*w,r[1]=i*v+l*b+f*C+m*w,r[2]=o*v+c*b+d*C+y*w,r[3]=s*v+u*b+p*C+g*w,r[4]=n*E+a*S+h*x+_*A,r[5]=i*E+l*S+f*x+m*A,r[6]=o*E+c*S+d*x+y*A,r[7]=s*E+u*S+p*x+g*A,r[8]=n*T+a*R+h*L+_*k,r[9]=i*T+l*R+f*L+m*k,r[10]=o*T+c*R+d*L+y*k,r[11]=s*T+u*R+p*L+g*k,r[12]=n*M+a*O+h*D+_*F,r[13]=i*M+l*O+f*D+m*F,r[14]=o*M+c*O+d*D+y*F,r[15]=s*M+u*O+p*D+g*F,r},t.negate=function(e,t){return(t=t||new V(16))[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t[9]=-e[9],t[10]=-e[10],t[11]=-e[11],t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=-e[15],t},t.ortho=function(e,t,r,n,i,o,s){return(s=s||new V(16))[0]=2/(t-e),s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2/(n-r),s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2/(i-o),s[11]=0,s[12]=(t+e)/(e-t),s[13]=(n+r)/(r-n),s[14]=(o+i)/(i-o),s[15]=1,s},t.perspective=function(e,t,r,n,i){i=i||new V(16);var o=Math.tan(.5*Math.PI-.5*e),s=1/(r-n);return i[0]=o/t,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=o,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=(r+n)*s,i[11]=-1,i[12]=0,i[13]=0,i[14]=r*n*s*2,i[15]=0,i},t.rotateX=function(e,t,r){r=r||new V(16);var n=e[4],i=e[5],o=e[6],s=e[7],a=e[8],l=e[9],c=e[10],u=e[11],h=Math.cos(t),f=Math.sin(t);r[4]=h*n+f*a,r[5]=h*i+f*l,r[6]=h*o+f*c,r[7]=h*s+f*u,r[8]=h*a-f*n,r[9]=h*l-f*i,r[10]=h*c-f*o,r[11]=h*u-f*s,e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]);return r},t.rotateY=function(e,t,r){r=r||new V(16);var n=e[0],i=e[1],o=e[2],s=e[3],a=e[8],l=e[9],c=e[10],u=e[11],h=Math.cos(t),f=Math.sin(t);r[0]=h*n-f*a,r[1]=h*i-f*l,r[2]=h*o-f*c,r[3]=h*s-f*u,r[8]=h*a+f*n,r[9]=h*l+f*i,r[10]=h*c+f*o,r[11]=h*u+f*s,e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]);return r},t.rotateZ=function(e,t,r){r=r||new V(16);var n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=Math.cos(t),f=Math.sin(t);r[0]=h*n+f*a,r[1]=h*i+f*l,r[2]=h*o+f*c,r[3]=h*s+f*u,r[4]=h*a-f*n,r[5]=h*l-f*i,r[6]=h*c-f*o,r[7]=h*u-f*s,e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]);return r},t.rotationX=function(e,t){t=t||new V(16);var r=Math.cos(e),n=Math.sin(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.rotationY=function(e,t){t=t||new V(16);var r=Math.cos(e),n=Math.sin(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.rotationZ=function(e,t){t=t||new V(16);var r=Math.cos(e),n=Math.sin(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.scale=function(e,t,r){r=r||new V(16);var n=t[0],i=t[1],o=t[2];r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=n*e[3],r[4]=i*e[4],r[5]=i*e[5],r[6]=i*e[6],r[7]=i*e[7],r[8]=o*e[8],r[9]=o*e[9],r[10]=o*e[10],r[11]=o*e[11],e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]);return r},t.scaling=function(e,t){return(t=t||new V(16))[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.setAxis=function(e,t,r,n){n!==e&&(n=o(e,n));var i=4*r;return n[0+i]=t[0],n[1+i]=t[1],n[2+i]=t[2],n},t.setDefaultType=function(e){var t=V;return V=e,t},t.setTranslation=function(e,t,r){r=r||n(),e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11]);return r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r},t.transformDirection=function(e,t,r){r=r||a.create();var n=t[0],i=t[1],o=t[2];return r[0]=n*e[0]+i*e[4]+o*e[8],r[1]=n*e[1]+i*e[5]+o*e[9],r[2]=n*e[2]+i*e[6]+o*e[10],r},t.transformNormal=function(e,t,r){r=r||a.create();var n=h(e),i=t[0],o=t[1],s=t[2];return r[0]=i*n[0]+o*n[1]+s*n[2],r[1]=i*n[4]+o*n[5]+s*n[6],r[2]=i*n[8]+o*n[9]+s*n[10],r},t.transformPoint=function(e,t,r){r=r||a.create();var n=t[0],i=t[1],o=t[2],s=n*e[3]+i*e[7]+o*e[11]+e[15];return r[0]=(n*e[0]+i*e[4]+o*e[8]+e[12])/s,r[1]=(n*e[1]+i*e[5]+o*e[9]+e[13])/s,r[2]=(n*e[2]+i*e[6]+o*e[10]+e[14])/s,r},t.translate=function(e,t,r){r=r||new V(16);var n=t[0],i=t[1],o=t[2],s=e[0],a=e[1],l=e[2],c=e[3],u=e[4],h=e[5],f=e[6],d=e[7],p=e[8],_=e[9],m=e[10],y=e[11],g=e[12],v=e[13],b=e[14],C=e[15];e!==r&&(r[0]=s,r[1]=a,r[2]=l,r[3]=c,r[4]=u,r[5]=h,r[6]=f,r[7]=d,r[8]=p,r[9]=_,r[10]=m,r[11]=y);return r[12]=s*n+u*i+p*o+g,r[13]=a*n+h*i+_*o+v,r[14]=l*n+f*i+m*o+b,r[15]=c*n+d*i+y*o+C,r},t.translation=function(e,t){return(t=t||new V(16))[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},t.transpose=function(e,t){if((t=t||new V(16))===e){var r;return r=e[1],e[1]=e[4],e[4]=r,r=e[2],e[2]=e[8],e[8]=r,r=e[3],e[3]=e[12],e[12]=r,r=e[6],e[6]=e[9],e[9]=r,r=e[7],e[7]=e[13],e[13]=r,r=e[11],e[11]=e[14],e[14]=r,t}var n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=e[9],d=e[10],p=e[11],_=e[12],m=e[13],y=e[14],g=e[15];return t[0]=n,t[1]=a,t[2]=h,t[3]=_,t[4]=i,t[5]=l,t[6]=f,t[7]=m,t[8]=o,t[9]=c,t[10]=d,t[11]=y,t[12]=s,t[13]=u,t[14]=p,t[15]=g,t};var a=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}}(r("./src/v3.js"));var V=Float32Array,l=a.create(),c=a.create(),u=a.create();function o(e,t){return(t=t||new V(16))[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function n(e){return(e=e||new V(16))[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function h(e,t){t=t||new V(16);var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],d=e[11],p=e[12],_=e[13],m=e[14],y=e[15],g=f*y,v=m*d,b=l*y,C=m*c,w=l*d,E=f*c,S=i*y,x=m*o,A=i*d,T=f*o,R=i*c,L=l*o,k=u*_,M=p*h,O=s*_,D=p*a,F=s*h,P=u*a,B=r*_,I=p*n,H=r*h,U=u*n,j=r*a,N=s*n,W=g*a+C*h+w*_-(v*a+b*h+E*_),z=v*n+S*h+T*_-(g*n+x*h+A*_),G=b*n+x*a+R*_-(C*n+S*a+L*_),K=E*n+A*a+L*h-(w*n+T*a+R*h),X=1/(r*W+s*z+u*G+p*K);return t[0]=X*W,t[1]=X*z,t[2]=X*G,t[3]=X*K,t[4]=X*(v*s+b*u+E*p-(g*s+C*u+w*p)),t[5]=X*(g*r+x*u+A*p-(v*r+S*u+T*p)),t[6]=X*(C*r+S*s+L*p-(b*r+x*s+R*p)),t[7]=X*(w*r+T*s+R*u-(E*r+A*s+L*u)),t[8]=X*(k*c+D*d+F*y-(M*c+O*d+P*y)),t[9]=X*(M*o+B*d+U*y-(k*o+I*d+H*y)),t[10]=X*(O*o+I*c+j*y-(D*o+B*c+N*y)),t[11]=X*(P*o+H*c+N*d-(F*o+U*c+j*d)),t[12]=X*(O*f+P*m+M*l-(F*m+k*l+D*f)),t[13]=X*(H*m+k*i+I*f-(B*f+U*m+M*i)),t[14]=X*(B*l+N*m+D*i-(j*m+O*i+I*l)),t[15]=X*(j*f+F*i+U*l-(H*l+N*f+P*i)),t}},"./src/primitives.js":function(e,t,r){"use strict";t.__esModule=!0,t.create3DFVertices=x,t.createAugmentedTypedArray=F,t.createCubeVertices=w,t.createPlaneVertices=v,t.createSphereVertices=b,t.createTruncatedConeVertices=E,t.createXYQuadVertices=m,t.createCresentVertices=A,t.createCylinderVertices=T,t.createTorusVertices=L,t.createDiscVertices=k,t.deindexVertices=function(a){var l=a.indices,c={},u=l.length;return Object.keys(a).filter(h).forEach(function(e){for(var t=a[e],r=t.numComponents,n=F(r,u,t.constructor),i=0;i<u;++i)for(var o=l[i]*r,s=0;s<r;++s)n.push(t[o+s]);c[e]=n}),c},t.flattenNormals=function(e){if(e.indices)throw new Error("can not flatten normals of indexed vertices. deindex them first");for(var t=e.normal,r=t.length,n=0;n<r;n+=9){var i=t[n+0],o=t[n+1],s=t[n+2],a=t[n+3],l=t[n+4],c=t[n+5],u=t[n+6],h=t[n+7],f=t[n+8],d=i+a+u,p=o+l+h,_=s+c+f,m=Math.sqrt(d*d+p*p+_*_);d/=m,p/=m,_/=m,t[n+0]=d,t[n+1]=p,t[n+2]=_,t[n+3]=d,t[n+4]=p,t[n+5]=_,t[n+6]=d,t[n+7]=p,t[n+8]=_}return e},t.makeRandomVertexColors=function(e,t){t=t||{};var r=e.position.numElements,n=F(4,r,Uint8Array),i=t.rand||function(e,t){return t<3?function(e){return Math.random()*e|0}(256):255};if(e.color=n,e.indices)for(var o=0;o<r;++o)n.push(i(o,0),i(o,1),i(o,2),i(o,3));else for(var s=t.vertsPerColor||3,a=r/s,l=0;l<a;++l)for(var c=[i(l,0),i(l,1),i(l,2),i(l,3)],u=0;u<s;++u)n.push(c);return e},t.reorientDirections=d,t.reorientNormals=p,t.reorientPositions=_,t.reorientVertices=g,t.concatVertices=function(l){for(var o,s={},e=function(e){var i=l[e];Object.keys(i).forEach(function(e){s[e]||(s[e]=[]),o||"indices"===e||(o=e);var t=i[e],r=a(t,e),n=c(t).length/r;s[e].push(n)})},t=0;t<l.length;++t)e(t);var n=s[o],i={};return Object.keys(s).forEach(function(e){var t=function(e){for(var t,r=0,n=0;n<l.length;++n){var i=l[n][e],o=c(i);r+=o.length,t&&!i.data||(t=i)}return{length:r,spec:t}}(e),r=B(t.spec,t.length);!function(e,t,r){for(var n=0,i=0,o=0;o<l.length;++o){var s=l[o][e],a=c(s);"indices"===e?(P(a,r,i,n),n+=t[o]):P(a,r,i),i+=a.length}}(e,n,c(r)),i[e]=r}),i},t.duplicateVertices=function(i){var o={};return Object.keys(i).forEach(function(e){var t=i[e],r=c(t),n=B(t,r.length);P(r,c(n),0),o[e]=n}),o},t.createDiscBuffers=t.createDiscBufferInfo=t.createTorusBuffers=t.createTorusBufferInfo=t.createCylinderBuffers=t.createCylinderBufferInfo=t.createCresentBuffers=t.createCresentBufferInfo=t.createXYQuadBuffers=t.createXYQuadBufferInfo=t.createTruncatedConeBuffers=t.createTruncatedConeBufferInfo=t.createSphereBuffers=t.createSphereBufferInfo=t.createPlaneBuffers=t.createPlaneBufferInfo=t.createCubeBuffers=t.createCubeBufferInfo=t.create3DFBuffers=t.create3DFBufferInfo=void 0;var n=i(r("./src/attributes.js")),o=i(r("./src/helper.js")),s=i(r("./src/typedarrays.js")),y=i(r("./src/m4.js")),R=i(r("./src/v3.js"));function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var c=n.getArray_,a=n.getNumComponents_;function l(n,e){var i=0;return n.push=function(){for(var e=0;e<arguments.length;++e){var t=arguments[e];if(t instanceof Array||s.isArrayBuffer(t))for(var r=0;r<t.length;++r)n[i++]=t[r];else n[i++]=t}},n.reset=function(e){i=e||0},n.numComponents=e,Object.defineProperty(n,"numElements",{get:function(){return this.length/this.numComponents|0}}),n}function F(e,t,r){return l(new(r||Float32Array)(e*t),e)}function h(e){return"indices"!==e}function u(e,t,r){for(var n=e.length,i=new Float32Array(3),o=0;o<n;o+=3)r(t,[e[o],e[o+1],e[o+2]],i),e[o]=i[0],e[o+1]=i[1],e[o+2]=i[2]}function f(e,t,r){r=r||R.create();var n=t[0],i=t[1],o=t[2];return r[0]=n*e[0]+i*e[1]+o*e[2],r[1]=n*e[4]+i*e[5]+o*e[6],r[2]=n*e[8]+i*e[9]+o*e[10],r}function d(e,t){return u(e,t,y.transformDirection),e}function p(e,t){return u(e,y.inverse(t),f),e}function _(e,t){return u(e,t,y.transformPoint),e}function g(r,n){return Object.keys(r).forEach(function(e){var t=r[e];0<=e.indexOf("pos")?_(t,n):0<=e.indexOf("tan")||0<=e.indexOf("binorm")?d(t,n):0<=e.indexOf("norm")&&p(t,n)}),r}function m(e,t,r){return e=e||2,{position:{numComponents:2,data:[(t=t||0)+-1*(e*=.5),(r=r||0)+-1*e,t+1*e,r+-1*e,t+-1*e,r+1*e,t+1*e,r+1*e]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function v(e,t,r,n,i){e=e||1,t=t||1,r=r||1,n=n||1,i=i||y.identity();for(var o=(r+1)*(n+1),s=F(3,o),a=F(3,o),l=F(2,o),c=0;c<=n;c++)for(var u=0;u<=r;u++){var h=u/r,f=c/n;s.push(e*h-.5*e,0,t*f-.5*t),a.push(0,1,0),l.push(h,f)}for(var d=r+1,p=F(3,r*n*2,Uint16Array),_=0;_<n;_++)for(var m=0;m<r;m++)p.push((_+0)*d+m,(_+1)*d+m,(_+0)*d+m+1),p.push((_+1)*d+m,(_+1)*d+m+1,(_+0)*d+m+1);return g({position:s,normal:a,texcoord:l,indices:p},i)}function b(e,t,r,n,i,o,s){if(t<=0||r<=0)throw new Error("subdivisionAxis and subdivisionHeight must be > 0");n=n||0,o=o||0;for(var a=(i=i||Math.PI)-n,l=(s=s||2*Math.PI)-o,c=(t+1)*(r+1),u=F(3,c),h=F(3,c),f=F(2,c),d=0;d<=r;d++)for(var p=0;p<=t;p++){var _=p/t,m=d/r,y=l*_+o,g=a*m+n,v=Math.sin(y),b=Math.cos(y),C=Math.sin(g),w=b*C,E=Math.cos(g),S=v*C;u.push(e*w,e*E,e*S),h.push(w,E,S),f.push(1-_,m)}for(var x=t+1,A=F(3,t*r*2,Uint16Array),T=0;T<t;T++)for(var R=0;R<r;R++)A.push((R+0)*x+T,(R+0)*x+T+1,(R+1)*x+T),A.push((R+1)*x+T,(R+0)*x+T+1,(R+1)*x+T+1);return{position:u,normal:h,texcoord:f,indices:A}}var C=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function w(e){for(var t=(e=e||1)/2,r=[[-t,-t,-t],[+t,-t,-t],[-t,+t,-t],[+t,+t,-t],[-t,-t,+t],[+t,-t,+t],[-t,+t,+t],[+t,+t,+t]],n=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],i=[[1,0],[0,0],[0,1],[1,1]],o=F(3,24),s=F(3,24),a=F(2,24),l=F(3,12,Uint16Array),c=0;c<6;++c){for(var u=C[c],h=0;h<4;++h){var f=r[u[h]],d=n[c],p=i[h];o.push(f),s.push(d),a.push(p)}var _=4*c;l.push(0+_,1+_,2+_),l.push(0+_,2+_,3+_)}return{position:o,normal:s,texcoord:a,indices:l}}function E(e,t,r,n,i,o,s){if(n<3)throw new Error("radialSubdivisions must be 3 or greater");if(i<1)throw new Error("verticalSubdivisions must be 1 or greater");for(var a=void 0===o||o,l=void 0===s||s,c=(a?2:0)+(l?2:0),u=(n+1)*(i+1+c),h=F(3,u),f=F(3,u),d=F(2,u),p=F(3,n*(i+c)*2,Uint16Array),_=n+1,m=Math.atan2(e-t,r),y=Math.cos(m),g=Math.sin(m),v=i+(l?2:0),b=a?-2:0;b<=v;++b){var C=b/i,w=r*C,E=void 0;E=b<0?(w=0,C=1,e):i<b?(w=r,C=1,t):e+b/i*(t-e),-2!==b&&b!==i+2||(C=E=0),w-=r/2;for(var S=0;S<_;++S){var x=Math.sin(S*Math.PI*2/n),A=Math.cos(S*Math.PI*2/n);h.push(x*E,w,A*E),f.push(b<0||i<b?0:x*y,b<0?-1:i<b?1:g,b<0||i<b?0:A*y),d.push(S/n,1-C)}}for(var T=0;T<i+c;++T)for(var R=0;R<n;++R)p.push(_*(T+0)+0+R,_*(T+0)+1+R,_*(T+1)+1+R),p.push(_*(T+0)+0+R,_*(T+1)+1+R,_*(T+1)+0+R);return{position:h,normal:f,texcoord:d,indices:p}}function S(e,t){t=t||[];for(var r=[],n=0;n<e.length;n+=4){var i=e[n],o=e.slice(n+1,n+4);o.push.apply(o,t);for(var s=0;s<i;++s)r.push.apply(r,o)}return r}function x(){var e=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],t=S([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),r=S([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),n=e.length/3,i={position:F(3,n),texcoord:F(2,n),normal:F(3,n),color:F(4,n,Uint8Array),indices:F(3,n/3,Uint16Array)};i.position.push(e),i.texcoord.push([.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0]),i.normal.push(t),i.color.push(r);for(var o=0;o<n;++o)i.indices.push(o);return i}function A(v,e,t,b,C,w,r){if(C<=0)throw new Error("subdivisionDown must be > 0");var E=2,S=(r=r||1)-(w=w||0),n=2*(C+1)*(2+E),x=F(3,n),A=F(3,n),T=F(2,n);function i(e,t,r,n,i,o){for(var s=0;s<=C;s++){var a=t/(E-1),l=s/C,c=2*(a-.5),u=(w+l*S)*Math.PI,h=Math.sin(u),f=Math.cos(u),d=(g=v)+(e-g)*h,p=c*b,_=f*v,m=h*d;x.push(p,_,m);var y=R.add(R.multiply([0,h,f],r),n);A.push(y),T.push(a*i+o,l)}var g}for(var o=0;o<E;o++){var s=2*(o/(E-1)-.5);i(e,o,[1,1,1],[0,0,0],1,0),i(e,o,[0,0,0],[s,0,0],0,0),i(t,o,[1,1,1],[0,0,0],1,0),i(t,o,[0,0,0],[s,0,0],0,1)}var a=F(3,2*C*(2+E),Uint16Array);function l(e,t){for(var r=0;r<C;++r)a.push(e+r+0,e+r+1,t+r+0),a.push(e+r+1,t+r+1,t+r+0)}var c=C+1;return l(0*c,4*c),l(5*c,7*c),l(6*c,2*c),l(3*c,1*c),{position:x,normal:A,texcoord:T,indices:a}}function T(e,t,r,n,i,o){return E(e,e,t,r,n,i,o)}function L(e,t,r,n,i,o){if(r<3)throw new Error("radialSubdivisions must be 3 or greater");if(n<3)throw new Error("verticalSubdivisions must be 3 or greater");i=i||0;for(var s=(o=o||2*Math.PI)-i,a=r+1,l=n+1,c=a*l,u=F(3,c),h=F(3,c),f=F(2,c),d=F(3,r*n*2,Uint16Array),p=0;p<l;++p)for(var _=p/n,m=_*Math.PI*2,y=Math.sin(m),g=e+y*t,v=Math.cos(m),b=v*t,C=0;C<a;++C){var w=C/r,E=i+w*s,S=Math.sin(E),x=Math.cos(E),A=S*g,T=x*g,R=S*y,L=x*y;u.push(A,b,T),h.push(R,v,L),f.push(w,1-_)}for(var k=0;k<n;++k)for(var M=0;M<r;++M){var O=1+M,D=1+k;d.push(a*k+M,a*D+M,a*k+O),d.push(a*D+M,a*D+O,a*k+O)}return{position:u,normal:h,texcoord:f,indices:d}}function k(e,t,r,n,i){if(t<3)throw new Error("divisions must be at least 3");i=i||1,n=n||0;for(var o=(t+1)*((r=r||1)+1),s=F(3,o),a=F(3,o),l=F(2,o),c=F(3,r*t*2,Uint16Array),u=0,h=e-n,f=t+1,d=0;d<=r;++d){for(var p=n+h*Math.pow(d/r,i),_=0;_<=t;++_){var m=2*Math.PI*_/t,y=p*Math.cos(m),g=p*Math.sin(m);if(s.push(y,0,g),a.push(0,1,0),l.push(1-_/t,d/r),0<d&&_!==t){var v=u+(_+1),b=u+_,C=u+_-f,w=u+(_+1)-f;c.push(v,b,C),c.push(v,C,w)}}u+=t+1}return{position:s,normal:a,texcoord:l,indices:c}}function M(r){return function(e){var t=r.apply(this,Array.prototype.slice.call(arguments,1));return n.createBuffersFromArrays(e,t)}}function O(r){return function(e){var t=r.apply(null,Array.prototype.slice.call(arguments,1));return n.createBufferInfoFromArrays(e,t)}}var D=["numComponents","size","type","normalize","stride","offset","attrib","name","attribName"];function P(e,t,r,n){n=n||0;for(var i=e.length,o=0;o<i;++o)t[r+o]=e[o]+n}function B(e,t){var r=c(e),n=new r.constructor(t),i=n;return r.numComponents&&r.numElements&&l(n,r.numComponents),e.data&&(i={data:n},o.copyNamedProperties(D,e,i)),i}var I=O(x);t.create3DFBufferInfo=I;var H=M(x);t.create3DFBuffers=H;var U=O(w);t.createCubeBufferInfo=U;var j=M(w);t.createCubeBuffers=j;var N=O(v);t.createPlaneBufferInfo=N;var W=M(v);t.createPlaneBuffers=W;var z=O(b);t.createSphereBufferInfo=z;var G=M(b);t.createSphereBuffers=G;var K=O(E);t.createTruncatedConeBufferInfo=K;var X=M(E);t.createTruncatedConeBuffers=X;var V=O(m);t.createXYQuadBufferInfo=V;var q=M(m);t.createXYQuadBuffers=q;var Y=O(A);t.createCresentBufferInfo=Y;var Z=M(A);t.createCresentBuffers=Z;var J=O(T);t.createCylinderBufferInfo=J;var $=M(T);t.createCylinderBuffers=$;var Q=O(L);t.createTorusBufferInfo=Q;var ee=M(L);t.createTorusBuffers=ee;var te=O(k);t.createDiscBufferInfo=te;var re=M(k);t.createDiscBuffers=re},"./src/programs.js":function(e,t,r){"use strict";t.__esModule=!0,t.createAttributeSetters=W,t.createProgram=M,t.createProgramFromScripts=function(e,t,r,n,i){for(var o=T(r,n,i),s=[],a=0;a<t.length;++a){var l=O(e,t[a],e[R[a]],o.errorCallback);if(!l)return null;s.push(l)}return M(e,s,o)},t.createProgramFromSources=D,t.createProgramInfo=function(e,t,r,n,i){var o=T(r,n,i),s=!0;if(t=t.map(function(e){if(e.indexOf("\n")<0){var t=y(e);t?e=t.text:(o.errorCallback("no element with id: "+e),s=!1)}return e}),!s)return null;var a=D(e,t,o);return a?G(e,a):null},t.createProgramInfoFromProgram=G,t.createUniformSetters=P,t.createUniformBlockSpecFromProgram=H,t.createUniformBlockInfoFromProgram=j,t.createUniformBlockInfo=function(e,t,r){return j(e,t.program,t.uniformBlockSpec,r)},t.createTransformFeedback=function(e,t,r){var n=e.createTransformFeedback();return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,n),e.useProgram(t.program),I(e,t,r),e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),n},t.createTransformFeedbackInfo=B,t.bindTransformFeedbackInfo=I,t.setAttributes=z,t.setBuffersAndAttributes=function(e,t,r){r.vertexArrayObject?e.bindVertexArray(r.vertexArrayObject):(z(t.attribSetters||t,r.attribs),r.indices&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.indices))},t.setUniforms=function e(t,r){var n=t.uniformSetters||t;var i=arguments.length;for(var o=1;o<i;++o){var s=arguments[o];if(Array.isArray(s))for(var a=s.length,l=0;l<a;++l)e(n,s[l]);else for(var c in s){var u=n[c];u&&u(s[c])}}},t.setUniformBlock=function(e,t,r){N(e,t,r)&&e.bufferData(e.UNIFORM_BUFFER,r.array,e.DYNAMIC_DRAW)},t.setBlockUniforms=function(e,t){var r=e.uniforms;for(var n in t){var i=r[n];if(i){var o=t[n];o.length?i.set(o):i[0]=o}}},t.bindUniformBlock=N;var l=n(r("./src/utils.js")),m=n(r("./src/helper.js"));function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var c=m.error,f=m.warn,y="undefined"!=typeof document&&document.getElementById?document.getElementById.bind(document):function(){return null},i=34067,o=35866,d={};function u(e,t){return d[t].bindPoint}function s(t,r){return function(e){t.uniform1i(r,e)}}function a(t,r){return function(e){t.uniform1iv(r,e)}}function h(t,r){return function(e){t.uniform2iv(r,e)}}function p(t,r){return function(e){t.uniform3iv(r,e)}}function _(t,r){return function(e){t.uniform4iv(r,e)}}function g(n,e,i,o){var s=u(0,e);return l.isWebGL2(n)?function(e){var t,r;r=m.isTexture(n,e)?(t=e,null):(t=e.texture,e.sampler),n.uniform1i(o,i),n.activeTexture(n.TEXTURE0+i),n.bindTexture(s,t),n.bindSampler(i,r)}:function(e){n.uniform1i(o,i),n.activeTexture(n.TEXTURE0+i),n.bindTexture(s,e)}}function v(i,e,o,t,r){for(var s=u(0,e),a=new Int32Array(r),n=0;n<r;++n)a[n]=o+n;return l.isWebGL2(i)?function(e){i.uniform1iv(t,a),e.forEach(function(e,t){var r,n;i.activeTexture(i.TEXTURE0+a[t]),n=m.isTexture(i,e)?(r=e,null):(r=e.texture,e.sampler),i.bindSampler(o,n),i.bindTexture(s,r)})}:function(e){i.uniform1iv(t,a),e.forEach(function(e,t){i.activeTexture(i.TEXTURE0+a[t]),i.bindTexture(s,e)})}}function b(t,r){return function(e){if(e.value)switch(t.disableVertexAttribArray(r),e.value.length){case 4:t.vertexAttrib4fv(r,e.value);break;case 3:t.vertexAttrib3fv(r,e.value);break;case 2:t.vertexAttrib2fv(r,e.value);break;case 1:t.vertexAttrib1fv(r,e.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else t.bindBuffer(t.ARRAY_BUFFER,e.buffer),t.enableVertexAttribArray(r),t.vertexAttribPointer(r,e.numComponents||e.size,e.type||t.FLOAT,e.normalize||!1,e.stride||0,e.offset||0),void 0!==e.divisor&&t.vertexAttribDivisor(r,e.divisor)}}function C(t,r){return function(e){if(e.value){if(t.disableVertexAttribArray(r),4!==e.value.length)throw new Error("The length of an integer constant value must be 4!");t.vertexAttrib4iv(r,e.value)}else t.bindBuffer(t.ARRAY_BUFFER,e.buffer),t.enableVertexAttribArray(r),t.vertexAttribIPointer(r,e.numComponents||e.size,e.type||t.INT,e.stride||0,e.offset||0),void 0!==e.divisor&&t.vertexAttribDivisor(r,e.divisor)}}function w(t,r){return function(e){if(e.value){if(t.disableVertexAttribArray(r),4!==e.value.length)throw new Error("The length of an unsigned integer constant value must be 4!");t.vertexAttrib4uiv(r,e.value)}else t.bindBuffer(t.ARRAY_BUFFER,e.buffer),t.enableVertexAttribArray(r),t.vertexAttribIPointer(r,e.numComponents||e.size,e.type||t.UNSIGNED_INT,e.stride||0,e.offset||0),void 0!==e.divisor&&t.vertexAttribDivisor(r,e.divisor)}}function E(c,u,e){var h=e.size,f=e.count;return function(e){c.bindBuffer(c.ARRAY_BUFFER,e.buffer);for(var t=e.size||e.numComponents||h,r=t/f,n=e.type||c.FLOAT,i=d[n].size*t,o=e.normalize||!1,s=e.offset||0,a=i/f,l=0;l<f;++l)c.enableVertexAttribArray(u+l),c.vertexAttribPointer(u+l,r,n,o,i,s+a*l),void 0!==e.divisor&&c.vertexAttribDivisor(u+l,e.divisor)}}d[5126]={Type:Float32Array,size:4,setter:function(t,r){return function(e){t.uniform1f(r,e)}},arraySetter:function(t,r){return function(e){t.uniform1fv(r,e)}}},d[35664]={Type:Float32Array,size:8,setter:function(t,r){return function(e){t.uniform2fv(r,e)}}},d[35665]={Type:Float32Array,size:12,setter:function(t,r){return function(e){t.uniform3fv(r,e)}}},d[35666]={Type:Float32Array,size:16,setter:function(t,r){return function(e){t.uniform4fv(r,e)}}},d[5124]={Type:Int32Array,size:4,setter:s,arraySetter:a},d[35667]={Type:Int32Array,size:8,setter:h},d[35668]={Type:Int32Array,size:12,setter:p},d[35669]={Type:Int32Array,size:16,setter:_},d[5125]={Type:Uint32Array,size:4,setter:function(t,r){return function(e){t.uniform1ui(r,e)}},arraySetter:function(t,r){return function(e){t.uniform1uiv(r,e)}}},d[36294]={Type:Uint32Array,size:8,setter:function(t,r){return function(e){t.uniform2uiv(r,e)}}},d[36295]={Type:Uint32Array,size:12,setter:function(t,r){return function(e){t.uniform3uiv(r,e)}}},d[36296]={Type:Uint32Array,size:16,setter:function(t,r){return function(e){t.uniform4uiv(r,e)}}},d[35670]={Type:Uint32Array,size:4,setter:s,arraySetter:a},d[35671]={Type:Uint32Array,size:8,setter:h},d[35672]={Type:Uint32Array,size:12,setter:p},d[35673]={Type:Uint32Array,size:16,setter:_},d[35674]={Type:Float32Array,size:16,setter:function(t,r){return function(e){t.uniformMatrix2fv(r,!1,e)}}},d[35675]={Type:Float32Array,size:36,setter:function(t,r){return function(e){t.uniformMatrix3fv(r,!1,e)}}},d[35676]={Type:Float32Array,size:64,setter:function(t,r){return function(e){t.uniformMatrix4fv(r,!1,e)}}},d[35685]={Type:Float32Array,size:24,setter:function(t,r){return function(e){t.uniformMatrix2x3fv(r,!1,e)}}},d[35686]={Type:Float32Array,size:32,setter:function(t,r){return function(e){t.uniformMatrix2x4fv(r,!1,e)}}},d[35687]={Type:Float32Array,size:24,setter:function(t,r){return function(e){t.uniformMatrix3x2fv(r,!1,e)}}},d[35688]={Type:Float32Array,size:48,setter:function(t,r){return function(e){t.uniformMatrix3x4fv(r,!1,e)}}},d[35689]={Type:Float32Array,size:32,setter:function(t,r){return function(e){t.uniformMatrix4x2fv(r,!1,e)}}},d[35690]={Type:Float32Array,size:48,setter:function(t,r){return function(e){t.uniformMatrix4x3fv(r,!1,e)}}},d[35678]={Type:null,size:0,setter:g,arraySetter:v,bindPoint:3553},d[35680]={Type:null,size:0,setter:g,arraySetter:v,bindPoint:i},d[35679]={Type:null,size:0,setter:g,arraySetter:v,bindPoint:32879},d[35682]={Type:null,size:0,setter:g,arraySetter:v,bindPoint:3553},d[36289]={Type:null,size:0,setter:g,arraySetter:v,bindPoint:o},d[36292]={Type:null,size:0,setter:g,arraySetter:v,bindPoint:o},d[36293]={Type:null,size:0,setter:g,arraySetter:v,bindPoint:i},d[36298]={Type:null,size:0,setter:g,arraySetter:v,bindPoint:3553},d[36299]={Type:null,size:0,setter:g,arraySetter:v,bindPoint:32879},d[36300]={Type:null,size:0,setter:g,arraySetter:v,bindPoint:i},d[36303]={Type:null,size:0,setter:g,arraySetter:v,bindPoint:o},d[36306]={Type:null,size:0,setter:g,arraySetter:v,bindPoint:3553},d[36307]={Type:null,size:0,setter:g,arraySetter:v,bindPoint:32879},d[36308]={Type:null,size:0,setter:g,arraySetter:v,bindPoint:i},d[36311]={Type:null,size:0,setter:g,arraySetter:v,bindPoint:o};var S={};S[5126]={size:4,setter:b},S[35664]={size:8,setter:b},S[35665]={size:12,setter:b},S[35666]={size:16,setter:b},S[5124]={size:4,setter:C},S[35667]={size:8,setter:C},S[35668]={size:12,setter:C},S[35669]={size:16,setter:C},S[5125]={size:4,setter:w},S[36294]={size:8,setter:w},S[36295]={size:12,setter:w},S[36296]={size:16,setter:w},S[35670]={size:4,setter:C},S[35671]={size:8,setter:C},S[35672]={size:12,setter:C},S[35673]={size:16,setter:C},S[35674]={size:4,setter:E,count:2},S[35675]={size:9,setter:E,count:3},S[35676]={size:16,setter:E,count:4};var x=/^[ \t]*\n/;function A(e,t,r,n){var i=n||c,o=e.createShader(r),s=0;if(x.test(t)&&(s=1,t=t.replace(x,"")),e.shaderSource(o,t),e.compileShader(o),e.getShaderParameter(o,e.COMPILE_STATUS))return o;var a=e.getShaderInfoLog(o);return i(function(e,r){return r=r||0,++r,e.split("\n").map(function(e,t){return t+r+": "+e}).join("\n")}(t,s)+"\n*** Error compiling shader: "+a),e.deleteShader(o),null}function T(e,r,t){var n;if("function"==typeof r&&(t=r,r=void 0),"function"==typeof e)t=e,e=void 0;else if(e&&!Array.isArray(e)){if(e.errorCallback)return e;var i=e;t=i.errorCallback,e=i.attribLocations,n=i.transformFeedbackVaryings}var o={errorCallback:t||c,transformFeedbackVaryings:n};if(e){var s={};Array.isArray(e)?e.forEach(function(e,t){s[e]=r?r[t]:t}):s=e,o.attribLocations=s}return o}var R=["VERTEX_SHADER","FRAGMENT_SHADER"];function L(e,t){return 0<=t.indexOf("frag")?e.FRAGMENT_SHADER:0<=t.indexOf("vert")?e.VERTEX_SHADER:void 0}function k(t,e){e.forEach(function(e){t.deleteShader(e)})}function M(t,e,r,n,i){for(var o=T(r,n,i),s=[],a=[],l=0;l<e.length;++l){var c=e[l];if("string"==typeof c){var u=y(c),h=u?u.text:c,f=t[R[l]];u&&u.type&&(f=L(t,u.type)||f),c=A(t,h,f,o.errorCallback),a.push(c)}m.isShader(t,c)&&s.push(c)}if(s.length!==e.length)return o.errorCallback("not enough shaders for program"),k(t,a),null;var d=t.createProgram();s.forEach(function(e){t.attachShader(d,e)}),o.attribLocations&&Object.keys(o.attribLocations).forEach(function(e){t.bindAttribLocation(d,o.attribLocations[e],e)});var p=o.transformFeedbackVaryings;if(p&&(p.attribs&&(p=p.attribs),Array.isArray(p)||(p=Object.keys(p)),t.transformFeedbackVaryings(d,p,o.transformFeedbackMode||t.SEPARATE_ATTRIBS)),t.linkProgram(d),t.getProgramParameter(d,t.LINK_STATUS))return d;var _=t.getProgramInfoLog(d);return o.errorCallback("Error in program linking:"+_),t.deleteProgram(d),k(t,a),null}function O(e,t,r,n){var i,o=y(t);if(!o)throw new Error("unknown script element: ".concat(t));i=o.text;var s=r||L(e,o.type);if(!s)throw new Error("unknown shader type");return A(e,i,s,n)}function D(e,t,r,n,i){for(var o=T(r,n,i),s=[],a=0;a<t.length;++a){var l=A(e,t[a],e[R[a]],o.errorCallback);if(!l)return null;s.push(l)}return M(e,s,o)}function F(e){var t=e.name;return t.startsWith("gl_")||t.startsWith("webgl_")}function P(l,e){var c=0;function t(e,t){var r,n=l.getUniformLocation(e,t.name),i=1<t.size&&"[0]"===t.name.substr(-3),o=t.type,s=d[o];if(!s)throw new Error("unknown type: 0x".concat(o.toString(16)));if(s.bindPoint){var a=c;c+=t.size,r=i?s.arraySetter(l,o,a,n,t.size):s.setter(l,o,a,n,t.size)}else r=s.arraySetter&&i?s.arraySetter(l,n):s.setter(l,n);return r.location=n,r}for(var r={},n=l.getProgramParameter(e,l.ACTIVE_UNIFORMS),i=0;i<n;++i){var o=l.getActiveUniform(e,i);if(!F(o)){var s=o.name;"[0]"===s.substr(-3)&&(s=s.substr(0,s.length-3));var a=t(e,o);r[s]=a}}return r}function B(e,t){for(var r={},n=e.getProgramParameter(t,e.TRANSFORM_FEEDBACK_VARYINGS),i=0;i<n;++i){var o=e.getTransformFeedbackVarying(t,i);r[o.name]={index:i,type:o.type,size:o.size}}return r}function I(e,t,r){for(var n in t.transformFeedbackInfo&&(t=t.transformFeedbackInfo),r.attribs&&(r=r.attribs),r){var i=t[n];if(i){var o=r[n];o.offset?e.bindBufferRange(e.TRANSFORM_FEEDBACK_BUFFER,i.index,o.buffer,o.offset,o.size):e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,i.index,o.buffer)}}}function H(n,i){for(var e=n.getProgramParameter(i,n.ACTIVE_UNIFORMS),o=[],s=[],t=0;t<e;++t){s.push(t),o.push({});var r=n.getActiveUniform(i,t);if(F(r))break;o[t].name=r.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(e){var t=e[0],r=e[1];n.getActiveUniforms(i,s,n[t]).forEach(function(e,t){o[t][r]=e})});for(var a={},l=n.getProgramParameter(i,n.ACTIVE_UNIFORM_BLOCKS),c=0;c<l;++c){var u=n.getActiveUniformBlockName(i,c),h={index:c,usedByVertexShader:n.getActiveUniformBlockParameter(i,c,n.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER),usedByFragmentShader:n.getActiveUniformBlockParameter(i,c,n.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER),size:n.getActiveUniformBlockParameter(i,c,n.UNIFORM_BLOCK_DATA_SIZE),uniformIndices:n.getActiveUniformBlockParameter(i,c,n.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES)};h.used=h.usedByVertexSahder||h.usedByFragmentShader,a[u]=h}return{blockSpecs:a,uniformData:o}}var U=/\[\d+\]\.$/;function j(e,t,r,n){var i=r.blockSpecs,s=r.uniformData,o=i[n];if(!o)return f("no uniform block object named:",n),{name:n,uniforms:{}};var a=new ArrayBuffer(o.size),l=e.createBuffer(),c=o.index;e.bindBuffer(e.UNIFORM_BUFFER,l),e.uniformBlockBinding(t,o.index,c);var u=n+".";U.test(u)&&(u=u.replace(U,"."));var h={};return o.uniformIndices.forEach(function(e){var t=s[e],r=d[t.type],n=r.Type,i=t.size*r.size,o=t.name;o.substr(0,u.length)===u&&(o=o.substr(u.length)),h[o]=new n(a,t.offset,i/n.BYTES_PER_ELEMENT)}),{name:n,array:a,asFloat:new Float32Array(a),buffer:l,uniforms:h}}function N(e,t,r){var n=(t.uniformBlockSpec||t).blockSpecs[r.name];if(n){var i=n.index;return e.bindBufferRange(e.UNIFORM_BUFFER,i,r.buffer,r.offset||0,r.array.byteLength),!0}return!1}function W(e,t){for(var r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<n;++i){var o=e.getActiveAttrib(t,i);if(!F(o)){var s=e.getAttribLocation(t,o.name),a=S[o.type],l=a.setter(e,s,a);l.location=s,r[o.name]=l}}return r}function z(e,t){for(var r in t){var n=e[r];n&&n(t[r])}}function G(e,t){var r={program:t,uniformSetters:P(e,t),attribSetters:W(e,t)};return l.isWebGL2(e)&&(r.uniformBlockSpec=H(e,t),r.transformFeedbackInfo=B(e,t)),r}},"./src/textures.js":function(e,t,r){"use strict";t.__esModule=!0,t.setTextureDefaults_=function(e){h.copyExistingProperties(e,S),e.textureColor&&B(e.textureColor)},t.createSampler=K,t.createSamplers=function(t,r){var n={};return Object.keys(r).forEach(function(e){n[e]=K(t,r[e])}),n},t.setSamplerParameters=G,t.createTexture=ae,t.setEmptyTexture=se,t.setTextureFromArray=oe,t.loadTextureFromUrl=re,t.setTextureFromElement=Z,t.setTextureFilteringForSize=X,t.setTextureParameters=z,t.setDefaultTextureColor=B,t.createTextures=function(r,i,e){e=e||J;var o=0,s=[],a={},l={};function c(){0===o&&setTimeout(function(){e(s.length?s:void 0,a,l)},0)}return Object.keys(i).forEach(function(n){var e,t=i[n];!function(e){return"string"==typeof e||Array.isArray(e)&&"string"==typeof e[0]}(t.src)||(e=function(e,t,r){l[n]=r,--o,e&&s.push(e),c()},++o),a[n]=ae(r,t,e)}),c(),a},t.resizeTexture=function(e,t,r,n,i){n=n||r.width,i=i||r.height;var o=r.target||e.TEXTURE_2D;e.bindTexture(o,t);var s,a=r.level||0,l=r.internalFormat||r.format||e.RGBA,c=k(l),u=r.format||c.format,h=r.src;s=h&&(C(h)||Array.isArray(h)&&"number"==typeof h[0])?r.type||F(e,h,c.type):r.type||c.type;if(o===e.TEXTURE_CUBE_MAP)for(var f=0;f<6;++f)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+f,a,l,n,i,0,u,s,null);else e.texImage2D(o,a,l,n,i,0,u,s,null)},t.canGenerateMipmap=O,t.canFilter=D,t.getNumComponentsForFormat=function(e){var t=E[e];if(t)return t.numColorComponents;throw"unknown format: "+e},t.getBytesPerElementForInternalFormat=L,t.getFormatAndTypeForInternalFormat=k;var v=n(r("./src/utils.js")),b=n(r("./src/typedarrays.js")),h=n(r("./src/helper.js"));function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var S={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},C=b.isArrayBuffer,x="undefined"!=typeof document&&document.createElement?document.createElement("canvas").getContext("2d"):null,i=6407,o=6408,s=5120,a=5121,l=5123,c=5125,u=5126,f=5131,d=36193,p=33319,_=33320,m=6403,y=36244,g=36248,w=36249,E={},A=E;A[6406]={numColorComponents:1},A[6409]={numColorComponents:1},A[6410]={numColorComponents:2},A[i]={numColorComponents:3},A[o]={numColorComponents:4},A[m]={numColorComponents:1},A[y]={numColorComponents:1},A[p]={numColorComponents:2},A[_]={numColorComponents:2},A[i]={numColorComponents:3},A[g]={numColorComponents:3},A[o]={numColorComponents:4},A[w]={numColorComponents:4},A[6402]={numColorComponents:1},A[34041]={numColorComponents:2};var T={},R=T;function L(e,t){var r=T[e];if(!r)throw"unknown internal format";var n=r.bytesPerElementMap[t];if(void 0===n)throw"unknown internal format";return n}function k(e){var t=T[e];if(!t)throw"unknown internal format";return{format:t.textureFormat,type:t.type[0]}}function M(e){return 0==(e&e-1)}function O(e,t,r,n){if(!v.isWebGL2(e))return M(t)&&M(r);var i=T[n];if(!i)throw"unknown internal format";return i.colorRenderable&&i.textureFilterable}function D(e){var t=T[e];if(!t)throw"unknown internal format";return t.textureFilterable}function F(e,t,r){return C(t)?b.getGLTypeForTypedArray(t):r||e.UNSIGNED_BYTE}function P(e,t,r,n,i){if(i%1!=0)throw"can't guess dimensions";if(r||n){if(n){if(!r&&(r=i/n)%1)throw"can't guess dimensions"}else if((n=i/r)%1)throw"can't guess dimensions"}else{var o=Math.sqrt(i/(t===e.TEXTURE_CUBE_MAP?6:1));n=o%1==0?r=o:(r=i,1)}return{width:r,height:n}}function B(e){S.textureColor=new Uint8Array([255*e[0],255*e[1],255*e[2],255*e[3]])}R[6406]={textureFormat:6406,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[a,f,d,u]},R[6409]={textureFormat:6409,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[a,f,d,u]},R[6410]={textureFormat:6410,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[a,f,d,u]},R[i]={textureFormat:i,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[a,f,d,u,33635]},R[o]={textureFormat:o,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[a,f,d,u,32819,32820]},R[33321]={textureFormat:m,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[a]},R[36756]={textureFormat:m,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[s]},R[33325]={textureFormat:m,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[u,f]},R[33326]={textureFormat:m,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[u]},R[33330]={textureFormat:y,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[a]},R[33329]={textureFormat:y,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[s]},R[33332]={textureFormat:y,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[l]},R[33331]={textureFormat:y,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[5122]},R[33334]={textureFormat:y,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[c]},R[33333]={textureFormat:y,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[5124]},R[33323]={textureFormat:p,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[a]},R[36757]={textureFormat:p,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[s]},R[33327]={textureFormat:p,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[u,f]},R[33328]={textureFormat:p,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[u]},R[33336]={textureFormat:_,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[a]},R[33335]={textureFormat:_,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[s]},R[33338]={textureFormat:_,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[l]},R[33337]={textureFormat:_,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[5122]},R[33340]={textureFormat:_,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[c]},R[33339]={textureFormat:_,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[5124]},R[32849]={textureFormat:i,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[a]},R[35905]={textureFormat:i,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[a]},R[36194]={textureFormat:i,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[a,33635]},R[36758]={textureFormat:i,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[s]},R[35898]={textureFormat:i,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[u,f,35899]},R[35901]={textureFormat:i,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[u,f,35902]},R[34843]={textureFormat:i,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[u,f]},R[34837]={textureFormat:i,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[u]},R[36221]={textureFormat:g,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[a]},R[36239]={textureFormat:g,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[s]},R[36215]={textureFormat:g,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[l]},R[36233]={textureFormat:g,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[5122]},R[36209]={textureFormat:g,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[c]},R[36227]={textureFormat:g,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[5124]},R[32856]={textureFormat:o,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[a]},R[35907]={textureFormat:o,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[a]},R[36759]={textureFormat:o,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[s]},R[32855]={textureFormat:o,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[a,32820,33640]},R[32854]={textureFormat:o,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[a,32819]},R[32857]={textureFormat:o,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[33640]},R[34842]={textureFormat:o,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[u,f]},R[34836]={textureFormat:o,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[u]},R[36220]={textureFormat:w,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[a]},R[36238]={textureFormat:w,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[s]},R[36975]={textureFormat:w,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[33640]},R[36214]={textureFormat:w,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[l]},R[36232]={textureFormat:w,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[5122]},R[36226]={textureFormat:w,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[5124]},R[36208]={textureFormat:w,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[c]},R[33189]={textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[l,c]},R[33190]={textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[c]},R[36012]={textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[u]},R[35056]={textureFormat:34041,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[34042]},R[36013]={textureFormat:34041,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[36269]},Object.keys(R).forEach(function(e){var n=R[e];n.bytesPerElementMap={},n.bytesPerElement.forEach(function(e,t){var r=n.type[t];n.bytesPerElementMap[r]=e})});var I={};function H(e,t){void 0!==t.colorspaceConversion&&(I.colorspaceConversion=e.getParameter(e.UNPACK_COLORSPACE_CONVERSION_WEBGL),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.colorspaceConversion)),void 0!==t.premultiplyAlpha&&(I.premultiplyAlpha=e.getParameter(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha)),void 0!==t.flipY&&(I.flipY=e.getParameter(e.UNPACK_FLIP_Y_WEBGL),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY))}function U(e,t){void 0!==t.colorspaceConversion&&e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,I.colorspaceConversion),void 0!==t.premultiplyAlpha&&e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,I.premultiplyAlpha),void 0!==t.flipY&&e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,I.flipY)}function j(e){I.unpackAlignment=e.getParameter(e.UNPACK_ALIGNMENT),v.isWebGL2(e)&&(I.unpackRowLength=e.getParameter(e.UNPACK_ROW_LENGTH),I.unpackImageHeight=e.getParameter(e.UNPACK_IMAGE_HEIGHT),I.unpackSkipPixels=e.getParameter(e.UNPACK_SKIP_PIXELS),I.unpackSkipRows=e.getParameter(e.UNPACK_SKIP_ROWS),I.unpackSkipImages=e.getParameter(e.UNPACK_SKIP_IMAGES))}function N(e){e.pixelStorei(e.UNPACK_ALIGNMENT,I.unpackAlignment),v.isWebGL2(e)&&(e.pixelStorei(e.UNPACK_ROW_LENGTH,I.unpackRowLength),e.pixelStorei(e.UNPACK_IMAGE_HEIGHT,I.unpackImageHeight),e.pixelStorei(e.UNPACK_SKIP_PIXELS,I.unpackSkipPixels),e.pixelStorei(e.UNPACK_SKIP_ROWS,I.unpackSkipRows),e.pixelStorei(e.UNPACK_SKIP_IMAGES,I.unpackSkipImages))}function W(e,t,r,n){n.minMag&&(r.call(e,t,e.TEXTURE_MIN_FILTER,n.minMag),r.call(e,t,e.TEXTURE_MAG_FILTER,n.minMag)),n.min&&r.call(e,t,e.TEXTURE_MIN_FILTER,n.min),n.mag&&r.call(e,t,e.TEXTURE_MAG_FILTER,n.mag),n.wrap&&(r.call(e,t,e.TEXTURE_WRAP_S,n.wrap),r.call(e,t,e.TEXTURE_WRAP_T,n.wrap),t!==e.TEXTURE_3D&&!h.isSampler(e,t)||r.call(e,t,e.TEXTURE_WRAP_R,n.wrap)),n.wrapR&&r.call(e,t,e.TEXTURE_WRAP_R,n.wrapR),n.wrapS&&r.call(e,t,e.TEXTURE_WRAP_S,n.wrapS),n.wrapT&&r.call(e,t,e.TEXTURE_WRAP_T,n.wrapT),n.minLod&&r.call(e,t,e.TEXTURE_MIN_LOD,n.minLod),n.maxLod&&r.call(e,t,e.TEXTURE_MAX_LOD,n.maxLod),n.baseLevel&&r.call(e,t,e.TEXTURE_BASE_LEVEL,n.baseLevel),n.maxLevel&&r.call(e,t,e.TEXTURE_MAX_LEVEL,n.maxLevel)}function z(e,t,r){var n=r.target||e.TEXTURE_2D;e.bindTexture(n,t),W(e,n,e.texParameteri,r)}function G(e,t,r){W(e,t,e.samplerParameteri,r)}function K(e,t){var r=e.createSampler();return G(e,r,t),r}function X(e,t,r,n,i,o,s){r=r||S.textureOptions,o=o||e.RGBA,s=s||e.UNSIGNED_BYTE;var a=r.target||e.TEXTURE_2D;if(n=n||r.width,i=i||r.height,e.bindTexture(a,t),O(e,n,i,o))e.generateMipmap(a);else{var l=D(o)?e.LINEAR:e.NEAREST;e.texParameteri(a,e.TEXTURE_MIN_FILTER,l),e.texParameteri(a,e.TEXTURE_MAG_FILTER,l),e.texParameteri(a,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(a,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}}function V(e){return!0===e.auto||void 0===e.auto&&void 0===e.level}function q(e,t){return(t=t||{}).cubeFaceOrder||[e.TEXTURE_CUBE_MAP_POSITIVE_X,e.TEXTURE_CUBE_MAP_NEGATIVE_X,e.TEXTURE_CUBE_MAP_POSITIVE_Y,e.TEXTURE_CUBE_MAP_NEGATIVE_Y,e.TEXTURE_CUBE_MAP_POSITIVE_Z,e.TEXTURE_CUBE_MAP_NEGATIVE_Z]}function Y(e,t){var r=q(e,t).map(function(e,t){return{face:e,ndx:t}});return r.sort(function(e,t){return e.face-t.face}),r}function Z(n,i,o,s){var a=(s=s||S.textureOptions).target||n.TEXTURE_2D,l=s.level||0,c=o.width,u=o.height,h=s.internalFormat||s.format||n.RGBA,e=k(h),f=s.format||e.format,d=s.type||e.type;if(H(n,s),n.bindTexture(a,i),a===n.TEXTURE_CUBE_MAP){var p,_,t=o.width,r=o.height;if(t/6===r)p=r,_=[0,0,1,0,2,0,3,0,4,0,5,0];else if(r/6===t)p=t,_=[0,0,0,1,0,2,0,3,0,4,0,5];else if(t/3==r/2)p=t/3,_=[0,0,1,0,2,0,0,1,1,1,2,1];else{if(t/2!=r/3)throw"can't figure out cube map from element: "+(o.src?o.src:o.nodeName);p=t/2,_=[0,0,1,0,0,1,1,1,0,2,1,2]}x?(x.canvas.width=p,x.canvas.height=p,u=c=p,Y(n,s).forEach(function(e){var t=_[2*e.ndx+0]*p,r=_[2*e.ndx+1]*p;x.drawImage(o,t,r,p,p,0,0,p,p),n.texImage2D(e.face,l,h,f,d,x.canvas)}),x.canvas.width=1,x.canvas.height=1):"undefined"!=typeof createImageBitmap&&(u=c=p,Y(n,s).forEach(function(t){var e=_[2*t.ndx+0]*p,r=_[2*t.ndx+1]*p;n.texImage2D(t.face,l,h,p,p,0,f,d,null),createImageBitmap(o,e,r,p,p,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(function(e){H(n,s),n.bindTexture(a,i),n.texImage2D(t.face,l,h,f,d,e),U(n,s),V(s)&&X(n,i,s,c,u,h,d)})}))}else if(a===n.TEXTURE_3D||a===n.TEXTURE_2D_ARRAY){var m=Math.min(o.width,o.height),y=Math.max(o.width,o.height),g=y/m;if(g%1!=0)throw"can not compute 3D dimensions of element";var v=o.width===y?1:0,b=o.height===y?1:0;j(n),n.pixelStorei(n.UNPACK_ALIGNMENT,1),n.pixelStorei(n.UNPACK_ROW_LENGTH,o.width),n.pixelStorei(n.UNPACK_IMAGE_HEIGHT,0),n.pixelStorei(n.UNPACK_SKIP_IMAGES,0),n.texImage3D(a,l,h,m,m,m,0,f,d,null);for(var C=0;C<g;++C){var w=C*m*v,E=C*m*b;n.pixelStorei(n.UNPACK_SKIP_PIXELS,w),n.pixelStorei(n.UNPACK_SKIP_ROWS,E),n.texSubImage3D(a,l,0,0,C,m,m,1,f,d,o)}N(n)}else n.texImage2D(a,l,h,f,d,o);U(n,s),V(s)&&X(n,i,s,c,u,h,d),z(n,i,s)}function J(){}function $(e,t){return void 0!==t||function(e){if("undefined"!=typeof document){var t=document.createElement("a");return t.href=e,t.hostname===location.hostname&&t.port===location.port&&t.protocol===location.protocol}var r=new URL(location.href).origin;return new URL(e,location.href).origin===r}(e)?t:"anonymous"}function Q(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof ImageData&&e instanceof ImageData||"undefined"!=typeof HTMLElement&&e instanceof HTMLElement}function ee(e,t,r){return Q(e)?(setTimeout(function(){r(null,e)}),e):function(t,e,r){var n;if(r=r||J,e=void 0!==e?e:S.crossOrigin,e=$(t,e),"undefined"!=typeof Image){n=new Image,void 0!==e&&(n.crossOrigin=e);var i=function(){n.removeEventListener("error",o),n.removeEventListener("load",s),n=null},o=function(){var e="couldn't load image: "+t;h.error(e),r(e,n),i()},s=function(){r(null,n),i()};return n.addEventListener("error",o),n.addEventListener("load",s),n.src=t,n}if("undefined"!=typeof ImageBitmap){var a,l,c=function(){r(a,l)},u={};e&&(u.mode="cors"),fetch(t,u).then(function(e){if(!e.ok)throw e;return e.blob()}).then(function(e){return createImageBitmap(e,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}).then(function(e){l=e,setTimeout(c)}).catch(function(e){a=e,setTimeout(c)}),n=null}return n}(e,t,r)}function te(e,t,r){var n=(r=r||S.textureOptions).target||e.TEXTURE_2D;if(e.bindTexture(n,t),!1!==r.color){var i=function(e){return e=e||S.textureColor,C(e)?e:new Uint8Array([255*e[0],255*e[1],255*e[2],255*e[3]])}(r.color);if(n===e.TEXTURE_CUBE_MAP)for(var o=0;o<6;++o)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i);else n===e.TEXTURE_3D||n===e.TEXTURE_2D_ARRAY?e.texImage3D(n,0,e.RGBA,1,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i):e.texImage2D(n,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i)}}function re(r,n,i,o){return o=o||J,i=i||S.textureOptions,te(r,n,i),ee((i=Object.assign({},i)).src,i.crossOrigin,function(e,t){e?o(e,n,t):(Z(r,n,t,i),o(null,n,t))})}function ne(n,i,o,s){s=s||J;var e=o.src;if(6!==e.length)throw"there must be 6 urls for a cubemap";var a=o.level||0,l=o.internalFormat||o.format||n.RGBA,t=k(l),c=o.format||t.format,u=o.type||n.UNSIGNED_BYTE,h=o.target||n.TEXTURE_2D;if(h!==n.TEXTURE_CUBE_MAP)throw"target must be TEXTURE_CUBE_MAP";te(n,i,o),o=Object.assign({},o);var f,d=6,p=[],r=q(n,o);f=e.map(function(e,t){return ee(e,o.crossOrigin,function(r){return function(e,t){--d,e?p.push(e):t.width!==t.height?p.push("cubemap face img is not a square: "+t.src):(H(n,o),n.bindTexture(h,i),5===d?q(n).forEach(function(e){n.texImage2D(e,a,l,c,u,t)}):n.texImage2D(r,a,l,c,u,t),U(n,o),V(o)&&n.generateMipmap(h)),0===d&&s(p.length?p:void 0,i,f)}}(r[t]))})}function ie(o,s,a,l){l=l||J;var e=a.src,c=a.internalFormat||a.format||o.RGBA,t=k(c),u=a.format||t.format,h=a.type||o.UNSIGNED_BYTE,f=a.target||o.TEXTURE_2D_ARRAY;if(f!==o.TEXTURE_3D&&f!==o.TEXTURE_2D_ARRAY)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";te(o,s,a),a=Object.assign({},a);var d,p=e.length,_=[],m=a.level||0,y=a.width,g=a.height,v=e.length,b=!0;d=e.map(function(e,t){return ee(e,a.crossOrigin,function(i){return function(e,t){if(--p,e)_.push(e);else{if(H(o,a),o.bindTexture(f,s),b){b=!1,y=a.width||t.width,g=a.height||t.height,o.texImage3D(f,m,c,y,g,v,0,u,h,null);for(var r=0;r<v;++r)o.texSubImage3D(f,m,0,0,r,y,g,1,u,h,t)}else{var n=t;t.width===y&&t.height===g||(n=x.canvas,x.canvas.width=y,x.canvas.height=g,x.drawImage(t,0,0,y,g)),o.texSubImage3D(f,m,0,0,i,y,g,1,u,h,n),n===x.canvas&&(x.canvas.width=0,x.canvas.height=0)}U(o,a),V(a)&&o.generateMipmap(f)}0===p&&l(_.length?_:void 0,s,d)}}(t))})}function oe(n,e,i,t){var r=(t=t||S.textureOptions).target||n.TEXTURE_2D;n.bindTexture(r,e);var o=t.width,s=t.height,a=t.depth,l=t.level||0,c=t.internalFormat||t.format||n.RGBA,u=k(c),h=t.format||u.format,f=t.type||F(n,i,u.type);if(C(i))i instanceof Uint8ClampedArray&&(i=new Uint8Array(i.buffer));else{var d=b.getTypedArrayTypeForGLType(f);i=new d(i)}var p,_=L(c,f),m=i.byteLength/_;if(m%1)throw"length wrong size for format: "+v.glEnumToString(n,h);if(r===n.TEXTURE_3D)if(o||s||a)!o||s&&a?!s||o&&a?(p=P(n,r,o,s,m/a),o=p.width,s=p.height):(p=P(n,r,o,a,m/s),o=p.width,a=p.height):(p=P(n,r,s,a,m/o),s=p.width,a=p.height);else{var y=Math.cbrt(m);if(y%1!=0)throw"can't guess cube size of array of numElements: "+m;a=s=o=y}else p=P(n,r,o,s,m),o=p.width,s=p.height;if(j(n),n.pixelStorei(n.UNPACK_ALIGNMENT,t.unpackAlignment||1),H(n,t),r===n.TEXTURE_CUBE_MAP){var g=m/6*(_/i.BYTES_PER_ELEMENT);Y(n,t).forEach(function(e){var t=g*e.ndx,r=i.subarray(t,t+g);n.texImage2D(e.face,l,c,o,s,0,h,f,r)})}else r===n.TEXTURE_3D?n.texImage3D(r,l,c,o,s,a,0,h,f,i):n.texImage2D(r,l,c,o,s,0,h,f,i);return U(n,t),N(n),{width:o,height:s,depth:a,type:f}}function se(e,t,r){var n=r.target||e.TEXTURE_2D;e.bindTexture(n,t);var i=r.level||0,o=r.internalFormat||r.format||e.RGBA,s=k(o),a=r.format||s.format,l=r.type||s.type;if(H(e,r),n===e.TEXTURE_CUBE_MAP)for(var c=0;c<6;++c)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+c,i,o,r.width,r.height,0,a,l,null);else n===e.TEXTURE_3D?e.texImage3D(n,i,o,r.width,r.height,r.depth,0,a,l,null):e.texImage2D(n,i,o,r.width,r.height,0,a,l,null);U(e,r)}function ae(e,t,r){r=r||J,t=t||S.textureOptions;var n=e.createTexture(),i=t.target||e.TEXTURE_2D,o=t.width||1,s=t.height||1,a=t.internalFormat||e.RGBA,l=k(a),c=t.type||l.type;e.bindTexture(i,n),i===e.TEXTURE_CUBE_MAP&&(e.texParameteri(i,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(i,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE));var u=t.src;if(u)if("function"==typeof u&&(u=u(e,t)),"string"==typeof u)re(e,n,t,r);else if(C(u)||Array.isArray(u)&&("number"==typeof u[0]||Array.isArray(u[0])||C(u[0]))){var h=oe(e,n,u,t);o=h.width,s=h.height,c=h.type}else if(Array.isArray(u)&&("string"==typeof u[0]||Q(u[0])))i===e.TEXTURE_CUBE_MAP?ne(e,n,t,r):ie(e,n,t,r);else{if(!Q(u))throw"unsupported src type";Z(e,n,u,t),o=u.width,s=u.height}else se(e,n,t);return V(t)&&X(e,n,t,o,s,a,c),z(e,n,t),n}},"./src/twgl-full.js":function(e,t,r){"use strict";var n={m4:t.__esModule=!0,v3:!0,primitives:!0};t.primitives=t.v3=t.m4=void 0;var i=l(r("./src/m4.js"));t.m4=i;var o=l(r("./src/v3.js"));t.v3=o;var s=l(r("./src/primitives.js"));t.primitives=s;var a=r("./src/twgl.js");function l(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(t[e]=a[e]))})},"./src/twgl.js":function(e,t,r){"use strict";var n={addExtensionsToContext:t.__esModule=!0,getContext:!0,getWebGLContext:!0,resizeCanvasToDisplaySize:!0,setDefaults:!0};t.addExtensionsToContext=g,t.getContext=function(e,t){return function(e,t){for(var r=["webgl2","webgl","experimental-webgl"],n=null,i=0;i<r.length;++i)if(n=e.getContext(r[i],t)){p.addExtensionsToContext&&g(n);break}return n}(e,t)},t.getWebGLContext=function(e,t){return function(e,t){for(var r=["webgl","experimental-webgl"],n=null,i=0;i<r.length;++i)if(n=e.getContext(r[i],t)){p.addExtensionsToContext&&g(n);break}return n}(e,t)},t.resizeCanvasToDisplaySize=function(e,t){t=t||1,t=Math.max(0,t);var r=e.clientWidth*t|0,n=e.clientHeight*t|0;return(e.width!==r||e.height!==n)&&(e.width=r,e.height=n,!0)},t.setDefaults=function(e){h.copyExistingProperties(e,p),i.setAttributeDefaults_(e),o.setTextureDefaults_(e)};var i=d(r("./src/attributes.js"));Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(t[e]=i[e]))});var o=d(r("./src/textures.js"));Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(t[e]=o[e]))});var h=d(r("./src/helper.js")),f=d(r("./src/utils.js"));Object.keys(f).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(t[e]=f[e]))});var s=r("./src/draw.js");Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(t[e]=s[e]))});var a=r("./src/framebuffers.js");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(t[e]=a[e]))});var l=r("./src/programs.js");Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(t[e]=l[e]))});var c=r("./src/typedarrays.js");Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(t[e]=c[e]))});var u=r("./src/vertex-arrays.js");function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||(t[e]=u[e]))});var p={addExtensionsToContext:!0};var _=/^(.*?)_/;function m(e,t){f.glEnumToString(e,0);var r=e.getExtension(t);if(r){var n={},i=_.exec(t)[1],o="_"+i;for(var s in r){var a=r[s],l="function"==typeof a,c=l?i:o,u=s;s.endsWith(c)&&(u=s.substring(0,s.length-c.length)),void 0!==e[u]?l||e[u]===a||h.warn(u,e[u],a,s):l?e[u]=function(e){return function(){return e.apply(r,arguments)}}(a):(e[u]=a,n[u]=a)}n.constructor={name:r.constructor.name},f.glEnumToString(n,0)}return r}var y=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_depth_texture","WEBGL_draw_buffers"];function g(e){for(var t=0;t<y.length;++t)m(e,y[t])}},"./src/typedarrays.js":function(e,t,r){"use strict";t.__esModule=!0,t.getGLTypeForTypedArray=function(e){if(e instanceof Int8Array)return n;if(e instanceof Uint8Array)return i;if(e instanceof Uint8ClampedArray)return i;if(e instanceof Int16Array)return o;if(e instanceof Uint16Array)return s;if(e instanceof Int32Array)return a;if(e instanceof Uint32Array)return l;if(e instanceof Float32Array)return c;throw new Error("unsupported typed array type")},t.getGLTypeForTypedArrayType=function(e){if(e===Int8Array)return n;if(e===Uint8Array)return i;if(e===Uint8ClampedArray)return i;if(e===Int16Array)return o;if(e===Uint16Array)return s;if(e===Int32Array)return a;if(e===Uint32Array)return l;if(e!==Float32Array)throw new Error("unsupported typed array type");return c},t.getTypedArrayTypeForGLType=function(e){var t=u[e];if(t)return t;throw new Error("unknown gl type")};t.isArrayBuffer=void 0;var n=5120,i=5121,o=5122,s=5123,a=5124,l=5125,c=5126,u={},h=u;h[n]=Int8Array,h[i]=Uint8Array,h[o]=Int16Array,h[s]=Uint16Array,h[a]=Int32Array,h[l]=Uint32Array,h[c]=Float32Array,h[32819]=Uint16Array,h[32820]=Uint16Array,h[33635]=Uint16Array,h[5131]=Uint16Array,h[33640]=Uint32Array,h[35899]=Uint32Array,h[35902]=Uint32Array,h[36269]=Uint32Array,h[34042]=Uint32Array;var f="undefined"!=typeof SharedArrayBuffer?function(e){return e&&e.buffer&&(e.buffer instanceof ArrayBuffer||e.buffer instanceof SharedArrayBuffer)}:function(e){return e&&e.buffer&&e.buffer instanceof ArrayBuffer};t.isArrayBuffer=f},"./src/utils.js":function(e,t,r){"use strict";t.__esModule=!0,t.isWebGL1=function(e){return!e.texStorage2D},t.isWebGL2=function(e){return!!e.texStorage2D},t.glEnumToString=void 0;var i,o,n=(i={},o={},function(e,t){return function(e){var t=e.constructor.name;if(!i[t]){for(var r in e)if("number"==typeof e[r]){var n=o[e[r]];o[e[r]]=n?"".concat(n," | ").concat(r):r}i[t]=!0}}(e),o[t]||"0x"+t.toString(16)});t.glEnumToString=n},"./src/v3.js":function(e,t,r){"use strict";t.__esModule=!0,t.add=function(e,t,r){return(r=r||new o(3))[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r},t.copy=function(e,t){return(t=t||new o(3))[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.create=function(e,t,r){var n=new o(3);e&&(n[0]=e);t&&(n[1]=t);r&&(n[2]=r);return n},t.cross=function(e,t,r){r=r||new o(3);var n=e[2]*t[0]-e[0]*t[2],i=e[0]*t[1]-e[1]*t[0];return r[0]=e[1]*t[2]-e[2]*t[1],r[1]=n,r[2]=i,r},t.distance=function(e,t){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(r*r+n*n+i*i)},t.distanceSq=function(e,t){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return r*r+n*n+i*i},t.divide=function(e,t,r){return(r=r||new o(3))[0]=e[0]/t[0],r[1]=e[1]/t[1],r[2]=e[2]/t[2],r},t.divScalar=function(e,t,r){return(r=r||new o(3))[0]=e[0]/t,r[1]=e[1]/t,r[2]=e[2]/t,r},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},t.lerp=function(e,t,r,n){return(n=n||new o(3))[0]=e[0]+r*(t[0]-e[0]),n[1]=e[1]+r*(t[1]-e[1]),n[2]=e[2]+r*(t[2]-e[2]),n},t.lerpV=function(e,t,r,n){return(n=n||new o(3))[0]=e[0]+r[0]*(t[0]-e[0]),n[1]=e[1]+r[1]*(t[1]-e[1]),n[2]=e[2]+r[2]*(t[2]-e[2]),n},t.length=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])},t.lengthSq=function(e){return e[0]*e[0]+e[1]*e[1]+e[2]*e[2]},t.max=function(e,t,r){return(r=r||new o(3))[0]=Math.max(e[0],t[0]),r[1]=Math.max(e[1],t[1]),r[2]=Math.max(e[2],t[2]),r},t.min=function(e,t,r){return(r=r||new o(3))[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r},t.mulScalar=function(e,t,r){return(r=r||new o(3))[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r},t.multiply=function(e,t,r){return(r=r||new o(3))[0]=e[0]*t[0],r[1]=e[1]*t[1],r[2]=e[2]*t[2],r},t.negate=function(e,t){return(t=t||new o(3))[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},t.normalize=function(e,t){t=t||new o(3);var r=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=Math.sqrt(r);1e-5<n?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=0,t[1]=0,t[2]=0);return t},t.setDefaultType=function(e){var t=o;return o=e,t},t.subtract=function(e,t,r){return(r=r||new o(3))[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r};var o=Float32Array},"./src/vertex-arrays.js":function(e,t,r){"use strict";t.__esModule=!0,t.createVertexArrayInfo=function(t,e,r){var n=t.createVertexArray();t.bindVertexArray(n),e.length||(e=[e]);return e.forEach(function(e){o.setBuffersAndAttributes(t,e,r)}),t.bindVertexArray(null),{numElements:r.numElements,elementType:r.elementType,vertexArrayObject:n}},t.createVAOAndSetAttributes=n,t.createVAOFromBufferInfo=function(e,t,r){return n(e,t.attribSetters||t,r.attribs,r.indices)};var o=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}}(r("./src/programs.js"));function n(e,t,r,n){var i=e.createVertexArray();return e.bindVertexArray(i),o.setAttributes(t,r),n&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n),e.bindVertexArray(null),i}}},i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s="./src/twgl-full.js");function i(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}var r,n},"object"==typeof r&&"object"==typeof t?t.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof r?r.twgl=i():n.twgl=i()},{}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./internal/typestyle");r.TypeStyle=n.TypeStyle;var i=e("./types");r.types=i;var o=e("./internal/utilities");r.extend=o.extend,r.classes=o.classes,r.media=o.media;var s=new n.TypeStyle({autoGenerateTag:!0});r.setStylesTarget=s.setStylesTarget,r.cssRaw=s.cssRaw,r.cssRule=s.cssRule,r.forceRenderStyles=s.forceRenderStyles,r.fontFace=s.fontFace,r.getStyles=s.getStyles,r.keyframes=s.keyframes,r.reinit=s.reinit,r.style=s.style,r.stylesheet=s.stylesheet,r.createTypeStyle=function(e){var t=new n.TypeStyle({autoGenerateTag:!1});return e&&t.setStylesTarget(e),t}},{"./internal/typestyle":15,"./internal/utilities":16,"./types":17}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var c=e("free-style");r.ensureStringObj=function e(t){var r={},n="";for(var i in t){var o=t[i];if("$unique"===i)r[c.IS_UNIQUE]=o;else if("$nest"===i){var s=o;for(var a in s){var l=s[a];r[a]=e(l).result}}else"$debugName"===i?n=o:r[i]=o}return{result:r,debugName:n}},r.explodeKeyframes=function(e){var t={$debugName:void 0,keyframes:{}};for(var r in e){var n=e[r];"$debugName"===r?t.$debugName=n:t.keyframes[r]=n}return t}},{"free-style":8}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});function n(){return i.create(void 0,!0)}var i=e("free-style"),o=e("./formatting"),a=e("./utilities"),s=(l.prototype._afterAllSync=function(e){var t=this;this._pending++;var r=this._pending;a.raf(function(){r===t._pending&&e()})},l.prototype._getTag=function(){if(this._tag)return this._tag;if(this._autoGenerateTag){var e="undefined"==typeof window?{textContent:""}:document.createElement("style");return"undefined"!=typeof document&&document.head.appendChild(e),this._tag=e}},l.prototype._styleUpdated=function(){var e=this,t=this._freeStyle.changeId,r=this._lastFreeStyleChangeId;!this._pendingRawChange&&t===r||(this._lastFreeStyleChangeId=t,this._pendingRawChange=!1,this._afterAllSync(function(){return e.forceRenderStyles()}))},l.prototype.style=function(){var e=this._freeStyle,t=o.ensureStringObj(a.extend.apply(void 0,arguments)),r=t.result,n=t.debugName,i=n?e.registerStyle(r,n):e.registerStyle(r);return this._styleUpdated(),i},l);function l(e){var t=e.autoGenerateTag,s=this;this.cssRaw=function(e){e&&(s._raw+=e||"",s._pendingRawChange=!0,s._styleUpdated())},this.cssRule=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=o.ensureStringObj(a.extend.apply(void 0,t)).result;s._freeStyle.registerRule(e,n),s._styleUpdated()},this.forceRenderStyles=function(){var e=s._getTag();e&&(e.textContent=s.getStyles())},this.fontFace=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=s._freeStyle,n=0,i=e;n<i.length;n++){var o=i[n];r.registerRule("@font-face",o)}s._styleUpdated()},this.getStyles=function(){return(s._raw||"")+s._freeStyle.getStyles()},this.keyframes=function(e){var t=o.explodeKeyframes(e),r=t.keyframes,n=t.$debugName,i=s._freeStyle.registerKeyframes(r,n);return s._styleUpdated(),i},this.reinit=function(){var e=n();s._freeStyle=e,s._lastFreeStyleChangeId=e.changeId,s._raw="",s._pendingRawChange=!1;var t=s._getTag();t&&(t.textContent="")},this.setStylesTarget=function(e){s._tag&&(s._tag.textContent=""),s._tag=e,s.forceRenderStyles()},this.stylesheet=function(e){for(var t={},r=0,n=Object.getOwnPropertyNames(e);r<n.length;r++){var i=n[r],o=e[i];o&&(t[o.$debugName=i]=s.style(o))}return t};var r=n();this._autoGenerateTag=t,this._freeStyle=r,this._lastFreeStyleChangeId=r.changeId,this._pending=0,this._pendingRawChange=!1,this._raw="",this._tag=void 0,this.style=this.style.bind(this)}r.TypeStyle=s},{"./formatting":14,"./utilities":16,"free-style":8}],16:[function(e,t,r){"use strict";function l(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r={},n=0,i=e;n<i.length;n++){var o=i[n];if(null!=o&&!1!==o)for(var s in o){var a=o[s];!a&&0!==a||("$nest"===s&&a?r[s]=r.$nest?l(r.$nest,a):a:-1!==s.indexOf("&")||0===s.indexOf("@media")?r[s]=r[s]?l(r[s],a):a:r[s]=a)}}return r}Object.defineProperty(r,"__esModule",{value:!0}),r.raf="undefined"==typeof requestAnimationFrame?function(e){return setTimeout(e)}:"undefined"==typeof window?requestAnimationFrame:requestAnimationFrame.bind(window),r.classes=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.map(function(t){return t&&"object"==typeof t?Object.keys(t).map(function(e){return!!t[e]&&e}):[t]}).reduce(function(e,t){return e.concat(t)},[]).filter(function(e){return!!e}).join(" ")},r.extend=l,r.media=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n,i=[];return e.type&&i.push(e.type),e.orientation&&i.push("(orientation: "+e.orientation+")"),e.minWidth&&i.push("(min-width: "+o(e.minWidth)+")"),e.maxWidth&&i.push("(max-width: "+o(e.maxWidth)+")"),e.minHeight&&i.push("(min-height: "+o(e.minHeight)+")"),e.maxHeight&&i.push("(max-height: "+o(e.maxHeight)+")"),{$nest:(n={},n["@media "+i.join(" and ")]=l.apply(void 0,t),n)}};var o=function(e){return"string"==typeof e?e:e+"px"}},{}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0})},{}],18:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var o,l=e("./Strings"),s=e("./common/Platform"),a=e("./ui/RenderDebouncer"),c=e("./ui/Lifecycle"),u=e("./common/Lifecycle"),h=e("./ui/ScreenDprMonitor"),f=(o=u.Disposable,i(d,o),d.prototype.dispose=function(){o.prototype.dispose.call(this),this._terminal.element.removeChild(this._accessibilityTreeRoot),this._rowElements.length=0},d.prototype._onBoundaryFocus=function(e,t){var r=e.target,n=this._rowElements[0===t?1:this._rowElements.length-2];if(r.getAttribute("aria-posinset")!==(0===t?"1":""+this._terminal.buffer.lines.length)&&e.relatedTarget===n){var i,o;if(0===t?(i=r,o=this._rowElements.pop(),this._rowContainer.removeChild(o)):(i=this._rowElements.shift(),o=r,this._rowContainer.removeChild(i)),i.removeEventListener("focus",this._topBoundaryFocusListener),o.removeEventListener("focus",this._bottomBoundaryFocusListener),0===t){var s=this._createAccessibilityTreeNode();this._rowElements.unshift(s),this._rowContainer.insertAdjacentElement("afterbegin",s)}else s=this._createAccessibilityTreeNode(),this._rowElements.push(s),this._rowContainer.appendChild(s);this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(0===t?-1:1),this._rowElements[0===t?1:this._rowElements.length-2].focus(),e.preventDefault(),e.stopImmediatePropagation()}},d.prototype._onResize=function(e){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(var t=this._rowContainer.children.length;t<this._terminal.rows;t++)this._rowElements[t]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[t]);for(;this._rowElements.length>e;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()},d.prototype._createAccessibilityTreeNode=function(){var e=document.createElement("div");return e.setAttribute("role","listitem"),e.tabIndex=-1,this._refreshRowDimensions(e),e},d.prototype._onTab=function(e){for(var t=0;t<e;t++)this._onChar(" ")},d.prototype._onChar=function(e){var t=this;this._liveRegionLineCount<21&&(0<this._charsToConsume.length?this._charsToConsume.shift()!==e&&(this._charsToAnnounce+=e):this._charsToAnnounce+=e,"\n"===e&&(this._liveRegionLineCount++,21===this._liveRegionLineCount&&(this._liveRegion.textContent+=l.tooMuchOutput)),s.isMac&&this._liveRegion.textContent&&0<this._liveRegion.textContent.length&&!this._liveRegion.parentNode&&setTimeout(function(){t._accessibilityTreeRoot.appendChild(t._liveRegion)},0))},d.prototype._clearLiveRegion=function(){this._liveRegion.textContent="",this._liveRegionLineCount=0,s.isMac&&this._liveRegion.parentNode&&this._accessibilityTreeRoot.removeChild(this._liveRegion)},d.prototype._onKey=function(e){this._clearLiveRegion(),this._charsToConsume.push(e)},d.prototype._refreshRows=function(e,t){this._renderRowsDebouncer.refresh(e,t,this._terminal.rows)},d.prototype._renderRows=function(e,t){for(var r=this._terminal.buffer,n=r.lines.length.toString(),i=e;i<=t;i++){var o=r.translateBufferLineToString(r.ydisp+i,!0),s=(r.ydisp+i+1).toString(),a=this._rowElements[i];a&&(a.textContent=0===o.length?l.blankLine:o,a.setAttribute("aria-posinset",s),a.setAttribute("aria-setsize",n))}this._announceCharacters()},d.prototype._refreshRowsDimensions=function(){if(this._dimensions.actualCellHeight){this._rowElements.length!==this._terminal.rows&&this._onResize(this._terminal.rows);for(var e=0;e<this._terminal.rows;e++)this._refreshRowDimensions(this._rowElements[e])}},d.prototype.setDimensions=function(e){this._dimensions=e,this._refreshRowsDimensions()},d.prototype._refreshRowDimensions=function(e){e.style.height=this._dimensions.actualCellHeight+"px"},d.prototype._announceCharacters=function(){0!==this._charsToAnnounce.length&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")},d);function d(e,t){var r=o.call(this)||this;r._terminal=e,r._dimensions=t,r._liveRegionLineCount=0,r._charsToConsume=[],r._charsToAnnounce="",r._accessibilityTreeRoot=document.createElement("div"),r._accessibilityTreeRoot.classList.add("xterm-accessibility"),r._rowContainer=document.createElement("div"),r._rowContainer.classList.add("xterm-accessibility-tree"),r._rowElements=[];for(var n=0;n<r._terminal.rows;n++)r._rowElements[n]=r._createAccessibilityTreeNode(),r._rowContainer.appendChild(r._rowElements[n]);return r._topBoundaryFocusListener=function(e){return r._onBoundaryFocus(e,0)},r._bottomBoundaryFocusListener=function(e){return r._onBoundaryFocus(e,1)},r._rowElements[0].addEventListener("focus",r._topBoundaryFocusListener),r._rowElements[r._rowElements.length-1].addEventListener("focus",r._bottomBoundaryFocusListener),r._refreshRowsDimensions(),r._accessibilityTreeRoot.appendChild(r._rowContainer),r._renderRowsDebouncer=new a.RenderDebouncer(r._renderRows.bind(r)),r._refreshRows(),r._liveRegion=document.createElement("div"),r._liveRegion.classList.add("live-region"),r._liveRegion.setAttribute("aria-live","assertive"),r._accessibilityTreeRoot.appendChild(r._liveRegion),r._terminal.element.insertAdjacentElement("afterbegin",r._accessibilityTreeRoot),r.register(r._renderRowsDebouncer),r.register(r._terminal.onResize(function(e){return r._onResize(e.rows)})),r.register(r._terminal.onRender(function(e){return r._refreshRows(e.start,e.end)})),r.register(r._terminal.onScroll(function(){return r._refreshRows()})),r.register(r._terminal.addDisposableListener("a11y.char",function(e){return r._onChar(e)})),r.register(r._terminal.onLineFeed(function(){return r._onChar("\n")})),r.register(r._terminal.addDisposableListener("a11y.tab",function(e){return r._onTab(e)})),r.register(r._terminal.onKey(function(e){return r._onKey(e.key)})),r.register(r._terminal.addDisposableListener("blur",function(){return r._clearLiveRegion()})),r._screenDprMonitor=new h.ScreenDprMonitor,r.register(r._screenDprMonitor),r._screenDprMonitor.setListener(function(){return r._refreshRowsDimensions()}),r.register(c.addDisposableDomListener(window,"resize",function(){return r._refreshRowsDimensions()})),r}r.AccessibilityManager=f},{"./Strings":33,"./common/Lifecycle":42,"./common/Platform":43,"./ui/Lifecycle":77,"./ui/RenderDebouncer":78,"./ui/ScreenDprMonitor":79}],19:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./common/CircularList"),D=e("./core/buffer/BufferLine"),F=e("./core/buffer/BufferReflow"),i=e("./core/buffer/Marker");r.MAX_BUFFER_SIZE=4294967295;var o=(s.prototype.getNullCell=function(e){return e?(this._nullCell.fg=e.fg,this._nullCell.bg=e.bg):(this._nullCell.fg=0,this._nullCell.bg=0),this._nullCell},s.prototype.getWhitespaceCell=function(e){return e?(this._whitespaceCell.fg=e.fg,this._whitespaceCell.bg=e.bg):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0),this._whitespaceCell},s.prototype.getBlankLine=function(e,t){return new D.BufferLine(this._terminal.cols,this.getNullCell(e),t)},Object.defineProperty(s.prototype,"hasScrollback",{get:function(){return this._hasScrollback&&this.lines.maxLength>this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isCursorInViewport",{get:function(){var e=this.ybase+this.y-this.ydisp;return 0<=e&&e<this._rows},enumerable:!0,configurable:!0}),s.prototype._getCorrectBufferLength=function(e){if(!this._hasScrollback)return e;var t=e+this._terminal.options.scrollback;return t>r.MAX_BUFFER_SIZE?r.MAX_BUFFER_SIZE:t},s.prototype.fillViewportRows=function(e){if(0===this.lines.length){void 0===e&&(e=D.DEFAULT_ATTR_DATA);for(var t=this._rows;t--;)this.lines.push(this.getBlankLine(e))}},s.prototype.clear=function(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new n.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()},s.prototype.resize=function(e,t){var r=this.getNullCell(D.DEFAULT_ATTR_DATA),n=this._getCorrectBufferLength(t);if(n>this.lines.maxLength&&(this.lines.maxLength=n),0<this.lines.length){if(this._cols<e)for(var i=0;i<this.lines.length;i++)this.lines.get(i).resize(e,r);var o=0;if(this._rows<t)for(var s=this._rows;s<t;s++)this.lines.length<t+this.ybase&&(0<this.ybase&&this.lines.length<=this.ybase+this.y+o+1?(this.ybase--,o++,0<this.ydisp&&this.ydisp--):this.lines.push(new D.BufferLine(e,r)));else for(s=this._rows;t<s;s--)this.lines.length>t+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(n<this.lines.maxLength){var a=this.lines.length-n;0<a&&(this.lines.trimStart(a),this.ybase=Math.max(this.ybase-a,0),this.ydisp=Math.max(this.ydisp-a,0)),this.lines.maxLength=n}this.x=Math.min(this.x,e-1),this.y=Math.min(this.y,t-1),o&&(this.y+=o),this.savedY=Math.min(this.savedY,t-1),this.savedX=Math.min(this.savedX,e-1),this.scrollTop=0}if(this.scrollBottom=t-1,this._isReflowEnabled&&(this._reflow(e,t),this._cols>e))for(i=0;i<this.lines.length;i++)this.lines.get(i).resize(e,r);this._cols=e,this._rows=t},Object.defineProperty(s.prototype,"_isReflowEnabled",{get:function(){return this._hasScrollback&&!this._terminal.options.windowsMode},enumerable:!0,configurable:!0}),s.prototype._reflow=function(e,t){this._cols!==e&&(e>this._cols?this._reflowLarger(e,t):this._reflowSmaller(e,t))},s.prototype._reflowLarger=function(e,t){var r=F.reflowLargerGetLinesToRemove(this.lines,this._cols,e,this.ybase+this.y,this.getNullCell(D.DEFAULT_ATTR_DATA));if(0<r.length){var n=F.reflowLargerCreateNewLayout(this.lines,r);F.reflowLargerApplyNewLayout(this.lines,n.layout),this._reflowLargerAdjustViewport(e,t,n.countRemoved)}},s.prototype._reflowLargerAdjustViewport=function(e,t,r){for(var n=this.getNullCell(D.DEFAULT_ATTR_DATA),i=r;0<i--;)0===this.ybase?(0<this.y&&this.y--,this.lines.length<t&&this.lines.push(new D.BufferLine(e,n))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--)},s.prototype._reflowSmaller=function(e,t){for(var r=this.getNullCell(D.DEFAULT_ATTR_DATA),n=[],i=0,o=this.lines.length-1;0<=o;o--){var s=this.lines.get(o);if(!(!s||!s.isWrapped&&s.getTrimmedLength()<=e)){for(var a=[s];s.isWrapped&&0<o;)s=this.lines.get(--o),a.unshift(s);var l=this.ybase+this.y;if(!(o<=l&&l<o+a.length)){var c=a[a.length-1].getTrimmedLength(),u=F.reflowSmallerGetNewLineLengths(a,this._cols,e),h=u.length-a.length,f=void 0;f=0===this.ybase&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+h):Math.max(0,this.lines.length-this.lines.maxLength+h);for(var d=[],p=0;p<h;p++){var _=this.getBlankLine(D.DEFAULT_ATTR_DATA,!0);d.push(_)}0<d.length&&(n.push({start:o+a.length+i,newLines:d}),i+=d.length),a.push.apply(a,d);var m=u.length-1,y=u[m];0===y&&(y=u[--m]);for(var g=a.length-h-1,v=c;0<=g;){var b=Math.min(v,y);if(a[m].copyCellsFrom(a[g],v-b,y-b,b,!0),0==(y-=b)&&(y=u[--m]),0==(v-=b)){g--;var C=Math.max(g,0);v=F.getWrappedLineTrimmedLength(a,C,this._cols)}}for(p=0;p<a.length;p++)u[p]<e&&a[p].setCell(u[p],r);for(var w=h-f;0<w--;)0===this.ybase?this.y<t-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+i)-t&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++)}}}if(0<n.length){var E=[],S=[];for(p=0;p<this.lines.length;p++)S.push(this.lines.get(p));var x=this.lines.length,A=x-1,T=0,R=n[T];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+i);var L=0;for(p=Math.min(this.lines.maxLength-1,x+i-1);0<=p;p--)if(R&&R.start>A+L){for(var k=R.newLines.length-1;0<=k;k--)this.lines.set(p--,R.newLines[k]);p++,E.push({index:A+1,amount:R.newLines.length}),L+=R.newLines.length,R=n[++T]}else this.lines.set(p,S[A--]);var M=0;for(p=E.length-1;0<=p;p--)E[p].index+=M,this.lines.onInsertEmitter.fire(E[p]),M+=E[p].amount;var O=Math.max(0,x+i-this.lines.maxLength);0<O&&this.lines.onTrimEmitter.fire(O)}},s.prototype.stringIndexToBufferIndex=function(e,t,r){for(void 0===r&&(r=!1);t;){var n=this.lines.get(e);if(!n)return[-1,-1];for(var i=r?n.getTrimmedLength():n.length,o=0;o<i;++o)if(n.get(o)[D.CHAR_DATA_WIDTH_INDEX]&&(t-=n.get(o)[D.CHAR_DATA_CHAR_INDEX].length||1),t<0)return[e,o];e++}return[e,0]},s.prototype.translateBufferLineToString=function(e,t,r,n){void 0===r&&(r=0);var i=this.lines.get(e);return i?i.translateToString(t,r,n):""},s.prototype.getWrappedRangeForLine=function(e){for(var t=e,r=e;0<t&&this.lines.get(t).isWrapped;)t--;for(;r+1<this.lines.length&&this.lines.get(r+1).isWrapped;)r++;return{first:t,last:r}},s.prototype.setupTabStops=function(e){for(null!=e?this.tabs[e]||(e=this.prevStop(e)):(this.tabs={},e=0);e<this._cols;e+=this._terminal.options.tabStopWidth)this.tabs[e]=!0},s.prototype.prevStop=function(e){for(null==e&&(e=this.x);!this.tabs[--e]&&0<e;);return e>=this._cols?this._cols-1:e<0?0:e},s.prototype.nextStop=function(e){for(null==e&&(e=this.x);!this.tabs[++e]&&e<this._cols;);return e>=this._cols?this._cols-1:e<0?0:e},s.prototype.addMarker=function(e){var t=this,r=new i.Marker(e);return this.markers.push(r),r.register(this.lines.onTrim(function(e){r.line-=e,r.line<0&&r.dispose()})),r.register(this.lines.onInsert(function(e){r.line>=e.index&&(r.line+=e.amount)})),r.register(this.lines.onDelete(function(e){r.line>=e.index&&r.line<e.index+e.amount&&r.dispose(),r.line>e.index&&(r.line-=e.amount)})),r.register(r.onDispose(function(){return t._removeMarker(r)})),r},s.prototype._removeMarker=function(e){this.markers.splice(this.markers.indexOf(e),1)},s.prototype.iterator=function(e,t,r,n,i){return new a(this,e,t,r,n,i)},s);function s(e,t){this._terminal=e,this._hasScrollback=t,this.savedCurAttrData=D.DEFAULT_ATTR_DATA.clone(),this.markers=[],this._nullCell=D.CellData.fromCharData([0,D.NULL_CELL_CHAR,D.NULL_CELL_WIDTH,D.NULL_CELL_CODE]),this._whitespaceCell=D.CellData.fromCharData([0,D.WHITESPACE_CELL_CHAR,D.WHITESPACE_CELL_WIDTH,D.WHITESPACE_CELL_CODE]),this._cols=this._terminal.cols,this._rows=this._terminal.rows,this.clear()}r.Buffer=o;var a=(l.prototype.hasNext=function(){return this._current<this._endIndex},l.prototype.next=function(){var e=this._buffer.getWrappedRangeForLine(this._current);e.first<this._startIndex-this._startOverscan&&(e.first=this._startIndex-this._startOverscan),e.last>this._endIndex+this._endOverscan&&(e.last=this._endIndex+this._endOverscan),e.first=Math.max(e.first,0),e.last=Math.min(e.last,this._buffer.lines.length);for(var t="",r=e.first;r<=e.last;++r)t+=this._buffer.translateBufferLineToString(r,this._trimRight);return this._current=e.last+1,{range:e,content:t}},l);function l(e,t,r,n,i,o){void 0===r&&(r=0),void 0===n&&(n=e.lines.length),void 0===i&&(i=0),void 0===o&&(o=0),this._buffer=e,this._trimRight=t,this._startIndex=r,this._endIndex=n,this._startOverscan=i,this._endOverscan=o,this._startIndex<0&&(this._startIndex=0),this._endIndex>this._buffer.lines.length&&(this._endIndex=this._buffer.lines.length),this._current=this._startIndex}r.BufferStringIterator=a},{"./common/CircularList":38,"./core/buffer/BufferLine":47,"./core/buffer/BufferReflow":48,"./core/buffer/Marker":49}],20:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./Buffer"),i=e("./common/EventEmitter2"),o=(Object.defineProperty(s.prototype,"onBufferActivate",{get:function(){return this._onBufferActivate.event},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"alt",{get:function(){return this._alt},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"active",{get:function(){return this._activeBuffer},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"normal",{get:function(){return this._normal},enumerable:!0,configurable:!0}),s.prototype.activateNormalBuffer=function(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))},s.prototype.activateAltBuffer=function(e){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(e),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))},s.prototype.resize=function(e,t){this._normal.resize(e,t),this._alt.resize(e,t)},s.prototype.setupTabStops=function(e){this._normal.setupTabStops(e),this._alt.setupTabStops(e)},s);function s(e){this._terminal=e,this._onBufferActivate=new i.EventEmitter2,this._normal=new n.Buffer(this._terminal,!0),this._normal.fillViewportRows(),this._alt=new n.Buffer(this._terminal,!1),this._activeBuffer=this._normal,this.setupTabStops()}r.BufferSet=o},{"./Buffer":19,"./common/EventEmitter2":41}],21:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./common/EventEmitter2"),i=(Object.defineProperty(o.prototype,"onCharSizeChanged",{get:function(){return this._onCharSizeChanged.event},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),o.prototype.measure=function(e){this._measureElement.style.fontFamily=e.fontFamily,this._measureElement.style.fontSize=e.fontSize+"px";var t=this._measureElement.getBoundingClientRect();if(0!==t.width&&0!==t.height){var r=Math.ceil(t.height);this._width===t.width&&this._height===r||(this._width=t.width,this._height=r,this._onCharSizeChanged.fire())}},o);function o(e,t){this._onCharSizeChanged=new n.EventEmitter2,this._document=e,this._parentElement=t,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}r.CharMeasure=i},{"./common/EventEmitter2":41}],22:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=e("./common/TypedArrayUtils");s.wcwidth=function(e){var t=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],r=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];var n=0|e.control,i=new Uint8Array(65536);a.fill(i,1),i[0]=e.nul,a.fill(i,e.control,1,32),a.fill(i,e.control,127,160),a.fill(i,2,4352,4448),i[9001]=2,i[9002]=2,a.fill(i,2,11904,42192),i[12351]=1,a.fill(i,2,44032,55204),a.fill(i,2,63744,64256),a.fill(i,2,65040,65050),a.fill(i,2,65072,65136),a.fill(i,2,65280,65377),a.fill(i,2,65504,65511);for(var o=0;o<t.length;++o)a.fill(i,0,t[o][0],t[o][1]+1);return function(e){return e<32?0|n:e<127?1:e<65536?i[e]:function(e){return function(e,t){var r,n=0,i=t.length-1;if(e<t[0][0]||e>t[i][1])return!1;for(;n<=i;)if(e>t[r=n+i>>1][1])n=1+r;else{if(!(e<t[r][0]))return!0;i=r-1}return!1}(e,r)?0:131072<=e&&e<=196605||196608<=e&&e<=262141?2:1}(e)}}({nul:0,control:0}),s.getStringCellWidth=function(e){for(var t=0,r=e.length,n=0;n<r;++n){var i=e.charCodeAt(n);if(55296<=i&&i<=56319){if(++n>=r)return t+s.wcwidth(i);var o=e.charCodeAt(n);56320<=o&&o<=57343?i=1024*(i-55296)+o-56320+65536:t+=s.wcwidth(o)}t+=s.wcwidth(i)}return t}},{"./common/TypedArrayUtils":44}],23:[function(e,t,r){"use strict";function n(e){return e.replace(/\r?\n/g,"\r")}function i(e,t){return t?"[200~"+e+"[201~":e}function o(e,t){var r=t.screenElement.getBoundingClientRect(),n=e.clientX-r.left-10,i=e.clientY-r.top-10;t.textarea.style.position="absolute",t.textarea.style.width="20px",t.textarea.style.height="20px",t.textarea.style.left=n+"px",t.textarea.style.top=i+"px",t.textarea.style.zIndex="1000",t.textarea.focus(),setTimeout(function(){t.textarea.style.position=null,t.textarea.style.width=null,t.textarea.style.height=null,t.textarea.style.left=null,t.textarea.style.top=null,t.textarea.style.zIndex=null},200)}Object.defineProperty(r,"__esModule",{value:!0}),r.prepareTextForTerminal=n,r.bracketTextForPaste=i,r.copyHandler=function(e,t,r){t.browser.isMSIE?window.clipboardData.setData("Text",r.selectionText):e.clipboardData.setData("text/plain",r.selectionText),e.preventDefault()},r.pasteHandler=function(t,r){function e(e){e=i(e=n(e),r.bracketedPasteMode),r.handler(e),r.textarea.value="",r.emit("paste",e),r.cancel(t)}t.stopPropagation(),r.browser.isMSIE?window.clipboardData&&e(window.clipboardData.getData("Text")):t.clipboardData&&e(t.clipboardData.getData("text/plain"))},r.moveTextAreaUnderMouseCursor=o,r.rightClickHandler=function(e,t,r,n){o(e,t),n&&!r.isClickInSelection(e)&&r.selectWordAtCursor(e),t.textarea.value=r.selectionText,t.textarea.select()}},{}],24:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=(i.prototype.compositionstart=function(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._compositionView.classList.add("active")},i.prototype.compositionupdate=function(e){var t=this;this._compositionView.textContent=e.data,this.updateCompositionElements(),setTimeout(function(){t._compositionPosition.end=t._textarea.value.length},0)},i.prototype.compositionend=function(){this._finalizeComposition(!0)},i.prototype.keydown=function(e){if(this._isComposing||this._isSendingComposition){if(229===e.keyCode)return!1;if(16===e.keyCode||17===e.keyCode||18===e.keyCode)return!1;this._finalizeComposition(!1)}return 229!==e.keyCode||(this._handleAnyTextareaChanges(),!1)},i.prototype._finalizeComposition=function(e){var t=this;if(this._compositionView.classList.remove("active"),this._isComposing=!1,this._clearTextareaPosition(),e){var r={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(function(){if(t._isSendingComposition){t._isSendingComposition=!1;var e=void 0;e=t._isComposing?t._textarea.value.substring(r.start,r.end):t._textarea.value.substring(r.start),t._terminal.handler(e)}},0)}else{this._isSendingComposition=!1;var n=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._terminal.handler(n)}},i.prototype._handleAnyTextareaChanges=function(){var t=this,r=this._textarea.value;setTimeout(function(){if(!t._isComposing){var e=t._textarea.value.replace(r,"");0<e.length&&t._terminal.handler(e)}},0)},i.prototype.updateCompositionElements=function(e){var t=this;if(this._isComposing){if(this._terminal.buffer.isCursorInViewport){var r=Math.ceil(this._terminal.charMeasure.height*this._terminal.options.lineHeight),n=this._terminal.buffer.y*r,i=this._terminal.buffer.x*this._terminal.charMeasure.width;this._compositionView.style.left=i+"px",this._compositionView.style.top=n+"px",this._compositionView.style.height=r+"px",this._compositionView.style.lineHeight=r+"px",this._compositionView.style.fontFamily=this._terminal.options.fontFamily,this._compositionView.style.fontSize=this._terminal.options.fontSize+"px";var o=this._compositionView.getBoundingClientRect();this._textarea.style.left=i+"px",this._textarea.style.top=n+"px",this._textarea.style.width=o.width+"px",this._textarea.style.height=o.height+"px",this._textarea.style.lineHeight=o.height+"px"}e||setTimeout(function(){return t.updateCompositionElements(!0)},0)}},i.prototype._clearTextareaPosition=function(){this._textarea.style.left="",this._textarea.style.top=""},i);function i(e,t,r){this._textarea=e,this._compositionView=t,this._terminal=r,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:null,end:null}}r.CompositionHelper=n},{}],25:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var o=e("./common/Lifecycle"),E=e("./core/input/TextDecoder");function s(e,t){for(var r=t-e,n=new Array(r);r--;)n[r]=--t;return n}var a=(l.prototype.add=function(e,t,r,n){this.table[t<<8|e]=(0|r)<<4|(void 0===n?t:n)},l.prototype.addMany=function(e,t,r,n){for(var i=0;i<e.length;i++)this.add(e[i],t,r,n)},l);function l(e){this.table="undefined"==typeof Uint8Array?new Array(e):new Uint8Array(e)}r.TransitionTable=a;var c=s(32,127),u=s(0,24);u.push(25),u.push.apply(u,s(28,32));r.VT500_TRANSITION_TABLE=function(){var e,t=new a(4095),r=s(0,14);for(e in r)for(var n=0;n<=160;++n)t.add(n,e,1,0);for(e in t.addMany(c,0,2,0),r)t.addMany([24,26,153,154],e,3,0),t.addMany(s(128,144),e,3,0),t.addMany(s(144,152),e,3,0),t.add(156,e,0,0),t.add(27,e,11,1),t.add(157,e,4,8),t.addMany([152,158,159],e,0,7),t.add(155,e,11,3),t.add(144,e,11,9);return t.addMany(u,0,3,0),t.addMany(u,1,3,1),t.add(127,1,0,1),t.addMany(u,8,0,8),t.addMany(u,3,3,3),t.add(127,3,0,3),t.addMany(u,4,3,4),t.add(127,4,0,4),t.addMany(u,6,3,6),t.addMany(u,5,3,5),t.add(127,5,0,5),t.addMany(u,2,3,2),t.add(127,2,0,2),t.add(93,1,4,8),t.addMany(c,8,5,8),t.add(127,8,5,8),t.addMany([156,27,24,26,7],8,6,0),t.addMany(s(28,32),8,0,8),t.addMany([88,94,95],1,0,7),t.addMany(c,7,0,7),t.addMany(u,7,0,7),t.add(156,7,0,0),t.add(127,7,0,7),t.add(91,1,11,3),t.addMany(s(64,127),3,7,0),t.addMany(s(48,58),3,8,4),t.add(59,3,8,4),t.addMany([60,61,62,63],3,9,4),t.addMany(s(48,58),4,8,4),t.add(59,4,8,4),t.addMany(s(64,127),4,7,0),t.addMany([58,60,61,62,63],4,0,6),t.addMany(s(32,64),6,0,6),t.add(127,6,0,6),t.addMany(s(64,127),6,0,0),t.add(58,3,0,6),t.addMany(s(32,48),3,9,5),t.addMany(s(32,48),5,9,5),t.addMany(s(48,64),5,0,6),t.addMany(s(64,127),5,7,0),t.addMany(s(32,48),4,9,5),t.addMany(s(32,48),1,9,2),t.addMany(s(32,48),2,9,2),t.addMany(s(48,127),2,10,0),t.addMany(s(48,80),1,10,0),t.addMany(s(81,88),1,10,0),t.addMany([89,90,92],1,10,0),t.addMany(s(96,127),1,10,0),t.add(80,1,11,9),t.addMany(u,9,0,9),t.add(127,9,0,9),t.addMany(s(28,32),9,0,9),t.addMany(s(32,48),9,9,12),t.add(58,9,0,11),t.addMany(s(48,58),9,8,10),t.add(59,9,8,10),t.addMany([60,61,62,63],9,9,10),t.addMany(u,11,0,11),t.addMany(s(32,128),11,0,11),t.addMany(s(28,32),11,0,11),t.addMany(u,10,0,10),t.add(127,10,0,10),t.addMany(s(28,32),10,0,10),t.addMany(s(48,58),10,8,10),t.add(59,10,8,10),t.addMany([58,60,61,62,63],10,0,11),t.addMany(s(32,48),10,9,12),t.addMany(u,12,0,12),t.add(127,12,0,12),t.addMany(s(28,32),12,0,12),t.addMany(s(32,48),12,9,12),t.addMany(s(48,64),12,0,11),t.addMany(s(64,127),12,12,13),t.addMany(s(64,127),10,12,13),t.addMany(s(64,127),9,12,13),t.addMany(u,13,13,13),t.addMany(c,13,13,13),t.add(127,13,0,13),t.addMany([27,156],13,14,0),t.add(160,8,5,8),t}();var h=(f.prototype.hook=function(e,t,r){},f.prototype.put=function(e,t,r){},f.prototype.unhook=function(){},f);function f(){}var d,p=(d=o.Disposable,i(_,d),_.prototype.dispose=function(){this._printHandlerFb=null,this._executeHandlerFb=null,this._csiHandlerFb=null,this._escHandlerFb=null,this._oscHandlerFb=null,this._dcsHandlerFb=null,this._errorHandlerFb=null,this._printHandler=null,this._executeHandlers=null,this._escHandlers=null,this._csiHandlers=null,this._oscHandlers=null,this._dcsHandlers=null,this._activeDcsHandler=null,this._errorHandler=null},_.prototype.setPrintHandler=function(e){this._printHandler=e},_.prototype.clearPrintHandler=function(){this._printHandler=this._printHandlerFb},_.prototype.setExecuteHandler=function(e,t){this._executeHandlers[e.charCodeAt(0)]=t},_.prototype.clearExecuteHandler=function(e){this._executeHandlers[e.charCodeAt(0)]&&delete this._executeHandlers[e.charCodeAt(0)]},_.prototype.setExecuteHandlerFallback=function(e){this._executeHandlerFb=e},_.prototype.addCsiHandler=function(e,t){var r=e.charCodeAt(0);void 0===this._csiHandlers[r]&&(this._csiHandlers[r]=[]);var n=this._csiHandlers[r];return n.push(t),{dispose:function(){var e=n.indexOf(t);-1!==e&&n.splice(e,1)}}},_.prototype.setCsiHandler=function(e,t){this._csiHandlers[e.charCodeAt(0)]=[t]},_.prototype.clearCsiHandler=function(e){this._csiHandlers[e.charCodeAt(0)]&&delete this._csiHandlers[e.charCodeAt(0)]},_.prototype.setCsiHandlerFallback=function(e){this._csiHandlerFb=e},_.prototype.setEscHandler=function(e,t){this._escHandlers[e]=t},_.prototype.clearEscHandler=function(e){this._escHandlers[e]&&delete this._escHandlers[e]},_.prototype.setEscHandlerFallback=function(e){this._escHandlerFb=e},_.prototype.addOscHandler=function(e,t){void 0===this._oscHandlers[e]&&(this._oscHandlers[e]=[]);var r=this._oscHandlers[e];return r.push(t),{dispose:function(){var e=r.indexOf(t);-1!==e&&r.splice(e,1)}}},_.prototype.setOscHandler=function(e,t){this._oscHandlers[e]=[t]},_.prototype.clearOscHandler=function(e){this._oscHandlers[e]&&delete this._oscHandlers[e]},_.prototype.setOscHandlerFallback=function(e){this._oscHandlerFb=e},_.prototype.setDcsHandler=function(e,t){this._dcsHandlers[e]=t},_.prototype.clearDcsHandler=function(e){this._dcsHandlers[e]&&delete this._dcsHandlers[e]},_.prototype.setDcsHandlerFallback=function(e){this._dcsHandlerFb=e},_.prototype.setErrorHandler=function(e){this._errorHandler=e},_.prototype.clearErrorHandler=function(){this._errorHandler=this._errorHandlerFb},_.prototype.reset=function(){this.currentState=this.initialState,this._osc="",this._params=[0],this._collect="",this._activeDcsHandler=null},_.prototype.parse=function(e,t){for(var r=0,n=0,i=!1,o=this.currentState,s=-1,a=-1,l=this._osc,c=this._collect,u=this._params,h=this.TRANSITIONS.table,f=this._activeDcsHandler,d=null,p=0;p<t;++p)if(r=e[p],0===o&&31<r&&r<128){for(s=~s?s:p;++p<t&&31<e[p]&&e[p]<128;);p--}else if(4===o&&47<r&&r<57)u[u.length-1]=10*u[u.length-1]+r-48;else{switch((n=h[o<<8|(r<160?r:160)])>>4){case 2:s=~s?s:p;break;case 3:~s&&(this._printHandler(e,s,p),s=-1),(d=this._executeHandlers[r])?d():this._executeHandlerFb(r);break;case 0:~s?(this._printHandler(e,s,p),s=-1):~a&&(f.put(e,a,p),a=-1);break;case 1:if(159<r)switch(o){case 0:s=~s?s:p;break;case 6:n|=6;break;case 11:n|=11;break;case 13:a=~a?a:p,n|=13;break;default:i=!0}else i=!0;if(i){if(this._errorHandler({position:p,code:r,currentState:o,print:s,dcs:a,osc:l,collect:c,params:u,abort:!1}).abort)return;i=!1}break;case 7:for(var _=this._csiHandlers[r],m=_?_.length-1:-1;0<=m&&!1===_[m](u,c);m--);m<0&&this._csiHandlerFb(c,u,r);break;case 8:59===r?u.push(0):u[u.length-1]=10*u[u.length-1]+r-48;break;case 9:c+=String.fromCharCode(r);break;case 10:(d=this._escHandlers[c+String.fromCharCode(r)])?d(c,r):this._escHandlerFb(c,r);break;case 11:~s&&(this._printHandler(e,s,p),s=-1),u=[0],c=l="",a=-1;break;case 12:(f=(f=this._dcsHandlers[c+String.fromCharCode(r)])||this._dcsHandlerFb).hook(c,u,r);break;case 13:a=~a?a:p;break;case 14:f&&(~a&&f.put(e,a,p),f.unhook(),f=null),27===r&&(n|=1),u=[0],c=l="",a=-1;break;case 4:~s&&(this._printHandler(e,s,p),s=-1),l="";break;case 5:for(var y=p+1;;y++)if(t<=y||(r=e[y])<32||127<r&&r<=159){l+=E.utf32ToString(e,p,y),p=y-1;break}break;case 6:if(l&&24!==r&&26!==r){var g=l.indexOf(";");if(-1===g)this._oscHandlerFb(-1,l);else{for(var v=parseInt(l.substring(0,g)),b=l.substring(g+1),C=this._oscHandlers[v],w=C?C.length-1:-1;0<=w&&!1===C[w](b);w--);w<0&&this._oscHandlerFb(v,b)}}27===r&&(n|=1),u=[0],c=l="",a=-1}o=15&n}0===o&&~s?this._printHandler(e,s,t):13===o&&~a&&f&&f.put(e,a,t),this._osc=l,this._collect=c,this._params=u,this._activeDcsHandler=f,this.currentState=o},_);function _(e){void 0===e&&(e=r.VT500_TRANSITION_TABLE);var t=d.call(this)||this;return t.TRANSITIONS=e,t.initialState=0,t.currentState=t.initialState,t._osc="",t._params=[0],t._collect="",t._printHandlerFb=function(e,t,r){},t._executeHandlerFb=function(e){},t._csiHandlerFb=function(e,t,r){},t._escHandlerFb=function(e,t){},t._oscHandlerFb=function(e,t){},t._dcsHandlerFb=new h,t._errorHandlerFb=function(e){return e},t._printHandler=t._printHandlerFb,t._executeHandlers=Object.create(null),t._csiHandlers=Object.create(null),t._escHandlers=Object.create(null),t._oscHandlers=Object.create(null),t._dcsHandlers=Object.create(null),t._activeDcsHandler=null,t._errorHandler=t._errorHandlerFb,t.setEscHandler("\\",function(){}),t}r.EscapeSequenceParser=p},{"./common/Lifecycle":42,"./core/input/TextDecoder":52}],26:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var s=e("./common/data/EscapeSequences"),a=e("./core/data/Charsets"),_=e("./CharWidth"),l=e("./EscapeSequenceParser"),o=e("./common/Lifecycle"),c=e("./common/TypedArrayUtils"),m=e("./core/input/TextDecoder"),y=e("./core/buffer/BufferLine"),u=e("./common/EventEmitter2"),h={"(":0,")":1,"*":2,"+":3,"-":1,".":2},f=(d.prototype.hook=function(e,t,r){this._data=new Uint32Array(0)},d.prototype.put=function(e,t,r){this._data=c.concat(this._data,e.subarray(t,r))},d.prototype.unhook=function(){var e=m.utf32ToString(this._data);switch(this._data=new Uint32Array(0),e){case'"q':return this._terminal.handler(s.C0.ESC+'P1$r0"q'+s.C0.ESC+"\\");case'"p':return this._terminal.handler(s.C0.ESC+'P1$r61"p'+s.C0.ESC+"\\");case"r":var t=this._terminal.buffer.scrollTop+1+";"+(this._terminal.buffer.scrollBottom+1)+"r";return this._terminal.handler(s.C0.ESC+"P1$r"+t+s.C0.ESC+"\\");case"m":return this._terminal.handler(s.C0.ESC+"P1$r0m"+s.C0.ESC+"\\");case" q":var r={block:2,underline:4,bar:6}[this._terminal.getOption("cursorStyle")];return r-=this._terminal.getOption("cursorBlink"),this._terminal.handler(s.C0.ESC+"P1$r"+r+" q"+s.C0.ESC+"\\");default:this._terminal.error("Unknown DCS $q %s",e),this._terminal.handler(s.C0.ESC+"P0$r"+s.C0.ESC+"\\")}},d);function d(e){this._terminal=e,this._data=new Uint32Array(0)}var p,g=(p=o.Disposable,i(v,p),Object.defineProperty(v.prototype,"onCursorMove",{get:function(){return this._onCursorMove.event},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"onData",{get:function(){return this._onData.event},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"onLineFeed",{get:function(){return this._onLineFeed.event},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"onScroll",{get:function(){return this._onScroll.event},enumerable:!0,configurable:!0}),v.prototype.dispose=function(){p.prototype.dispose.call(this),this._terminal=null},v.prototype.parse=function(e){if(this._terminal){var t=this._terminal.buffer,r=t.x,n=t.y;this._terminal.debug&&this._terminal.log("data: "+e),this._parseBuffer.length<e.length&&(this._parseBuffer=new Uint32Array(e.length)),this._parser.parse(this._parseBuffer,this._stringDecoder.decode(e,this._parseBuffer)),(t=this._terminal.buffer).x===r&&t.y===n||this._onCursorMove.fire()}},v.prototype.parseUtf8=function(e){if(this._terminal){var t=this._terminal.buffer,r=t.x,n=t.y;this._terminal.debug&&this._terminal.log("data: "+e),this._parseBuffer.length<e.length&&(this._parseBuffer=new Uint32Array(e.length)),this._parser.parse(this._parseBuffer,this._utf8Decoder.decode(e,this._parseBuffer)),(t=this._terminal.buffer).x===r&&t.y===n||this._terminal.emit("cursormove")}},v.prototype.print=function(e,t,r){var n,i,o=this._terminal.buffer,s=this._terminal.charset,a=this._terminal.options.screenReaderMode,l=this._terminal.cols,c=this._terminal.wraparoundMode,u=this._terminal.insertMode,h=this._terminal.curAttrData,f=o.lines.get(o.y+o.ybase);this._terminal.updateRange(o.y);for(var d=t;d<r;++d){if(n=e[d],i=_.wcwidth(n),n<127&&s){var p=s[String.fromCharCode(n)];p&&(n=p.charCodeAt(0))}if(a&&this._terminal.emit("a11y.char",m.stringFromCodePoint(n)),i||!o.x){if(o.x+i-1>=l)if(c)o.x=0,o.y++,o.y>o.scrollBottom?(o.y--,this._terminal.scroll(!0)):o.lines.get(o.y).isWrapped=!0,f=o.lines.get(o.y+o.ybase);else if(2===i)continue;if(u&&(f.insertCells(o.x,i,o.getNullCell(h)),2===f.getWidth(l-1)&&f.setCellFromCodePoint(l-1,y.NULL_CELL_CODE,y.NULL_CELL_WIDTH,h.fg,h.bg)),f.setCellFromCodePoint(o.x++,n,i,h.fg,h.bg),0<i)for(;--i;)f.setCellFromCodePoint(o.x++,0,0,h.fg,h.bg)}else f.getWidth(o.x-1)?f.addCodepointToCell(o.x-1,n):f.addCodepointToCell(o.x-2,n)}this._terminal.updateRange(o.y)},v.prototype.addCsiHandler=function(e,t){return this._parser.addCsiHandler(e,t)},v.prototype.addOscHandler=function(e,t){return this._parser.addOscHandler(e,t)},v.prototype.bell=function(){this._terminal.bell()},v.prototype.lineFeed=function(){var e=this._terminal.buffer;this._terminal.options.convertEol&&(e.x=0),e.y++,e.y>e.scrollBottom&&(e.y--,this._terminal.scroll()),e.x>=this._terminal.cols&&e.x--,this._onLineFeed.fire()},v.prototype.carriageReturn=function(){this._terminal.buffer.x=0},v.prototype.backspace=function(){0<this._terminal.buffer.x&&this._terminal.buffer.x--},v.prototype.tab=function(){var e=this._terminal.buffer.x;this._terminal.buffer.x=this._terminal.buffer.nextStop(),this._terminal.options.screenReaderMode&&this._terminal.emit("a11y.tab",this._terminal.buffer.x-e)},v.prototype.shiftOut=function(){this._terminal.setgLevel(1)},v.prototype.shiftIn=function(){this._terminal.setgLevel(0)},v.prototype.insertChars=function(e){this._terminal.buffer.lines.get(this._terminal.buffer.y+this._terminal.buffer.ybase).insertCells(this._terminal.buffer.x,e[0]||1,this._terminal.buffer.getNullCell(this._terminal.eraseAttrData())),this._terminal.updateRange(this._terminal.buffer.y)},v.prototype.cursorUp=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.y-=t,this._terminal.buffer.y<0&&(this._terminal.buffer.y=0)},v.prototype.cursorDown=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.y+=t,this._terminal.buffer.y>=this._terminal.rows&&(this._terminal.buffer.y=this._terminal.rows-1),this._terminal.buffer.x>=this._terminal.cols&&this._terminal.buffer.x--},v.prototype.cursorForward=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.x+=t,this._terminal.buffer.x>=this._terminal.cols&&(this._terminal.buffer.x=this._terminal.cols-1)},v.prototype.cursorBackward=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.x>=this._terminal.cols&&this._terminal.buffer.x--,this._terminal.buffer.x-=t,this._terminal.buffer.x<0&&(this._terminal.buffer.x=0)},v.prototype.cursorNextLine=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.y+=t,this._terminal.buffer.y>=this._terminal.rows&&(this._terminal.buffer.y=this._terminal.rows-1),this._terminal.buffer.x=0},v.prototype.cursorPrecedingLine=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.y-=t,this._terminal.buffer.y<0&&(this._terminal.buffer.y=0),this._terminal.buffer.x=0},v.prototype.cursorCharAbsolute=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.x=t-1},v.prototype.cursorPosition=function(e){var t,r=e[0]-1;t=2<=e.length?e[1]-1:0,r<0?r=0:r>=this._terminal.rows&&(r=this._terminal.rows-1),t<0?t=0:t>=this._terminal.cols&&(t=this._terminal.cols-1),this._terminal.buffer.x=t,this._terminal.buffer.y=r},v.prototype.cursorForwardTab=function(e){for(var t=e[0]||1;t--;)this._terminal.buffer.x=this._terminal.buffer.nextStop()},v.prototype._eraseInBufferLine=function(e,t,r,n){void 0===n&&(n=!1);var i=this._terminal.buffer.lines.get(this._terminal.buffer.ybase+e);i.replaceCells(t,r,this._terminal.buffer.getNullCell(this._terminal.eraseAttrData())),n&&(i.isWrapped=!1)},v.prototype._resetBufferLine=function(e){this._eraseInBufferLine(e,0,this._terminal.cols,!0)},v.prototype.eraseInDisplay=function(e){var t;switch(e[0]){case 0:for(t=this._terminal.buffer.y,this._terminal.updateRange(t),this._eraseInBufferLine(t++,this._terminal.buffer.x,this._terminal.cols,0===this._terminal.buffer.x);t<this._terminal.rows;t++)this._resetBufferLine(t);this._terminal.updateRange(t);break;case 1:for(t=this._terminal.buffer.y,this._terminal.updateRange(t),this._eraseInBufferLine(t,0,this._terminal.buffer.x+1,!0),this._terminal.buffer.x+1>=this._terminal.cols&&(this._terminal.buffer.lines.get(t+1).isWrapped=!1);t--;)this._resetBufferLine(t);this._terminal.updateRange(0);break;case 2:for(t=this._terminal.rows,this._terminal.updateRange(t-1);t--;)this._resetBufferLine(t);this._terminal.updateRange(0);break;case 3:var r=this._terminal.buffer.lines.length-this._terminal.rows;0<r&&(this._terminal.buffer.lines.trimStart(r),this._terminal.buffer.ybase=Math.max(this._terminal.buffer.ybase-r,0),this._terminal.buffer.ydisp=Math.max(this._terminal.buffer.ydisp-r,0),this._onScroll.fire(0))}},v.prototype.eraseInLine=function(e){switch(e[0]){case 0:this._eraseInBufferLine(this._terminal.buffer.y,this._terminal.buffer.x,this._terminal.cols);break;case 1:this._eraseInBufferLine(this._terminal.buffer.y,0,this._terminal.buffer.x+1);break;case 2:this._eraseInBufferLine(this._terminal.buffer.y,0,this._terminal.cols)}this._terminal.updateRange(this._terminal.buffer.y)},v.prototype.insertLines=function(e){var t=e[0];t<1&&(t=1);for(var r=this._terminal.buffer,n=r.y+r.ybase,i=this._terminal.rows-1-r.scrollBottom,o=this._terminal.rows-1+r.ybase-i+1;t--;)r.lines.splice(o-1,1),r.lines.splice(n,0,r.getBlankLine(this._terminal.eraseAttrData()));this._terminal.updateRange(r.y),this._terminal.updateRange(r.scrollBottom)},v.prototype.deleteLines=function(e){var t=e[0];t<1&&(t=1);var r,n=this._terminal.buffer,i=n.y+n.ybase;for(r=this._terminal.rows-1-n.scrollBottom,r=this._terminal.rows-1+n.ybase-r;t--;)n.lines.splice(i,1),n.lines.splice(r,0,n.getBlankLine(this._terminal.eraseAttrData()));this._terminal.updateRange(n.y),this._terminal.updateRange(n.scrollBottom)},v.prototype.deleteChars=function(e){this._terminal.buffer.lines.get(this._terminal.buffer.y+this._terminal.buffer.ybase).deleteCells(this._terminal.buffer.x,e[0]||1,this._terminal.buffer.getNullCell(this._terminal.eraseAttrData())),this._terminal.updateRange(this._terminal.buffer.y)},v.prototype.scrollUp=function(e){for(var t=e[0]||1,r=this._terminal.buffer;t--;)r.lines.splice(r.ybase+r.scrollTop,1),r.lines.splice(r.ybase+r.scrollBottom,0,r.getBlankLine(y.DEFAULT_ATTR_DATA));this._terminal.updateRange(r.scrollTop),this._terminal.updateRange(r.scrollBottom)},v.prototype.scrollDown=function(e,t){if(e.length<2&&!t){for(var r=e[0]||1,n=this._terminal.buffer;r--;)n.lines.splice(n.ybase+n.scrollBottom,1),n.lines.splice(n.ybase+n.scrollTop,0,n.getBlankLine(y.DEFAULT_ATTR_DATA));this._terminal.updateRange(n.scrollTop),this._terminal.updateRange(n.scrollBottom)}},v.prototype.eraseChars=function(e){this._terminal.buffer.lines.get(this._terminal.buffer.y+this._terminal.buffer.ybase).replaceCells(this._terminal.buffer.x,this._terminal.buffer.x+(e[0]||1),this._terminal.buffer.getNullCell(this._terminal.eraseAttrData()))},v.prototype.cursorBackwardTab=function(e){for(var t=e[0]||1,r=this._terminal.buffer;t--;)r.x=r.prevStop()},v.prototype.charPosAbsolute=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.x=t-1,this._terminal.buffer.x>=this._terminal.cols&&(this._terminal.buffer.x=this._terminal.cols-1)},v.prototype.hPositionRelative=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.x+=t,this._terminal.buffer.x>=this._terminal.cols&&(this._terminal.buffer.x=this._terminal.cols-1)},v.prototype.repeatPrecedingCharacter=function(e){var t=this._terminal.buffer,r=t.lines.get(t.ybase+t.y);r.loadCell(t.x-1,this._workCell),r.replaceCells(t.x,t.x+(e[0]||1),void 0!==this._workCell.content?this._workCell:t.getNullCell(y.DEFAULT_ATTR_DATA))},v.prototype.sendDeviceAttributes=function(e,t){0<e[0]||(t?">"===t&&(this._terminal.is("xterm")?this._terminal.handler(s.C0.ESC+"[>0;276;0c"):this._terminal.is("rxvt-unicode")?this._terminal.handler(s.C0.ESC+"[>85;95;0c"):this._terminal.is("linux")?this._terminal.handler(e[0]+"c"):this._terminal.is("screen")&&this._terminal.handler(s.C0.ESC+"[>83;40003;0c")):this._terminal.is("xterm")||this._terminal.is("rxvt-unicode")||this._terminal.is("screen")?this._terminal.handler(s.C0.ESC+"[?1;2c"):this._terminal.is("linux")&&this._terminal.handler(s.C0.ESC+"[?6c"))},v.prototype.linePosAbsolute=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.y=t-1,this._terminal.buffer.y>=this._terminal.rows&&(this._terminal.buffer.y=this._terminal.rows-1)},v.prototype.vPositionRelative=function(e){var t=e[0];t<1&&(t=1),this._terminal.buffer.y+=t,this._terminal.buffer.y>=this._terminal.rows&&(this._terminal.buffer.y=this._terminal.rows-1),this._terminal.buffer.x>=this._terminal.cols&&this._terminal.buffer.x--},v.prototype.hVPosition=function(e){e[0]<1&&(e[0]=1),e[1]<1&&(e[1]=1),this._terminal.buffer.y=e[0]-1,this._terminal.buffer.y>=this._terminal.rows&&(this._terminal.buffer.y=this._terminal.rows-1),this._terminal.buffer.x=e[1]-1,this._terminal.buffer.x>=this._terminal.cols&&(this._terminal.buffer.x=this._terminal.cols-1)},v.prototype.tabClear=function(e){var t=e[0];t<=0?delete this._terminal.buffer.tabs[this._terminal.buffer.x]:3===t&&(this._terminal.buffer.tabs={})},v.prototype.setMode=function(e,t){if(1<e.length)for(var r=0;r<e.length;r++)this.setMode([e[r]]);else if(t){if("?"===t)switch(e[0]){case 1:this._terminal.applicationCursor=!0;break;case 2:this._terminal.setgCharset(0,a.DEFAULT_CHARSET),this._terminal.setgCharset(1,a.DEFAULT_CHARSET),this._terminal.setgCharset(2,a.DEFAULT_CHARSET),this._terminal.setgCharset(3,a.DEFAULT_CHARSET);break;case 3:this._terminal.savedCols=this._terminal.cols,this._terminal.resize(132,this._terminal.rows);break;case 6:this._terminal.originMode=!0;break;case 7:this._terminal.wraparoundMode=!0;break;case 12:break;case 66:this._terminal.log("Serial port requested application keypad."),this._terminal.applicationKeypad=!0,this._terminal.viewport&&this._terminal.viewport.syncScrollArea();break;case 9:case 1e3:case 1002:case 1003:this._terminal.x10Mouse=9===e[0],this._terminal.vt200Mouse=1e3===e[0],this._terminal.normalMouse=1e3<e[0],this._terminal.mouseEvents=!0,this._terminal.element&&this._terminal.element.classList.add("enable-mouse-events"),this._terminal.selectionManager&&this._terminal.selectionManager.disable(),this._terminal.log("Binding to mouse events.");break;case 1004:this._terminal.sendFocus=!0;break;case 1005:this._terminal.utfMouse=!0;break;case 1006:this._terminal.sgrMouse=!0;break;case 1015:this._terminal.urxvtMouse=!0;break;case 25:this._terminal.cursorHidden=!1;break;case 1048:this.saveCursor(e);break;case 1049:this.saveCursor(e);case 47:case 1047:this._terminal.buffers.activateAltBuffer(this._terminal.eraseAttrData()),this._terminal.refresh(0,this._terminal.rows-1),this._terminal.viewport&&this._terminal.viewport.syncScrollArea(),this._terminal.showCursor();break;case 2004:this._terminal.bracketedPasteMode=!0}}else switch(e[0]){case 4:this._terminal.insertMode=!0}},v.prototype.resetMode=function(e,t){if(1<e.length)for(var r=0;r<e.length;r++)this.resetMode([e[r]]);else if(t){if("?"===t)switch(e[0]){case 1:this._terminal.applicationCursor=!1;break;case 3:132===this._terminal.cols&&this._terminal.savedCols&&this._terminal.resize(this._terminal.savedCols,this._terminal.rows),delete this._terminal.savedCols;break;case 6:this._terminal.originMode=!1;break;case 7:this._terminal.wraparoundMode=!1;break;case 12:break;case 66:this._terminal.log("Switching back to normal keypad."),this._terminal.applicationKeypad=!1,this._terminal.viewport&&this._terminal.viewport.syncScrollArea();break;case 9:case 1e3:case 1002:case 1003:this._terminal.x10Mouse=!1,this._terminal.vt200Mouse=!1,this._terminal.normalMouse=!1,this._terminal.mouseEvents=!1,this._terminal.element&&this._terminal.element.classList.remove("enable-mouse-events"),this._terminal.selectionManager&&this._terminal.selectionManager.enable();break;case 1004:this._terminal.sendFocus=!1;break;case 1005:this._terminal.utfMouse=!1;break;case 1006:this._terminal.sgrMouse=!1;break;case 1015:this._terminal.urxvtMouse=!1;break;case 25:this._terminal.cursorHidden=!0;break;case 1048:this.restoreCursor(e);break;case 1049:case 47:case 1047:this._terminal.buffers.activateNormalBuffer(),1049===e[0]&&this.restoreCursor(e),this._terminal.refresh(0,this._terminal.rows-1),this._terminal.viewport&&this._terminal.viewport.syncScrollArea(),this._terminal.showCursor();break;case 2004:this._terminal.bracketedPasteMode=!1}}else switch(e[0]){case 4:this._terminal.insertMode=!1}},v.prototype.charAttributes=function(e){if(1===e.length&&0===e[0])return this._terminal.curAttrData.fg=y.DEFAULT_ATTR_DATA.fg,void(this._terminal.curAttrData.bg=y.DEFAULT_ATTR_DATA.bg);for(var t,r=e.length,n=this._terminal.curAttrData,i=0;i<r;i++)30<=(t=e[i])&&t<=37?(n.fg&=-50331904,n.fg|=16777216|t-30):40<=t&&t<=47?(n.bg&=-50331904,n.bg|=16777216|t-40):90<=t&&t<=97?(n.fg&=-50331904,n.fg|=16777224|t-90):100<=t&&t<=107?(n.bg&=-50331904,n.bg|=16777224|t-100):0===t?(n.fg=y.DEFAULT_ATTR_DATA.fg,n.bg=y.DEFAULT_ATTR_DATA.bg):1===t?n.fg|=134217728:3===t?n.bg|=67108864:4===t?n.fg|=268435456:5===t?n.fg|=536870912:7===t?n.fg|=67108864:8===t?n.fg|=1073741824:2===t?n.bg|=134217728:22===t?(n.fg&=-134217729,n.bg&=-134217729):23===t?n.bg&=-67108865:24===t?n.fg&=-268435457:25===t?n.fg&=-536870913:27===t?n.fg&=-67108865:28===t?n.fg&=-1073741825:39===t?(n.fg&=-67108864,n.fg|=16777215&y.DEFAULT_ATTR_DATA.fg):49===t?(n.bg&=-67108864,n.bg|=16777215&y.DEFAULT_ATTR_DATA.bg):38===t?2===e[i+1]?(i+=2,n.fg|=50331648,n.fg&=-16777216,n.fg|=y.AttributeData.fromColorRGB([e[i],e[i+1],e[i+2]]),i+=2):5===e[i+1]&&(t=255&e[i+=2],n.fg&=-50331904,n.fg|=33554432|t):48===t?2===e[i+1]?(i+=2,n.bg|=50331648,n.bg&=-16777216,n.bg|=y.AttributeData.fromColorRGB([e[i],e[i+1],e[i+2]]),i+=2):5===e[i+1]&&(t=255&e[i+=2],n.bg&=-50331904,n.bg|=33554432|t):100===t?(n.fg&=-67108864,n.fg|=16777215&y.DEFAULT_ATTR_DATA.fg,n.bg&=-67108864,n.bg|=16777215&y.DEFAULT_ATTR_DATA.bg):this._terminal.error("Unknown SGR attribute: %d.",t)},v.prototype.deviceStatus=function(e,t){if(t){if("?"===t)switch(e[0]){case 6:r=this._terminal.buffer.y+1,n=this._terminal.buffer.x+1,this._onData.fire(s.C0.ESC+"[?"+r+";"+n+"R")}}else switch(e[0]){case 5:this._onData.fire(s.C0.ESC+"[0n");break;case 6:var r=this._terminal.buffer.y+1,n=this._terminal.buffer.x+1;this._onData.fire(s.C0.ESC+"["+r+";"+n+"R")}},v.prototype.softReset=function(e,t){"!"===t&&(this._terminal.cursorHidden=!1,this._terminal.insertMode=!1,this._terminal.originMode=!1,this._terminal.wraparoundMode=!0,this._terminal.applicationKeypad=!1,this._terminal.viewport&&this._terminal.viewport.syncScrollArea(),this._terminal.applicationCursor=!1,this._terminal.buffer.scrollTop=0,this._terminal.buffer.scrollBottom=this._terminal.rows-1,this._terminal.curAttrData=y.DEFAULT_ATTR_DATA.clone(),this._terminal.buffer.x=this._terminal.buffer.y=0,this._terminal.charset=null,this._terminal.glevel=0,this._terminal.charsets=[null])},v.prototype.setCursorStyle=function(e,t){if(" "===t){var r=e[0]<1?1:e[0];switch(r){case 1:case 2:this._terminal.setOption("cursorStyle","block");break;case 3:case 4:this._terminal.setOption("cursorStyle","underline");break;case 5:case 6:this._terminal.setOption("cursorStyle","bar")}var n=r%2==1;this._terminal.setOption("cursorBlink",n)}},v.prototype.setScrollRegion=function(e,t){t||(this._terminal.buffer.scrollTop=(e[0]||1)-1,this._terminal.buffer.scrollBottom=(e[1]&&e[1]<=this._terminal.rows?e[1]:this._terminal.rows)-1,this._terminal.buffer.x=0,this._terminal.buffer.y=0)},v.prototype.saveCursor=function(e){this._terminal.buffer.savedX=this._terminal.buffer.x,this._terminal.buffer.savedY=this._terminal.buffer.y,this._terminal.buffer.savedCurAttrData.fg=this._terminal.curAttrData.fg,this._terminal.buffer.savedCurAttrData.bg=this._terminal.curAttrData.bg},v.prototype.restoreCursor=function(e){this._terminal.buffer.x=this._terminal.buffer.savedX||0,this._terminal.buffer.y=this._terminal.buffer.savedY||0,this._terminal.curAttrData.fg=this._terminal.buffer.savedCurAttrData.fg,this._terminal.curAttrData.bg=this._terminal.buffer.savedCurAttrData.bg},v.prototype.setTitle=function(e){this._terminal.handleTitle(e)},v.prototype.nextLine=function(){this._terminal.buffer.x=0,this.index()},v.prototype.keypadApplicationMode=function(){this._terminal.log("Serial port requested application keypad."),this._terminal.applicationKeypad=!0,this._terminal.viewport&&this._terminal.viewport.syncScrollArea()},v.prototype.keypadNumericMode=function(){this._terminal.log("Switching back to normal keypad."),this._terminal.applicationKeypad=!1,this._terminal.viewport&&this._terminal.viewport.syncScrollArea()},v.prototype.selectDefaultCharset=function(){this._terminal.setgLevel(0),this._terminal.setgCharset(0,a.DEFAULT_CHARSET)},v.prototype.selectCharset=function(e){2===e.length?"/"!==e[0]&&this._terminal.setgCharset(h[e[0]],a.CHARSETS[e[1]]||a.DEFAULT_CHARSET):this.selectDefaultCharset()},v.prototype.index=function(){this._terminal.index()},v.prototype.tabSet=function(){this._terminal.tabSet()},v.prototype.reverseIndex=function(){this._terminal.reverseIndex()},v.prototype.reset=function(){this._parser.reset(),this._terminal.reset()},v.prototype.setgLevel=function(e){this._terminal.setgLevel(e)},v);function v(e,t){void 0===t&&(t=new l.EscapeSequenceParser);var n=p.call(this)||this;n._terminal=e,n._parser=t,n._parseBuffer=new Uint32Array(4096),n._stringDecoder=new m.StringToUtf32,n._utf8Decoder=new m.Utf8ToUtf32,n._workCell=new y.CellData,n._onCursorMove=new u.EventEmitter2,n._onData=new u.EventEmitter2,n._onLineFeed=new u.EventEmitter2,n._onScroll=new u.EventEmitter2,n.register(n._parser),n._parser.setCsiHandlerFallback(function(e,t,r){n._terminal.error("Unknown CSI code: ",{collect:e,params:t,flag:String.fromCharCode(r)})}),n._parser.setEscHandlerFallback(function(e,t){n._terminal.error("Unknown ESC code: ",{collect:e,flag:String.fromCharCode(t)})}),n._parser.setExecuteHandlerFallback(function(e){n._terminal.error("Unknown EXECUTE code: ",{code:e})}),n._parser.setOscHandlerFallback(function(e,t){n._terminal.error("Unknown OSC code: ",{identifier:e,data:t})}),n._parser.setPrintHandler(function(e,t,r){return n.print(e,t,r)}),n._parser.setCsiHandler("@",function(e,t){return n.insertChars(e)}),n._parser.setCsiHandler("A",function(e,t){return n.cursorUp(e)}),n._parser.setCsiHandler("B",function(e,t){return n.cursorDown(e)}),n._parser.setCsiHandler("C",function(e,t){return n.cursorForward(e)}),n._parser.setCsiHandler("D",function(e,t){return n.cursorBackward(e)}),n._parser.setCsiHandler("E",function(e,t){return n.cursorNextLine(e)}),n._parser.setCsiHandler("F",function(e,t){return n.cursorPrecedingLine(e)}),n._parser.setCsiHandler("G",function(e,t){return n.cursorCharAbsolute(e)}),n._parser.setCsiHandler("H",function(e,t){return n.cursorPosition(e)}),n._parser.setCsiHandler("I",function(e,t){return n.cursorForwardTab(e)}),n._parser.setCsiHandler("J",function(e,t){return n.eraseInDisplay(e)}),n._parser.setCsiHandler("K",function(e,t){return n.eraseInLine(e)}),n._parser.setCsiHandler("L",function(e,t){return n.insertLines(e)}),n._parser.setCsiHandler("M",function(e,t){return n.deleteLines(e)}),n._parser.setCsiHandler("P",function(e,t){return n.deleteChars(e)}),n._parser.setCsiHandler("S",function(e,t){return n.scrollUp(e)}),n._parser.setCsiHandler("T",function(e,t){return n.scrollDown(e,t)}),n._parser.setCsiHandler("X",function(e,t){return n.eraseChars(e)}),n._parser.setCsiHandler("Z",function(e,t){return n.cursorBackwardTab(e)}),n._parser.setCsiHandler("`",function(e,t){return n.charPosAbsolute(e)}),n._parser.setCsiHandler("a",function(e,t){return n.hPositionRelative(e)}),n._parser.setCsiHandler("b",function(e,t){return n.repeatPrecedingCharacter(e)}),n._parser.setCsiHandler("c",function(e,t){return n.sendDeviceAttributes(e,t)}),n._parser.setCsiHandler("d",function(e,t){return n.linePosAbsolute(e)}),n._parser.setCsiHandler("e",function(e,t){return n.vPositionRelative(e)}),n._parser.setCsiHandler("f",function(e,t){return n.hVPosition(e)}),n._parser.setCsiHandler("g",function(e,t){return n.tabClear(e)}),n._parser.setCsiHandler("h",function(e,t){return n.setMode(e,t)}),n._parser.setCsiHandler("l",function(e,t){return n.resetMode(e,t)}),n._parser.setCsiHandler("m",function(e,t){return n.charAttributes(e)}),n._parser.setCsiHandler("n",function(e,t){return n.deviceStatus(e,t)}),n._parser.setCsiHandler("p",function(e,t){return n.softReset(e,t)}),n._parser.setCsiHandler("q",function(e,t){return n.setCursorStyle(e,t)}),n._parser.setCsiHandler("r",function(e,t){return n.setScrollRegion(e,t)}),n._parser.setCsiHandler("s",function(e,t){return n.saveCursor(e)}),n._parser.setCsiHandler("u",function(e,t){return n.restoreCursor(e)}),n._parser.setExecuteHandler(s.C0.BEL,function(){return n.bell()}),n._parser.setExecuteHandler(s.C0.LF,function(){return n.lineFeed()}),n._parser.setExecuteHandler(s.C0.VT,function(){return n.lineFeed()}),n._parser.setExecuteHandler(s.C0.FF,function(){return n.lineFeed()}),n._parser.setExecuteHandler(s.C0.CR,function(){return n.carriageReturn()}),n._parser.setExecuteHandler(s.C0.BS,function(){return n.backspace()}),n._parser.setExecuteHandler(s.C0.HT,function(){return n.tab()}),n._parser.setExecuteHandler(s.C0.SO,function(){return n.shiftOut()}),n._parser.setExecuteHandler(s.C0.SI,function(){return n.shiftIn()}),n._parser.setExecuteHandler(s.C1.IND,function(){return n.index()}),n._parser.setExecuteHandler(s.C1.NEL,function(){return n.nextLine()}),n._parser.setExecuteHandler(s.C1.HTS,function(){return n.tabSet()}),n._parser.setOscHandler(0,function(e){return n.setTitle(e)}),n._parser.setOscHandler(2,function(e){return n.setTitle(e)}),n._parser.setEscHandler("7",function(){return n.saveCursor([])}),n._parser.setEscHandler("8",function(){return n.restoreCursor([])}),n._parser.setEscHandler("D",function(){return n.index()}),n._parser.setEscHandler("E",function(){return n.nextLine()}),n._parser.setEscHandler("H",function(){return n.tabSet()}),n._parser.setEscHandler("M",function(){return n.reverseIndex()}),n._parser.setEscHandler("=",function(){return n.keypadApplicationMode()}),n._parser.setEscHandler(">",function(){return n.keypadNumericMode()}),n._parser.setEscHandler("c",function(){return n.reset()}),n._parser.setEscHandler("n",function(){return n.setgLevel(2)}),n._parser.setEscHandler("o",function(){return n.setgLevel(3)}),n._parser.setEscHandler("|",function(){return n.setgLevel(3)}),n._parser.setEscHandler("}",function(){return n.setgLevel(2)}),n._parser.setEscHandler("~",function(){return n.setgLevel(1)}),n._parser.setEscHandler("%@",function(){return n.selectDefaultCharset()}),n._parser.setEscHandler("%G",function(){return n.selectDefaultCharset()});function r(e){i._parser.setEscHandler("("+e,function(){return n.selectCharset("("+e)}),i._parser.setEscHandler(")"+e,function(){return n.selectCharset(")"+e)}),i._parser.setEscHandler("*"+e,function(){return n.selectCharset("*"+e)}),i._parser.setEscHandler("+"+e,function(){return n.selectCharset("+"+e)}),i._parser.setEscHandler("-"+e,function(){return n.selectCharset("-"+e)}),i._parser.setEscHandler("."+e,function(){return n.selectCharset("."+e)}),i._parser.setEscHandler("/"+e,function(){return n.selectCharset("/"+e)})}var i=this;for(var o in a.CHARSETS)r(o);return n._parser.setErrorHandler(function(e){return n._terminal.error("Parsing error: ",e),e}),n._parser.setDcsHandler("$q",new f(n._terminal)),n}r.InputHandler=g},{"./CharWidth":22,"./EscapeSequenceParser":25,"./common/EventEmitter2":41,"./common/Lifecycle":42,"./common/TypedArrayUtils":44,"./common/data/EscapeSequences":46,"./core/buffer/BufferLine":47,"./core/data/Charsets":50,"./core/input/TextDecoder":52}],27:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var h=e("./MouseZoneManager"),f=e("./CharWidth"),n=e("./common/EventEmitter2"),i=(Object.defineProperty(a.prototype,"onLinkHover",{get:function(){return this._onLinkHover.event},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onLinkLeave",{get:function(){return this._onLinkLeave.event},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onLinkTooltip",{get:function(){return this._onLinkTooltip.event},enumerable:!0,configurable:!0}),a.prototype.attachToDom=function(e){this._mouseZoneManager=e},a.prototype.linkifyRows=function(e,t){var r=this;this._mouseZoneManager&&(null===this._rowsToLinkify.start?(this._rowsToLinkify.start=e,this._rowsToLinkify.end=t):(this._rowsToLinkify.start=Math.min(this._rowsToLinkify.start,e),this._rowsToLinkify.end=Math.max(this._rowsToLinkify.end,t)),this._mouseZoneManager.clearAll(e,t),this._rowsTimeoutId&&clearTimeout(this._rowsTimeoutId),this._rowsTimeoutId=setTimeout(function(){return r._linkifyRows()},a.TIME_BEFORE_LINKIFY))},a.prototype._linkifyRows=function(){this._rowsTimeoutId=null;var e=this._terminal.buffer,t=e.ydisp+this._rowsToLinkify.start;if(!(t>=e.lines.length)){for(var r=e.ydisp+Math.min(this._rowsToLinkify.end,this._terminal.rows)+1,n=Math.ceil(a.OVERSCAN_CHAR_LIMIT/this._terminal.cols),i=this._terminal.buffer.iterator(!1,t,r,n,n);i.hasNext();)for(var o=i.next(),s=0;s<this._linkMatchers.length;s++)this._doLinkifyRow(o.range.first,o.content,this._linkMatchers[s]);this._rowsToLinkify.start=null,this._rowsToLinkify.end=null}},a.prototype.registerLinkMatcher=function(e,t,r){if(void 0===r&&(r={}),!t)throw new Error("handler must be defined");var n={id:this._nextLinkMatcherId++,regex:e,handler:t,matchIndex:r.matchIndex,validationCallback:r.validationCallback,hoverTooltipCallback:r.tooltipCallback,hoverLeaveCallback:r.leaveCallback,willLinkActivate:r.willLinkActivate,priority:r.priority||0};return this._addLinkMatcherToList(n),n.id},a.prototype._addLinkMatcherToList=function(e){if(0!==this._linkMatchers.length){for(var t=this._linkMatchers.length-1;0<=t;t--)if(e.priority<=this._linkMatchers[t].priority)return void this._linkMatchers.splice(t+1,0,e);this._linkMatchers.splice(0,0,e)}else this._linkMatchers.push(e)},a.prototype.deregisterLinkMatcher=function(e){for(var t=0;t<this._linkMatchers.length;t++)if(this._linkMatchers[t].id===e)return this._linkMatchers.splice(t,1),!0;return!1},a.prototype._doLinkifyRow=function(i,o,s){for(var a,l=this,c=new RegExp(s.regex.source,s.regex.flags+"g"),u=-1,e=function(){var t=a["number"!=typeof s.matchIndex?0:s.matchIndex];if(!t){if(h._terminal.debug)throw console.log({match:a,matcher:s}),new Error("match found without corresponding matchIndex");return"break"}if(u=o.indexOf(t,u+1),c.lastIndex=u+t.length,u<0)return"break";var r=h._terminal.buffer.stringIndexToBufferIndex(i,u);if(r[0]<0)return"break";var n,e=h._terminal.buffer.lines.get(r[0]).getFg(r[1]);e&&(n=e>>9&511),s.validationCallback?s.validationCallback(t,function(e){l._rowsTimeoutId||e&&l._addLink(r[1],r[0]-l._terminal.buffer.ydisp,t,s,n)}):h._addLink(r[1],r[0]-h._terminal.buffer.ydisp,t,s,n)},h=this;null!==(a=c.exec(o))&&"break"!==e(););},a.prototype._addLink=function(e,t,r,n,i){var o=this,s=f.getStringCellWidth(r),a=e%this._terminal.cols,l=t+Math.floor(e/this._terminal.cols),c=(a+s)%this._terminal.cols,u=l+Math.floor((a+s)/this._terminal.cols);0===c&&(c=this._terminal.cols,u--),this._mouseZoneManager.add(new h.MouseZone(1+a,l+1,c+1,u+1,function(e){if(n.handler)return n.handler(e,r);window.open(r,"_blank")},function(){o._onLinkHover.fire(o._createLinkHoverEvent(a,l,c,u,i)),o._terminal.element.classList.add("xterm-cursor-pointer")},function(e){o._onLinkTooltip.fire(o._createLinkHoverEvent(a,l,c,u,i)),n.hoverTooltipCallback&&n.hoverTooltipCallback(e,r)},function(){o._onLinkLeave.fire(o._createLinkHoverEvent(a,l,c,u,i)),o._terminal.element.classList.remove("xterm-cursor-pointer"),n.hoverLeaveCallback&&n.hoverLeaveCallback()},function(e){return!n.willLinkActivate||n.willLinkActivate(e,r)}))},a.prototype._createLinkHoverEvent=function(e,t,r,n,i){return{x1:e,y1:t,x2:r,y2:n,cols:this._terminal.cols,fg:i}},a.TIME_BEFORE_LINKIFY=200,a.OVERSCAN_CHAR_LIMIT=2e3,a);function a(e){this._terminal=e,this._linkMatchers=[],this._nextLinkMatcherId=0,this._onLinkHover=new n.EventEmitter2,this._onLinkLeave=new n.EventEmitter2,this._onLinkTooltip=new n.EventEmitter2,this._rowsToLinkify={start:null,end:null}}r.Linkifier=i},{"./CharWidth":22,"./MouseZoneManager":29,"./common/EventEmitter2":41}],28:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=(a.getCoordsRelativeToElement=function(e,t){var r=t.getBoundingClientRect();return[e.clientX-r.left,e.clientY-r.top]},a.prototype.getCoords=function(e,t,r,n,i,o){if(!r.width||!r.height)return null;var s=a.getCoordsRelativeToElement(e,t);return s?(s[0]=Math.ceil((s[0]+(o?this._renderCoordinator.dimensions.actualCellWidth/2:0))/this._renderCoordinator.dimensions.actualCellWidth),s[1]=Math.ceil(s[1]/this._renderCoordinator.dimensions.actualCellHeight),s[0]=Math.min(Math.max(s[0],1),n+(o?1:0)),s[1]=Math.min(Math.max(s[1],1),i),s):null},a.prototype.getRawByteCoords=function(e,t,r,n,i){var o=this.getCoords(e,t,r,n,i),s=o[0],a=o[1];return{x:s+=32,y:a+=32}},a);function a(e){this._renderCoordinator=e}r.MouseHelper=n},{}],29:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var o,s=e("./common/Lifecycle"),a=e("./ui/Lifecycle"),l=(o=s.Disposable,i(c,o),c.prototype.dispose=function(){o.prototype.dispose.call(this),this._deactivate()},c.prototype.add=function(e){this._zones.push(e),1===this._zones.length&&this._activate()},c.prototype.clearAll=function(e,t){if(0!==this._zones.length){t||(e=0,t=this._terminal.rows-1);for(var r=0;r<this._zones.length;r++){var n=this._zones[r];(n.y1>e&&n.y1<=t+1||n.y2>e&&n.y2<=t+1||n.y1<e&&n.y2>t+1)&&(this._currentZone&&this._currentZone===n&&(this._currentZone.leaveCallback(),this._currentZone=null),this._zones.splice(r--,1))}0===this._zones.length&&this._deactivate()}},c.prototype._activate=function(){this._areZonesActive||(this._areZonesActive=!0,this._terminal.element.addEventListener("mousemove",this._mouseMoveListener),this._terminal.element.addEventListener("mouseleave",this._mouseLeaveListener),this._terminal.element.addEventListener("click",this._clickListener))},c.prototype._deactivate=function(){this._areZonesActive&&(this._areZonesActive=!1,this._terminal.element.removeEventListener("mousemove",this._mouseMoveListener),this._terminal.element.removeEventListener("mouseleave",this._mouseLeaveListener),this._terminal.element.removeEventListener("click",this._clickListener))},c.prototype._onMouseMove=function(e){this._lastHoverCoords[0]===e.pageX&&this._lastHoverCoords[1]===e.pageY||(this._onHover(e),this._lastHoverCoords=[e.pageX,e.pageY])},c.prototype._onHover=function(e){var t=this,r=this._findZoneEventAt(e);r!==this._currentZone&&(this._currentZone&&(this._currentZone.leaveCallback(),this._currentZone=null,this._tooltipTimeout&&clearTimeout(this._tooltipTimeout)),r&&((this._currentZone=r).hoverCallback&&r.hoverCallback(e),this._tooltipTimeout=setTimeout(function(){return t._onTooltip(e)},500)))},c.prototype._onTooltip=function(e){this._tooltipTimeout=null;var t=this._findZoneEventAt(e);t&&t.tooltipCallback&&t.tooltipCallback(e)},c.prototype._onMouseDown=function(e){if(this._initialSelectionLength=this._terminal.getSelection().length,this._areZonesActive){var t=this._findZoneEventAt(e);t&&t.willLinkActivate(e)&&(e.preventDefault(),e.stopImmediatePropagation())}},c.prototype._onMouseLeave=function(e){this._currentZone&&(this._currentZone.leaveCallback(),this._currentZone=null,this._tooltipTimeout&&clearTimeout(this._tooltipTimeout))},c.prototype._onClick=function(e){var t=this._findZoneEventAt(e),r=this._terminal.getSelection().length;t&&r===this._initialSelectionLength&&(t.clickCallback(e),e.preventDefault(),e.stopImmediatePropagation())},c.prototype._findZoneEventAt=function(e){var t=this._terminal.mouseHelper.getCoords(e,this._terminal.screenElement,this._terminal.charMeasure,this._terminal.cols,this._terminal.rows);if(!t)return null;for(var r=t[0],n=t[1],i=0;i<this._zones.length;i++){var o=this._zones[i];if(o.y1===o.y2){if(n===o.y1&&r>=o.x1&&r<o.x2)return o}else if(n===o.y1&&r>=o.x1||n===o.y2&&r<o.x2||n>o.y1&&n<o.y2)return o}return null},c);function c(e){var t=o.call(this)||this;return t._terminal=e,t._zones=[],t._areZonesActive=!1,t._tooltipTimeout=null,t._currentZone=null,t._lastHoverCoords=[null,null],t.register(a.addDisposableDomListener(t._terminal.element,"mousedown",function(e){return t._onMouseDown(e)})),t._mouseMoveListener=function(e){return t._onMouseMove(e)},t._mouseLeaveListener=function(e){return t._onMouseLeave(e)},t._clickListener=function(e){return t._onClick(e)},t}r.MouseZoneManager=l;function u(e,t,r,n,i,o,s,a,l){this.x1=e,this.y1=t,this.x2=r,this.y2=n,this.clickCallback=i,this.hoverCallback=o,this.tooltipCallback=s,this.leaveCallback=a,this.willLinkActivate=l}r.MouseZone=u},{"./common/Lifecycle":42,"./ui/Lifecycle":77}],30:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./MouseHelper"),a=e("./common/Platform"),i=e("./SelectionModel"),o=e("./handlers/AltClickHandler"),s=e("./core/buffer/BufferLine"),l=e("./common/EventEmitter2"),c=String.fromCharCode(160),u=new RegExp(c,"g"),h=(Object.defineProperty(f.prototype,"onLinuxMouseSelection",{get:function(){return this._onLinuxMouseSelection.event},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"onRedrawRequest",{get:function(){return this._onRedrawRequest.event},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"onSelectionChange",{get:function(){return this._onSelectionChange.event},enumerable:!0,configurable:!0}),f.prototype.dispose=function(){this._removeMouseDownListeners()},Object.defineProperty(f.prototype,"_buffer",{get:function(){return this._terminal.buffers.active},enumerable:!0,configurable:!0}),f.prototype._initListeners=function(){var t=this;this._mouseMoveListener=function(e){return t._onMouseMove(e)},this._mouseUpListener=function(e){return t._onMouseUp(e)},this.initBuffersListeners()},f.prototype.initBuffersListeners=function(){var t=this;this._trimListener=this._terminal.buffer.lines.onTrim(function(e){return t._onTrim(e)}),this._terminal.buffers.onBufferActivate(function(e){return t._onBufferActivate(e)})},f.prototype.disable=function(){this.clearSelection(),this._enabled=!1},f.prototype.enable=function(){this._enabled=!0},Object.defineProperty(f.prototype,"selectionStart",{get:function(){return this._model.finalSelectionStart},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"selectionEnd",{get:function(){return this._model.finalSelectionEnd},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"hasSelection",{get:function(){var e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;return!(!e||!t||e[0]===t[0]&&e[1]===t[1])},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"selectionText",{get:function(){var e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;if(!e||!t)return"";var r=[];if(3===this._activeSelectionMode){if(e[0]===t[0])return"";for(var n=e[1];n<=t[1];n++){var i=this._buffer.translateBufferLineToString(n,!0,e[0],t[0]);r.push(i)}}else{var o=e[1]===t[1]?t[0]:void 0;for(r.push(this._buffer.translateBufferLineToString(e[1],!0,e[0],o)),n=e[1]+1;n<=t[1]-1;n++){var s=this._buffer.lines.get(n);i=this._buffer.translateBufferLineToString(n,!0),s.isWrapped?r[r.length-1]+=i:r.push(i)}e[1]!==t[1]&&(s=this._buffer.lines.get(t[1]),i=this._buffer.translateBufferLineToString(t[1],!0,0,t[0]),s.isWrapped?r[r.length-1]+=i:r.push(i))}return r.map(function(e){return e.replace(u," ")}).join(a.isMSWindows?"\r\n":"\n")},enumerable:!0,configurable:!0}),f.prototype.clearSelection=function(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()},f.prototype.refresh=function(e){var t=this;this._refreshAnimationFrame||(this._refreshAnimationFrame=window.requestAnimationFrame(function(){return t._refresh()})),a.isLinux&&e&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)},f.prototype._refresh=function(){this._refreshAnimationFrame=null,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:3===this._activeSelectionMode})},f.prototype.isClickInSelection=function(e){var t=this._getMouseBufferCoords(e),r=this._model.finalSelectionStart,n=this._model.finalSelectionEnd;return!(!r||!n)&&this._areCoordsInSelection(t,r,n)},f.prototype._areCoordsInSelection=function(e,t,r){return e[1]>t[1]&&e[1]<r[1]||t[1]===r[1]&&e[1]===t[1]&&e[0]>=t[0]&&e[0]<r[0]||t[1]<r[1]&&e[1]===r[1]&&e[0]<r[0]||t[1]<r[1]&&e[1]===t[1]&&e[0]>=t[0]},f.prototype.selectWordAtCursor=function(e){var t=this._getMouseBufferCoords(e);t&&(this._selectWordAt(t,!1),this._model.selectionEnd=null,this.refresh(!0))},f.prototype.selectAll=function(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()},f.prototype.selectLines=function(e,t){this._model.clearSelection(),e=Math.max(e,0),t=Math.min(t,this._terminal.buffer.lines.length-1),this._model.selectionStart=[0,e],this._model.selectionEnd=[this._terminal.cols,t],this.refresh(),this._onSelectionChange.fire()},f.prototype._onTrim=function(e){this._model.onTrim(e)&&this.refresh()},f.prototype._getMouseBufferCoords=function(e){var t=this._terminal.mouseHelper.getCoords(e,this._terminal.screenElement,this._charMeasure,this._terminal.cols,this._terminal.rows,!0);return t?(t[0]--,t[1]--,t[1]+=this._terminal.buffer.ydisp,t):null},f.prototype._getMouseEventScrollAmount=function(e){var t=n.MouseHelper.getCoordsRelativeToElement(e,this._terminal.screenElement)[1],r=this._terminal.rows*Math.ceil(this._charMeasure.height*this._terminal.options.lineHeight);return 0<=t&&t<=r?0:(r<t&&(t-=r),t=Math.min(Math.max(t,-50),50),(t/=50)/Math.abs(t)+Math.round(14*t))},f.prototype.shouldForceSelection=function(e){return a.isMac?e.altKey&&this._terminal.options.macOptionClickForcesSelection:e.shiftKey},f.prototype.onMouseDown=function(e){if(this._mouseDownTimeStamp=e.timeStamp,(2!==e.button||!this.hasSelection)&&0===e.button){if(!this._enabled){if(!this.shouldForceSelection(e))return;e.stopPropagation()}e.preventDefault(),this._dragScrollAmount=0,this._enabled&&e.shiftKey?this._onIncrementalClick(e):1===e.detail?this._onSingleClick(e):2===e.detail?this._onDoubleClick(e):3===e.detail&&this._onTripleClick(e),this._addMouseDownListeners(),this.refresh(!0)}},f.prototype._addMouseDownListeners=function(){var e=this;this._terminal.element.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._terminal.element.ownerDocument.addEventListener("mouseup",this._mouseUpListener),this._dragScrollIntervalTimer=setInterval(function(){return e._dragScroll()},50)},f.prototype._removeMouseDownListeners=function(){this._terminal.element.ownerDocument&&(this._terminal.element.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._terminal.element.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=null},f.prototype._onIncrementalClick=function(e){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(e))},f.prototype._onSingleClick=function(e){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(e)?3:0,this._model.selectionStart=this._getMouseBufferCoords(e),this._model.selectionStart){this._model.selectionEnd=null;var t=this._buffer.lines.get(this._model.selectionStart[1]);t&&(t.length>=this._model.selectionStart[0]||0===t.hasWidth(this._model.selectionStart[0])&&this._model.selectionStart[0]++)}},f.prototype._onDoubleClick=function(e){var t=this._getMouseBufferCoords(e);t&&(this._activeSelectionMode=1,this._selectWordAt(t,!0))},f.prototype._onTripleClick=function(e){var t=this._getMouseBufferCoords(e);t&&(this._activeSelectionMode=2,this._selectLineAt(t[1]))},f.prototype.shouldColumnSelect=function(e){return e.altKey&&!(a.isMac&&this._terminal.options.macOptionClickForcesSelection)},f.prototype._onMouseMove=function(e){e.stopImmediatePropagation();var t=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;this._model.selectionEnd=this._getMouseBufferCoords(e),this._model.selectionEnd?(2===this._activeSelectionMode?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._terminal.cols:1===this._activeSelectionMode&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(e),3!==this._activeSelectionMode&&(0<this._dragScrollAmount?this._model.selectionEnd[0]=this._terminal.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0)),this._model.selectionEnd[1]<this._buffer.lines.length&&0===this._buffer.lines.get(this._model.selectionEnd[1]).hasWidth(this._model.selectionEnd[0])&&this._model.selectionEnd[0]++,t&&t[0]===this._model.selectionEnd[0]&&t[1]===this._model.selectionEnd[1]||this.refresh(!0)):this.refresh(!0)},f.prototype._dragScroll=function(){this._dragScrollAmount&&(this._terminal.scrollLines(this._dragScrollAmount,!1),0<this._dragScrollAmount?(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=this._terminal.cols),this._model.selectionEnd[1]=Math.min(this._terminal.buffer.ydisp+this._terminal.rows,this._terminal.buffer.lines.length-1)):(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=this._terminal.buffer.ydisp),this.refresh())},f.prototype._onMouseUp=function(e){var t=e.timeStamp-this._mouseDownTimeStamp;this._removeMouseDownListeners(),this.selectionText.length<=1&&t<500?new o.AltClickHandler(e,this._terminal).move():this.hasSelection&&this._onSelectionChange.fire()},f.prototype._onBufferActivate=function(e){var t=this;this.clearSelection(),this._trimListener&&this._trimListener.dispose(),this._trimListener=e.activeBuffer.lines.onTrim(function(e){return t._onTrim(e)})},f.prototype._convertViewportColToCharacterIndex=function(e,t){for(var r=t[0],n=0;t[0]>=n;n++){var i=e.loadCell(n,this._workCell).getChars().length;0===this._workCell.getWidth()?r--:1<i&&t[0]!==n&&(r+=i-1)}return r},f.prototype.setSelection=function(e,t,r){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[e,t],this._model.selectionStartLength=r,this.refresh()},f.prototype._getWordAt=function(e,t,r,n){if(void 0===r&&(r=!0),void 0===n&&(n=!0),e[0]>=this._terminal.cols)return null;var i=this._buffer.lines.get(e[1]);if(!i)return null;var o=this._buffer.translateBufferLineToString(e[1],!1),s=this._convertViewportColToCharacterIndex(i,e),a=s,l=e[0]-s,c=0,u=0,h=0,f=0;if(" "===o.charAt(s)){for(;0<s&&" "===o.charAt(s-1);)s--;for(;a<o.length&&" "===o.charAt(a+1);)a++}else{var d=e[0],p=e[0];0===i.getWidth(d)&&(c++,d--),2===i.getWidth(p)&&(u++,p++);var _=i.getString(p).length;for(1<_&&(f+=_-1,a+=_-1);0<d&&0<s&&!this._isCharWordSeparator(i.loadCell(d-1,this._workCell));){i.loadCell(d-1,this._workCell);var m=this._workCell.getChars().length;0===this._workCell.getWidth()?(c++,d--):1<m&&(h+=m-1,s-=m-1),s--,d--}for(;p<i.length&&a+1<o.length&&!this._isCharWordSeparator(i.loadCell(p+1,this._workCell));){i.loadCell(p+1,this._workCell);var y=this._workCell.getChars().length;2===this._workCell.getWidth()?(u++,p++):1<y&&(f+=y-1,a+=y-1),a++,p++}}a++;var g=s+l-c+h,v=Math.min(this._terminal.cols,a-s+c+u-h-f);if(!t&&""===o.slice(s,a).trim())return null;if(r&&0===g&&32!==i.getCodePoint(0)){var b=this._buffer.lines.get(e[1]-1);if(b&&i.isWrapped&&32!==b.getCodePoint(this._terminal.cols-1)){var C=this._getWordAt([this._terminal.cols-1,e[1]-1],!1,!0,!1);if(C){var w=this._terminal.cols-C.start;g-=w,v+=w}}}if(n&&g+v===this._terminal.cols&&32!==i.getCodePoint(this._terminal.cols-1)){var E=this._buffer.lines.get(e[1]+1);if(E&&E.isWrapped&&32!==E.getCodePoint(0)){var S=this._getWordAt([0,e[1]+1],!1,!1,!0);S&&(v+=S.length)}}return{start:g,length:v}},f.prototype._selectWordAt=function(e,t){var r=this._getWordAt(e,t);if(r){for(;r.start<0;)r.start+=this._terminal.cols,e[1]--;this._model.selectionStart=[r.start,e[1]],this._model.selectionStartLength=r.length}},f.prototype._selectToWordAt=function(e){var t=this._getWordAt(e,!0);if(t){for(var r=e[1];t.start<0;)t.start+=this._terminal.cols,r--;if(!this._model.areSelectionValuesReversed())for(;t.start+t.length>this._terminal.cols;)t.length-=this._terminal.cols,r++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?t.start:t.start+t.length,r]}},f.prototype._isCharWordSeparator=function(e){return 0!==e.getWidth()&&0<=" ()[]{}'\"".indexOf(e.getChars())},f.prototype._selectLineAt=function(e){var t=this._buffer.getWrappedRangeForLine(e);this._model.selectionStart=[0,t.first],this._model.selectionEnd=[this._terminal.cols,t.last],this._model.selectionStartLength=0},f);function f(e,t){this._terminal=e,this._charMeasure=t,this._enabled=!0,this._workCell=new s.CellData,this._onLinuxMouseSelection=new l.EventEmitter2,this._onRedrawRequest=new l.EventEmitter2,this._onSelectionChange=new l.EventEmitter2,this._initListeners(),this.enable(),this._model=new i.SelectionModel(e),this._activeSelectionMode=0}r.SelectionManager=h},{"./MouseHelper":28,"./SelectionModel":31,"./common/EventEmitter2":41,"./common/Platform":43,"./core/buffer/BufferLine":47,"./handlers/AltClickHandler":53}],31:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=(i.prototype.clearSelection=function(){this.selectionStart=null,this.selectionEnd=null,this.isSelectAllActive=!1,this.selectionStartLength=0},Object.defineProperty(i.prototype,"finalSelectionStart",{get:function(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"finalSelectionEnd",{get:function(){if(this.isSelectAllActive)return[this._terminal.cols,this._terminal.buffer.ybase+this._terminal.rows-1];if(!this.selectionStart)return null;if(this.selectionEnd&&!this.areSelectionValuesReversed())return this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]?[Math.max(this.selectionStart[0]+this.selectionStartLength,this.selectionEnd[0]),this.selectionEnd[1]]:this.selectionEnd;var e=this.selectionStart[0]+this.selectionStartLength;return e>this._terminal.cols?[e%this._terminal.cols,this.selectionStart[1]+Math.floor(e/this._terminal.cols)]:[e,this.selectionStart[1]]},enumerable:!0,configurable:!0}),i.prototype.areSelectionValuesReversed=function(){var e=this.selectionStart,t=this.selectionEnd;return!(!e||!t)&&(e[1]>t[1]||e[1]===t[1]&&e[0]>t[0])},i.prototype.onTrim=function(e){return this.selectionStart&&(this.selectionStart[1]-=e),this.selectionEnd&&(this.selectionEnd[1]-=e),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)},i);function i(e){this._terminal=e,this.clearSelection()}r.SelectionModel=n},{}],32:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.DEFAULT_BELL_SOUND="data:audio/wav;base64,UklGRigBAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQBAADpAFgCwAMlBZoG/wdmCcoKRAypDQ8PbRDBEQQTOxRtFYcWlBePGIUZXhoiG88bcBz7HHIdzh0WHlMeZx51HmkeUx4WHs8dah0AHXwc3hs9G4saxRnyGBIYGBcQFv8U4RPAEoYRQBACD70NWwwHC6gJOwjWBloF7gOBAhABkf8b/qv8R/ve+Xf4Ife79W/0JfPZ8Z/wde9N7ijtE+wU6xvqM+lb6H7nw+YX5mrlxuQz5Mzje+Ma49fioeKD4nXiYeJy4pHitOL04j/jn+MN5IPkFOWs5U3mDefM55/ogOl36m7rdOyE7abuyu8D8Unyj/Pg9D/2qfcb+Yn6/vuK/Qj/lAAlAg==";var n=(Object.defineProperty(i,"audioContext",{get:function(){if(!i._audioContext){var e=window.AudioContext||window.webkitAudioContext;if(!e)return console.warn("Web Audio API is not supported by this browser. Consider upgrading to the latest version"),null;i._audioContext=new e}return i._audioContext},enumerable:!0,configurable:!0}),i.prototype.playBellSound=function(){var t=i.audioContext;if(t){var r=t.createBufferSource();t.decodeAudioData(this._base64ToArrayBuffer(this._removeMimeType(this._terminal.options.bellSound)),function(e){r.buffer=e,r.connect(t.destination),r.start(0)})}},i.prototype._base64ToArrayBuffer=function(e){for(var t=window.atob(e),r=t.length,n=new Uint8Array(r),i=0;i<r;i++)n[i]=t.charCodeAt(i);return n.buffer},i.prototype._removeMimeType=function(e){return e.split(",")[1]},i);function i(e){this._terminal=e}r.SoundManager=n},{}],33:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.blankLine="Blank line",r.promptLabel="Terminal input",r.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},{}],34:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var o,s=e("./BufferSet"),a=e("./Buffer"),l=e("./CompositionHelper"),c=e("./common/EventEmitter"),u=e("./Viewport"),h=e("./Clipboard"),f=e("./common/data/EscapeSequences"),d=e("./InputHandler"),p=e("./renderer/Renderer"),_=e("./Linkifier"),m=e("./SelectionManager"),y=e("./CharMeasure"),g=e("./common/Platform"),v=e("./ui/Lifecycle"),b=e("./Strings"),C=e("./MouseHelper"),w=e("./SoundManager"),E=e("./MouseZoneManager"),S=e("./AccessibilityManager"),x=e("./renderer/atlas/CharAtlasCache"),A=e("./renderer/dom/DomRenderer"),T=e("./core/input/Keyboard"),R=e("./common/Clone"),L=e("./common/EventEmitter2"),k=e("./core/buffer/BufferLine"),M=e("./WindowsMode"),O=e("./ui/ColorManager"),D=e("./renderer/RenderCoordinator"),F="undefined"!=typeof window?window.document:null,P=["cols","rows"],B={cols:80,rows:24,convertEol:!1,termName:"xterm",cursorBlink:!1,cursorStyle:"block",bellSound:w.DEFAULT_BELL_SOUND,bellStyle:"none",drawBoldTextInBrightColors:!0,enableBold:!0,experimentalCharAtlas:"static",fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,letterSpacing:0,scrollback:1e3,screenKeys:!1,screenReaderMode:!1,debug:!1,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,cancelEvents:!1,disableStdin:!1,useFlowControl:!1,allowTransparency:!1,tabStopWidth:8,theme:void 0,rightClickSelectsWord:g.isMac,rendererType:"canvas",windowsMode:!1},I=(o=c.EventEmitter,i(H,o),Object.defineProperty(H.prototype,"onCursorMove",{get:function(){return this._onCursorMove.event},enumerable:!0,configurable:!0}),Object.defineProperty(H.prototype,"onData",{get:function(){return this._onData.event},enumerable:!0,configurable:!0}),Object.defineProperty(H.prototype,"onKey",{get:function(){return this._onKey.event},enumerable:!0,configurable:!0}),Object.defineProperty(H.prototype,"onLineFeed",{get:function(){return this._onLineFeed.event},enumerable:!0,configurable:!0}),Object.defineProperty(H.prototype,"onRender",{get:function(){return this._onRender.event},enumerable:!0,configurable:!0}),Object.defineProperty(H.prototype,"onResize",{get:function(){return this._onResize.event},enumerable:!0,configurable:!0}),Object.defineProperty(H.prototype,"onScroll",{get:function(){return this._onScroll.event},enumerable:!0,configurable:!0}),Object.defineProperty(H.prototype,"onSelectionChange",{get:function(){return this._onSelectionChange.event},enumerable:!0,configurable:!0}),Object.defineProperty(H.prototype,"onTitleChange",{get:function(){return this._onTitleChange.event},enumerable:!0,configurable:!0}),H.prototype.dispose=function(){o.prototype.dispose.call(this),this._windowsMode&&(this._windowsMode.dispose(),this._windowsMode=void 0),this._customKeyEventHandler=null,x.removeTerminalFromCache(this),this.handler=function(){},this.write=function(){},this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)},H.prototype.destroy=function(){this.dispose()},H.prototype._setup=function(){var t=this;Object.keys(B).forEach(function(e){null!==t.options[e]&&void 0!==t.options[e]||(t.options[e]=B[e])}),this._parent=F?F.body:null,this.cols=Math.max(this.options.cols,2),this.rows=Math.max(this.options.rows,1),this.options.handler&&this.onData(this.options.handler),this.cursorState=0,this.cursorHidden=!1,this._customKeyEventHandler=null,this.applicationKeypad=!1,this.applicationCursor=!1,this.originMode=!1,this.insertMode=!1,this.wraparoundMode=!0,this.bracketedPasteMode=!1,this.charset=null,this.gcharset=null,this.glevel=0,this.charsets=[null],this.curAttrData=k.DEFAULT_ATTR_DATA.clone(),this._eraseAttrData=k.DEFAULT_ATTR_DATA.clone(),this.params=[],this.currentParam=0,this.writeBuffer=[],this.writeBufferUtf8=[],this._writeInProgress=!1,this._xoffSentToCatchUp=!1,this._userScrolling=!1,this._inputHandler=new d.InputHandler(this),this._inputHandler.onCursorMove(function(){return t._onCursorMove.fire()}),this._inputHandler.onLineFeed(function(){return t._onLineFeed.fire()}),this._inputHandler.onData(function(e){return t._onData.fire(e)}),this.register(this._inputHandler),this.selectionManager=this.selectionManager||null,this.linkifier=this.linkifier||new _.Linkifier(this),this._mouseZoneManager=this._mouseZoneManager||null,this.soundManager=this.soundManager||new w.SoundManager(this),this.buffers=new s.BufferSet(this),this.selectionManager&&(this.selectionManager.clearSelection(),this.selectionManager.initBuffersListeners()),this.options.windowsMode&&(this._windowsMode=M.applyWindowsMode(this))},Object.defineProperty(H.prototype,"buffer",{get:function(){return this.buffers.active},enumerable:!0,configurable:!0}),H.prototype.eraseAttrData=function(){return this._eraseAttrData.bg&=-67108864,this._eraseAttrData.bg|=67108863&this.curAttrData.bg,this._eraseAttrData},H.prototype.focus=function(){this.textarea&&this.textarea.focus({preventScroll:!0})},Object.defineProperty(H.prototype,"isFocused",{get:function(){return F.activeElement===this.textarea&&F.hasFocus()},enumerable:!0,configurable:!0}),H.prototype.getOption=function(e){if(!(e in B))throw new Error('No option with key "'+e+'"');return this.options[e]},H.prototype.setOption=function(e,t){if(!(e in B))throw new Error('No option with key "'+e+'"');if(-1!==P.indexOf(e)&&console.error('Option "'+e+'" can only be set in the constructor'),this.options[e]!==t){switch(e){case"bellStyle":t=t||"none";break;case"cursorStyle":t=t||"block";break;case"fontWeight":t=t||"normal";break;case"fontWeightBold":t=t||"bold";break;case"lineHeight":if(t<1)return void console.warn(e+" cannot be less than 1, value: "+t);case"rendererType":t=t||"canvas";break;case"tabStopWidth":if(t<1)return void console.warn(e+" cannot be less than 1, value: "+t);break;case"theme":this._setTheme(t);break;case"scrollback":if((t=Math.min(t,a.MAX_BUFFER_SIZE))<0)return void console.warn(e+" cannot be less than 0, value: "+t);if(this.options[e]!==t){var r=this.rows+t;if(this.buffer.lines.length>r){var n=this.buffer.lines.length-r,i=this.buffer.ydisp-n<0;this.buffer.lines.trimStart(n),this.buffer.ybase=Math.max(this.buffer.ybase-n,0),this.buffer.ydisp=Math.max(this.buffer.ydisp-n,0),i&&this.refresh(0,this.rows-1)}}}switch(this.options[e]=t,e){case"fontFamily":case"fontSize":this._renderCoordinator&&(this._renderCoordinator.clear(),this.charMeasure.measure(this.options));break;case"drawBoldTextInBrightColors":case"experimentalCharAtlas":case"enableBold":case"letterSpacing":case"lineHeight":case"fontWeight":case"fontWeightBold":this._renderCoordinator&&(this._renderCoordinator.clear(),this._renderCoordinator.onResize(this.cols,this.rows),this.refresh(0,this.rows-1));break;case"rendererType":this._renderCoordinator&&this._renderCoordinator.setRenderer(this._createRenderer());break;case"scrollback":this.buffers.resize(this.cols,this.rows),this.viewport&&this.viewport.syncScrollArea();break;case"screenReaderMode":t?!this._accessibilityManager&&this._renderCoordinator&&(this._accessibilityManager=new S.AccessibilityManager(this,this._renderCoordinator.dimensions)):this._accessibilityManager&&(this._accessibilityManager.dispose(),this._accessibilityManager=null);break;case"tabStopWidth":this.buffers.setupTabStops();break;case"windowsMode":t?this._windowsMode||(this._windowsMode=M.applyWindowsMode(this)):this._windowsMode&&(this._windowsMode.dispose(),this._windowsMode=void 0)}this._renderCoordinator&&this._renderCoordinator.onOptionsChanged()}},H.prototype._onTextAreaFocus=function(e){this.sendFocus&&this.handler(f.C0.ESC+"[I"),this.updateCursorStyle(e),this.element.classList.add("focus"),this.showCursor(),this.emit("focus")},H.prototype.blur=function(){return this.textarea.blur()},H.prototype._onTextAreaBlur=function(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.sendFocus&&this.handler(f.C0.ESC+"[O"),this.element.classList.remove("focus"),this.emit("blur")},H.prototype._initGlobal=function(){var t=this;function e(e){return h.pasteHandler(e,t)}this._bindKeys(),this.register(v.addDisposableDomListener(this.element,"copy",function(e){t.hasSelection()&&h.copyHandler(e,t,t.selectionManager)})),this.register(v.addDisposableDomListener(this.textarea,"paste",e)),this.register(v.addDisposableDomListener(this.element,"paste",e)),g.isFirefox?this.register(v.addDisposableDomListener(this.element,"mousedown",function(e){2===e.button&&h.rightClickHandler(e,t,t.selectionManager,t.options.rightClickSelectsWord)})):this.register(v.addDisposableDomListener(this.element,"contextmenu",function(e){h.rightClickHandler(e,t,t.selectionManager,t.options.rightClickSelectsWord)})),g.isLinux&&this.register(v.addDisposableDomListener(this.element,"auxclick",function(e){1===e.button&&h.moveTextAreaUnderMouseCursor(e,t)}))},H.prototype._bindKeys=function(){var t=this,r=this;this.register(v.addDisposableDomListener(this.element,"keydown",function(e){F.activeElement===this&&r._keyDown(e)},!0)),this.register(v.addDisposableDomListener(this.element,"keypress",function(e){F.activeElement===this&&r._keyPress(e)},!0)),this.register(v.addDisposableDomListener(this.element,"keyup",function(e){!function(e){return 16===e.keyCode||17===e.keyCode||18===e.keyCode}(e)&&t.focus(),r._keyUp(e)},!0)),this.register(v.addDisposableDomListener(this.textarea,"keydown",function(e){return t._keyDown(e)},!0)),this.register(v.addDisposableDomListener(this.textarea,"keypress",function(e){return t._keyPress(e)},!0)),this.register(v.addDisposableDomListener(this.textarea,"compositionstart",function(){return t._compositionHelper.compositionstart()})),this.register(v.addDisposableDomListener(this.textarea,"compositionupdate",function(e){return t._compositionHelper.compositionupdate(e)})),this.register(v.addDisposableDomListener(this.textarea,"compositionend",function(){return t._compositionHelper.compositionend()})),this.register(this.onRender(function(){return t._compositionHelper.updateCompositionElements()})),this.register(this.onRender(function(e){return t._queueLinkification(e.start,e.end)}))},H.prototype.open=function(e){var t=this;if(this._parent=e||this._parent,!this._parent)throw new Error("Terminal requires a parent element.");this._context=this._parent.ownerDocument.defaultView,this._document=this._parent.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),this.element.setAttribute("tabindex","0"),this._parent.appendChild(this.element);var r=F.createDocumentFragment();this._viewportElement=F.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),r.appendChild(this._viewportElement),this._viewportScrollArea=F.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=F.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=F.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),r.appendChild(this.screenElement),this._mouseZoneManager=new E.MouseZoneManager(this),this.register(this._mouseZoneManager),this.register(this.onScroll(function(){return t._mouseZoneManager.clearAll()})),this.linkifier.attachToDom(this._mouseZoneManager),this.textarea=F.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",b.promptLabel),this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this.register(v.addDisposableDomListener(this.textarea,"focus",function(e){return t._onTextAreaFocus(e)})),this.register(v.addDisposableDomListener(this.textarea,"blur",function(){return t._onTextAreaBlur()})),this._helperContainer.appendChild(this.textarea),this._compositionView=F.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=new l.CompositionHelper(this.textarea,this._compositionView,this),this._helperContainer.appendChild(this._compositionView),this.charMeasure=new y.CharMeasure(F,this._helperContainer),this.element.appendChild(r),this._theme=this.options.theme,this._colorManager=new O.ColorManager(F,this.options.allowTransparency),this._colorManager.setTheme(this._theme);var n=this._createRenderer();this._renderCoordinator=new D.RenderCoordinator(n,this.rows,this.screenElement),this._renderCoordinator.onRender(function(e){return t._onRender.fire(e)}),this.onResize(function(e){return t._renderCoordinator.resize(e.cols,e.rows)}),this.viewport=new u.Viewport(this,this._viewportElement,this._viewportScrollArea,this.charMeasure,this._renderCoordinator.dimensions),this.viewport.onThemeChange(this._colorManager.colors),this.register(this.viewport),this.register(this.onCursorMove(function(){return t._renderCoordinator.onCursorMove()})),this.register(this.onResize(function(){return t._renderCoordinator.onResize(t.cols,t.rows)})),this.register(this.addDisposableListener("blur",function(){return t._renderCoordinator.onBlur()})),this.register(this.addDisposableListener("focus",function(){return t._renderCoordinator.onFocus()})),this.register(this.charMeasure.onCharSizeChanged(function(){return t._renderCoordinator.onCharSizeChanged()})),this.register(this._renderCoordinator.onDimensionsChange(function(){return t.viewport.syncScrollArea()})),this.selectionManager=new m.SelectionManager(this,this.charMeasure),this.register(this.selectionManager.onSelectionChange(function(){return t._onSelectionChange.fire()})),this.register(v.addDisposableDomListener(this.element,"mousedown",function(e){return t.selectionManager.onMouseDown(e)})),this.register(this.selectionManager.onRedrawRequest(function(e){return t._renderCoordinator.onSelectionChanged(e.start,e.end,e.columnSelectMode)})),this.register(this.selectionManager.onLinuxMouseSelection(function(e){t.textarea.value=e,t.textarea.focus(),t.textarea.select()})),this.register(this.onScroll(function(){t.viewport.syncScrollArea(),t.selectionManager.refresh()})),this.register(v.addDisposableDomListener(this._viewportElement,"scroll",function(){return t.selectionManager.refresh()})),this.mouseHelper=new C.MouseHelper(this._renderCoordinator),this.element.classList.toggle("enable-mouse-events",this.mouseEvents),this.mouseEvents?this.selectionManager.disable():this.selectionManager.enable(),this.options.screenReaderMode&&(this._accessibilityManager=new S.AccessibilityManager(this,this._renderCoordinator.dimensions),this._accessibilityManager.register(this._renderCoordinator.onDimensionsChange(function(e){return t._accessibilityManager.setDimensions(e)}))),this.charMeasure.measure(this.options),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()},H.prototype._createRenderer=function(){switch(this.options.rendererType){case"canvas":return new p.Renderer(this,this._colorManager.colors);case"dom":return new A.DomRenderer(this,this._colorManager.colors);default:throw new Error('Unrecognized rendererType "'+this.options.rendererType+'"')}},H.prototype._setTheme=function(e){this._theme=e,this._colorManager&&this._colorManager.setTheme(e),this._renderCoordinator&&this._renderCoordinator.setColors(this._colorManager.colors),this.viewport&&this.viewport.onThemeChange(this._colorManager.colors)},H.prototype.bindMouse=function(){var o=this,e=this.element,s=this,n=32;function a(e){var t,r;if(t=function(e){var t,r,n,i,o;switch(e.overrideType||e.type){case"mousedown":t=null!==e.button&&void 0!==e.button?+e.button:null!==e.which&&void 0!==e.which?e.which-1:null,g.isMSIE&&(t=1===t?0:4===t?1:t);break;case"mouseup":t=3;break;case"DOMMouseScroll":t=e.detail<0?64:65;break;case"wheel":t=e.deltaY<0?64:65}return r=e.shiftKey?4:0,n=e.metaKey?8:0,i=e.ctrlKey?16:0,o=r|n|i,s.vt200Mouse?o&=i:s.normalMouse||(o=0),t=32+(o<<2)+t}(e),r=s.mouseHelper.getRawByteCoords(e,s.screenElement,s.charMeasure,s.cols,s.rows))switch(l(t,r),e.overrideType||e.type){case"mousedown":n=t;break;case"mouseup":n=32}}function i(e,t){if(s.utfMouse){if(2047<t)return void e.push(2047);e.push(t)}else{if(255===t)return void e.push(0);127<t&&(t=127),e.push(t)}}function l(e,t){if(s._vt300Mouse){e&=3,t.x-=32,t.y-=32;var r=f.C0.ESC+"[24";if(0===e)r+="1";else if(1===e)r+="3";else if(2===e)r+="5";else{if(3===e)return;r+="0"}return r+="~["+t.x+","+t.y+"]\r",void s.handler(r)}if(s._decLocator)return e&=3,t.x-=32,t.y-=32,0===e?e=2:1===e?e=4:2===e?e=6:3===e&&(e=3),void s.handler(f.C0.ESC+"["+e+";"+(3===e?4:0)+";"+t.y+";"+t.x+";"+t.page||"0&w");if(s.urxvtMouse)return t.x-=32,t.y-=32,t.x++,t.y++,void s.handler(f.C0.ESC+"["+e+";"+t.x+";"+t.y+"M");if(s.sgrMouse)return t.x-=32,t.y-=32,void s.handler(f.C0.ESC+"[<"+((3==(3&e)?-4&e:e)-32)+";"+t.x+";"+t.y+(3==(3&e)?"m":"M"));var n=[];i(n,e),i(n,t.x),i(n,t.y),s.handler(f.C0.ESC+"[M"+String.fromCharCode.apply(String,n))}this.register(v.addDisposableDomListener(e,"mousedown",function(e){if(e.preventDefault(),o.focus(),o.mouseEvents&&!o.selectionManager.shouldForceSelection(e)){if(a(e),o.vt200Mouse)return e.overrideType="mouseup",a(e),o.cancel(e);var t;o.normalMouse&&(t=function(e){o.normalMouse&&function(e){var t=n,r=s.mouseHelper.getRawByteCoords(e,s.screenElement,s.charMeasure,s.cols,s.rows);r&&l(t+=32,r)}(e)},o._document.addEventListener("mousemove",t));var r=function(e){return o.normalMouse&&!o.x10Mouse&&a(e),t&&(o._document.removeEventListener("mousemove",t),t=null),o._document.removeEventListener("mouseup",r),o.cancel(e)};return o._document.addEventListener("mouseup",r),o.cancel(e)}})),this.register(v.addDisposableDomListener(e,"wheel",function(e){if(o.mouseEvents)o.x10Mouse||o._vt300Mouse||o._decLocator||(a(e),e.preventDefault());else if(!o.buffer.hasScrollback){var t=o.viewport.getLinesScrolled(e);if(0===t)return;for(var r=f.C0.ESC+(o.applicationCursor?"O":"[")+(e.deltaY<0?"A":"B"),n="",i=0;i<Math.abs(t);i++)n+=r;o.handler(n)}})),this.register(v.addDisposableDomListener(e,"wheel",function(e){if(!o.mouseEvents)return o.viewport.onWheel(e),o.cancel(e)})),this.register(v.addDisposableDomListener(e,"touchstart",function(e){if(!o.mouseEvents)return o.viewport.onTouchStart(e),o.cancel(e)})),this.register(v.addDisposableDomListener(e,"touchmove",function(e){if(!o.mouseEvents)return o.viewport.onTouchMove(e),o.cancel(e)}))},H.prototype.refresh=function(e,t){this._renderCoordinator&&this._renderCoordinator.refreshRows(e,t)},H.prototype._queueLinkification=function(e,t){this.linkifier&&this.linkifier.linkifyRows(e,t)},H.prototype.updateCursorStyle=function(e){this.selectionManager&&this.selectionManager.shouldColumnSelect(e)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")},H.prototype.showCursor=function(){this.cursorState||(this.cursorState=1,this.refresh(this.buffer.y,this.buffer.y))},H.prototype.scroll=function(e){var t;void 0===e&&(e=!1),t=this._blankLine;var r=this.eraseAttrData();t&&t.length===this.cols&&t.getFg(0)===r.fg&&t.getBg(0)===r.bg||(t=this.buffer.getBlankLine(r,e),this._blankLine=t),t.isWrapped=e;var n=this.buffer.ybase+this.buffer.scrollTop,i=this.buffer.ybase+this.buffer.scrollBottom;if(0===this.buffer.scrollTop){var o=this.buffer.lines.isFull;i===this.buffer.lines.length-1?o?this.buffer.lines.recycle().copyFrom(t):this.buffer.lines.push(t.clone()):this.buffer.lines.splice(i+1,0,t.clone()),o?this._userScrolling&&(this.buffer.ydisp=Math.max(this.buffer.ydisp-1,0)):(this.buffer.ybase++,this._userScrolling||this.buffer.ydisp++)}else{var s=i-n+1;this.buffer.lines.shiftElements(n+1,s-1,-1),this.buffer.lines.set(i,t.clone())}this._userScrolling||(this.buffer.ydisp=this.buffer.ybase),this.updateRange(this.buffer.scrollTop),this.updateRange(this.buffer.scrollBottom),this._onScroll.fire(this.buffer.ydisp)},H.prototype.scrollLines=function(e,t){if(e<0){if(0===this.buffer.ydisp)return;this._userScrolling=!0}else e+this.buffer.ydisp>=this.buffer.ybase&&(this._userScrolling=!1);var r=this.buffer.ydisp;this.buffer.ydisp=Math.max(Math.min(this.buffer.ydisp+e,this.buffer.ybase),0),r!==this.buffer.ydisp&&(t||this._onScroll.fire(this.buffer.ydisp),this.refresh(0,this.rows-1))},H.prototype.scrollPages=function(e){this.scrollLines(e*(this.rows-1))},H.prototype.scrollToTop=function(){this.scrollLines(-this.buffer.ydisp)},H.prototype.scrollToBottom=function(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)},H.prototype.scrollToLine=function(e){var t=e-this.buffer.ydisp;0!=t&&this.scrollLines(t)},H.prototype.writeUtf8=function(e){var t=this;this._isDisposed||e&&(this.writeBufferUtf8.push(e),this.options.useFlowControl&&!this._xoffSentToCatchUp&&5<=this.writeBufferUtf8.length&&(this.handler(f.C0.DC3),this._xoffSentToCatchUp=!0),!this._writeInProgress&&0<this.writeBufferUtf8.length&&(this._writeInProgress=!0,setTimeout(function(){t._innerWriteUtf8()})))},H.prototype._innerWriteUtf8=function(e){var t=this;void 0===e&&(e=0),this._isDisposed&&(this.writeBufferUtf8=[]);for(var r=Date.now();this.writeBufferUtf8.length>e;){var n=this.writeBufferUtf8[e];if(e++,this._xoffSentToCatchUp&&this.writeBufferUtf8.length===e&&(this.handler(f.C0.DC1),this._xoffSentToCatchUp=!1),this._refreshStart=this.buffer.y,this._refreshEnd=this.buffer.y,this._inputHandler.parseUtf8(n),this.updateRange(this.buffer.y),this.refresh(this._refreshStart,this._refreshEnd),12<=Date.now()-r)break}this.writeBufferUtf8.length>e?(50<e&&(this.writeBufferUtf8=this.writeBufferUtf8.slice(e),e=0),setTimeout(function(){return t._innerWriteUtf8(e)},0)):(this._writeInProgress=!1,this.writeBufferUtf8=[])},H.prototype.write=function(e){var t=this;this._isDisposed||e&&(this.writeBuffer.push(e),this.options.useFlowControl&&!this._xoffSentToCatchUp&&5<=this.writeBuffer.length&&(this.handler(f.C0.DC3),this._xoffSentToCatchUp=!0),!this._writeInProgress&&0<this.writeBuffer.length&&(this._writeInProgress=!0,setTimeout(function(){t._innerWrite()})))},H.prototype._innerWrite=function(e){var t=this;void 0===e&&(e=0),this._isDisposed&&(this.writeBuffer=[]);for(var r=Date.now();this.writeBuffer.length>e;){var n=this.writeBuffer[e];if(e++,this._xoffSentToCatchUp&&this.writeBuffer.length===e&&(this.handler(f.C0.DC1),this._xoffSentToCatchUp=!1),this._refreshStart=this.buffer.y,this._refreshEnd=this.buffer.y,this._inputHandler.parse(n),this.updateRange(this.buffer.y),this.refresh(this._refreshStart,this._refreshEnd),12<=Date.now()-r)break}this.writeBuffer.length>e?(50<e&&(this.writeBuffer=this.writeBuffer.slice(e),e=0),setTimeout(function(){return t._innerWrite(e)},0)):(this._writeInProgress=!1,this.writeBuffer=[])},H.prototype.writeln=function(e){this.write(e+"\r\n")},H.prototype.attachCustomKeyEventHandler=function(e){this._customKeyEventHandler=e},H.prototype.addCsiHandler=function(e,t){return this._inputHandler.addCsiHandler(e,t)},H.prototype.addOscHandler=function(e,t){return this._inputHandler.addOscHandler(e,t)},H.prototype.registerLinkMatcher=function(e,t,r){var n=this.linkifier.registerLinkMatcher(e,t,r);return this.refresh(0,this.rows-1),n},H.prototype.deregisterLinkMatcher=function(e){this.linkifier.deregisterLinkMatcher(e)&&this.refresh(0,this.rows-1)},H.prototype.registerCharacterJoiner=function(e){var t=this._renderCoordinator.registerCharacterJoiner(e);return this.refresh(0,this.rows-1),t},H.prototype.deregisterCharacterJoiner=function(e){this._renderCoordinator.deregisterCharacterJoiner(e)&&this.refresh(0,this.rows-1)},Object.defineProperty(H.prototype,"markers",{get:function(){return this.buffer.markers},enumerable:!0,configurable:!0}),H.prototype.addMarker=function(e){if(this.buffer===this.buffers.normal)return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+e)},H.prototype.hasSelection=function(){return!!this.selectionManager&&this.selectionManager.hasSelection},H.prototype.select=function(e,t,r){this.selectionManager.setSelection(e,t,r)},H.prototype.getSelection=function(){return this.selectionManager?this.selectionManager.selectionText:""},H.prototype.getSelectionPosition=function(){if(this.selectionManager.hasSelection)return{startColumn:this.selectionManager.selectionStart[0],startRow:this.selectionManager.selectionStart[1],endColumn:this.selectionManager.selectionEnd[0],endRow:this.selectionManager.selectionEnd[1]}},H.prototype.clearSelection=function(){this.selectionManager&&this.selectionManager.clearSelection()},H.prototype.selectAll=function(){this.selectionManager&&this.selectionManager.selectAll()},H.prototype.selectLines=function(e,t){this.selectionManager&&this.selectionManager.selectLines(e,t)},H.prototype._keyDown=function(e){if(this._customKeyEventHandler&&!1===this._customKeyEventHandler(e))return!1;if(!this._compositionHelper.keydown(e))return this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;var t=T.evaluateKeyboardEvent(e,this.applicationCursor,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(e),3!==t.type&&2!==t.type)return 1===t.type&&this.selectAll(),!!this._isThirdLevelShift(this.browser,e)||(t.cancel&&this.cancel(e,!0),!t.key||(this.emit("keydown",e),this._onKey.fire({key:t.key,domEvent:e}),this.showCursor(),this.handler(t.key),this.cancel(e,!0)));var r=this.rows-1;return this.scrollLines(2===t.type?-r:r),this.cancel(e,!0)},H.prototype._isThirdLevelShift=function(e,t){var r=e.isMac&&!this.options.macOptionIsMeta&&t.altKey&&!t.ctrlKey&&!t.metaKey||e.isMSWindows&&t.altKey&&t.ctrlKey&&!t.metaKey;return"keypress"===t.type?r:r&&(!t.keyCode||47<t.keyCode)},H.prototype.setgLevel=function(e){this.glevel=e,this.charset=this.charsets[e]},H.prototype.setgCharset=function(e,t){this.charsets[e]=t,this.glevel===e&&(this.charset=t)},H.prototype._keyUp=function(e){this.updateCursorStyle(e)},H.prototype._keyPress=function(e){var t;if(this._customKeyEventHandler&&!1===this._customKeyEventHandler(e))return!1;if(this.cancel(e),e.charCode)t=e.charCode;else if(null===e.which||void 0===e.which)t=e.keyCode;else{if(0===e.which||0===e.charCode)return!1;t=e.which}return!(!t||(e.altKey||e.ctrlKey||e.metaKey)&&!this._isThirdLevelShift(this.browser,e)||(t=String.fromCharCode(t),this.emit("keypress",t,e),this._onKey.fire({key:t,domEvent:e}),this.showCursor(),this.handler(t),0))},H.prototype.bell=function(){var e=this;this.emit("bell"),this._soundBell()&&this.soundManager.playBellSound(),this._visualBell()&&(this.element.classList.add("visual-bell-active"),clearTimeout(this._visualBellTimer),this._visualBellTimer=window.setTimeout(function(){e.element.classList.remove("visual-bell-active")},200))},H.prototype.log=function(e,t){this.options.debug&&this._context.console&&this._context.console.log&&this._context.console.log(e,t)},H.prototype.error=function(e,t){this.options.debug&&this._context.console&&this._context.console.error&&this._context.console.error(e,t)},H.prototype.resize=function(e,t){isNaN(e)||isNaN(t)||(e!==this.cols||t!==this.rows?(e<2&&(e=2),t<1&&(t=1),this.buffers.resize(e,t),this.cols=e,this.rows=t,this.buffers.setupTabStops(this.cols),this.charMeasure&&this.charMeasure.measure(this.options),this.refresh(0,this.rows-1),this._onResize.fire({cols:e,rows:t})):!this.charMeasure||this.charMeasure.width&&this.charMeasure.height||this.charMeasure.measure(this.options))},H.prototype.updateRange=function(e){e<this._refreshStart&&(this._refreshStart=e),e>this._refreshEnd&&(this._refreshEnd=e)},H.prototype.maxRange=function(){this._refreshStart=0,this._refreshEnd=this.rows-1},H.prototype.clear=function(){if(0!==this.buffer.ybase||0!==this.buffer.y){this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(var e=1;e<this.rows;e++)this.buffer.lines.push(this.buffer.getBlankLine(k.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire(this.buffer.ydisp)}},H.prototype.is=function(e){return 0===(this.options.termName+"").indexOf(e)},H.prototype.handler=function(e){this.options.disableStdin||(this.selectionManager&&this.selectionManager.hasSelection&&this.selectionManager.clearSelection(),this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),this._onData.fire(e))},H.prototype.handleTitle=function(e){this._onTitleChange.fire(e)},H.prototype.index=function(){this.buffer.y++,this.buffer.y>this.buffer.scrollBottom&&(this.buffer.y--,this.scroll()),this.buffer.x>=this.cols&&this.buffer.x--},H.prototype.reverseIndex=function(){if(this.buffer.y===this.buffer.scrollTop){var e=this.buffer.scrollBottom-this.buffer.scrollTop;this.buffer.lines.shiftElements(this.buffer.y+this.buffer.ybase,e,1),this.buffer.lines.set(this.buffer.y+this.buffer.ybase,this.buffer.getBlankLine(this.eraseAttrData())),this.updateRange(this.buffer.scrollTop),this.updateRange(this.buffer.scrollBottom)}else this.buffer.y--},H.prototype.reset=function(){this.options.rows=this.rows,this.options.cols=this.cols;var e=this._customKeyEventHandler,t=this._inputHandler,r=this.cursorState,n=this.writeBuffer,i=this.writeBufferUtf8,o=this._writeInProgress,s=this._xoffSentToCatchUp,a=this._userScrolling;this._setup(),this._customKeyEventHandler=e,this._inputHandler=t,this.cursorState=r,this.writeBuffer=n,this.writeBufferUtf8=i,this._writeInProgress=o,this._xoffSentToCatchUp=s,this._userScrolling=a,this.refresh(0,this.rows-1),this.viewport&&this.viewport.syncScrollArea()},H.prototype.tabSet=function(){this.buffer.tabs[this.buffer.x]=!0},H.prototype.cancel=function(e,t){if(this.options.cancelEvents||t)return e.preventDefault(),e.stopPropagation(),!1},H.prototype._visualBell=function(){return!1},H.prototype._soundBell=function(){return"sound"===this.options.bellStyle},H);function H(e){void 0===e&&(e={});var t=o.call(this)||this;return t.browser=g,t._blankLine=null,t._onCursorMove=new L.EventEmitter2,t._onData=new L.EventEmitter2,t._onKey=new L.EventEmitter2,t._onLineFeed=new L.EventEmitter2,t._onRender=new L.EventEmitter2,t._onResize=new L.EventEmitter2,t._onScroll=new L.EventEmitter2,t._onSelectionChange=new L.EventEmitter2,t._onTitleChange=new L.EventEmitter2,t.options=R.clone(e),t._setup(),t.onCursorMove(function(){return t.emit("cursormove")}),t.onData(function(e){return t.emit("data",e)}),t.onKey(function(e){return t.emit("key",e.key,e.domEvent)}),t.onLineFeed(function(){return t.emit("linefeed")}),t.onRender(function(e){return t.emit("refresh",e)}),t.onResize(function(e){return t.emit("resize",e)}),t.onSelectionChange(function(){return t.emit("selection")}),t.onScroll(function(e){return t.emit("scroll",e)}),t.onTitleChange(function(e){return t.emit("title",e)}),t}r.Terminal=I},{"./AccessibilityManager":18,"./Buffer":19,"./BufferSet":20,"./CharMeasure":21,"./Clipboard":23,"./CompositionHelper":24,"./InputHandler":26,"./Linkifier":27,"./MouseHelper":28,"./MouseZoneManager":29,"./SelectionManager":30,"./SoundManager":32,"./Strings":33,"./Viewport":35,"./WindowsMode":36,"./common/Clone":39,"./common/EventEmitter":40,"./common/EventEmitter2":41,"./common/Platform":43,"./common/data/EscapeSequences":46,"./core/buffer/BufferLine":47,"./core/input/Keyboard":51,"./renderer/RenderCoordinator":61,"./renderer/Renderer":62,"./renderer/atlas/CharAtlasCache":66,"./renderer/dom/DomRenderer":74,"./ui/ColorManager":76,"./ui/Lifecycle":77}],35:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var s,o=e("./common/Lifecycle"),a=e("./ui/Lifecycle"),l=(s=o.Disposable,i(c,s),c.prototype.onDimensionsChance=function(e){this._dimensions=e},c.prototype.onThemeChange=function(e){this._viewportElement.style.backgroundColor=e.background.css},c.prototype._refresh=function(){var e=this;null===this._refreshAnimationFrame&&(this._refreshAnimationFrame=requestAnimationFrame(function(){return e._innerRefresh()}))},c.prototype._innerRefresh=function(){if(0<this._charMeasure.height){this._currentRowHeight=this._dimensions.scaledCellHeight/window.devicePixelRatio,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;var e=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._dimensions.canvasHeight);this._lastRecordedBufferHeight!==e&&(this._lastRecordedBufferHeight=e,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}var t=this._terminal.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==t&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=t),this._refreshAnimationFrame=null},c.prototype.syncScrollArea=function(){if(this._lastRecordedBufferLength!==this._terminal.buffer.lines.length)return this._lastRecordedBufferLength=this._terminal.buffer.lines.length,void this._refresh();if(this._lastRecordedViewportHeight===this._dimensions.canvasHeight){var e=this._terminal.buffer.ydisp*this._currentRowHeight;this._lastScrollTop===e&&this._lastScrollTop===this._viewportElement.scrollTop&&this._dimensions.scaledCellHeight/window.devicePixelRatio===this._currentRowHeight||this._refresh()}else this._refresh()},c.prototype._onScroll=function(e){if(this._lastScrollTop=this._viewportElement.scrollTop,this._viewportElement.offsetParent)if(this._ignoreNextScrollEvent)this._ignoreNextScrollEvent=!1;else{var t=Math.round(this._lastScrollTop/this._currentRowHeight)-this._terminal.buffer.ydisp;this._terminal.scrollLines(t,!0)}},c.prototype.onWheel=function(e){var t=this._getPixelsScrolled(e);0!==t&&(this._viewportElement.scrollTop+=t,e.preventDefault())},c.prototype._getPixelsScrolled=function(e){if(0===e.deltaY)return 0;var t=e.deltaY;return e.deltaMode===WheelEvent.DOM_DELTA_LINE?t*=this._currentRowHeight:e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._currentRowHeight*this._terminal.rows),t},c.prototype.getLinesScrolled=function(e){if(0===e.deltaY)return 0;var t=e.deltaY;return e.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(t/=this._currentRowHeight+0,this._wheelPartialScroll+=t,t=Math.floor(Math.abs(this._wheelPartialScroll))*(0<this._wheelPartialScroll?1:-1),this._wheelPartialScroll%=1):e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._terminal.rows),t},c.prototype.onTouchStart=function(e){this._lastTouchY=e.touches[0].pageY},c.prototype.onTouchMove=function(e){var t=this._lastTouchY-e.touches[0].pageY;this._lastTouchY=e.touches[0].pageY,0!=t&&(this._viewportElement.scrollTop+=t,e.preventDefault())},c);function c(e,t,r,n,i){var o=s.call(this)||this;return o._terminal=e,o._viewportElement=t,o._scrollArea=r,o._charMeasure=n,o._dimensions=i,o.scrollBarWidth=0,o._currentRowHeight=0,o._lastRecordedBufferLength=0,o._lastRecordedViewportHeight=0,o._lastRecordedBufferHeight=0,o._lastScrollTop=0,o._wheelPartialScroll=0,o._refreshAnimationFrame=null,o._ignoreNextScrollEvent=!1,o.scrollBarWidth=o._viewportElement.offsetWidth-o._scrollArea.offsetWidth||15,o.register(a.addDisposableDomListener(o._viewportElement,"scroll",o._onScroll.bind(o))),setTimeout(function(){return o.syncScrollArea()},0),o}r.Viewport=l},{"./common/Lifecycle":42,"./ui/Lifecycle":77}],36:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./core/buffer/BufferLine");r.applyWindowsMode=function(t){return t.onLineFeed(function(){var e=t.buffer.lines.get(t.buffer.ybase+t.buffer.y-1).get(t.cols-1);t.buffer.lines.get(t.buffer.ybase+t.buffer.y).isWrapped=e[n.CHAR_DATA_CODE_INDEX]!==n.NULL_CELL_CODE&&e[n.CHAR_DATA_CODE_INDEX]!==n.WHITESPACE_CELL_CODE})}},{"./core/buffer/BufferLine":47}],37:[function(e,t,r){"use strict";function n(e){if(!e.element.parentElement)return null;var t=window.getComputedStyle(e.element.parentElement),r=parseInt(t.getPropertyValue("height")),n=Math.max(0,parseInt(t.getPropertyValue("width"))),i=window.getComputedStyle(e.element),o=r-(parseInt(i.getPropertyValue("padding-top"))+parseInt(i.getPropertyValue("padding-bottom"))),s=n-(parseInt(i.getPropertyValue("padding-right"))+parseInt(i.getPropertyValue("padding-left")))-e._core.viewport.scrollBarWidth;return{cols:Math.floor(s/e._core._renderCoordinator.dimensions.actualCellWidth),rows:Math.floor(o/e._core._renderCoordinator.dimensions.actualCellHeight)}}function i(e){var t=n(e);t&&(e.rows===t.rows&&e.cols===t.cols||(e._core._renderCoordinator.clear(),e.resize(t.cols,t.rows)))}Object.defineProperty(r,"__esModule",{value:!0}),r.proposeGeometry=n,r.fit=i,r.apply=function(e){e.prototype.proposeGeometry=function(){return n(this)},e.prototype.fit=function(){i(this)}}},{}],38:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./EventEmitter2"),i=(Object.defineProperty(o.prototype,"onDelete",{get:function(){return this.onDeleteEmitter.event},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"onInsert",{get:function(){return this.onInsertEmitter.event},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"onTrim",{get:function(){return this.onTrimEmitter.event},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"maxLength",{get:function(){return this._maxLength},set:function(e){if(this._maxLength!==e){for(var t=new Array(e),r=0;r<Math.min(e,this.length);r++)t[r]=this._array[this._getCyclicIndex(r)];this._array=t,this._maxLength=e,this._startIndex=0}},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"length",{get:function(){return this._length},set:function(e){if(e>this._length)for(var t=this._length;t<e;t++)this._array[t]=void 0;this._length=e},enumerable:!0,configurable:!0}),o.prototype.get=function(e){return this._array[this._getCyclicIndex(e)]},o.prototype.set=function(e,t){this._array[this._getCyclicIndex(e)]=t},o.prototype.push=function(e){this._array[this._getCyclicIndex(this._length)]=e,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++},o.prototype.recycle=function(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]},Object.defineProperty(o.prototype,"isFull",{get:function(){return this._length===this._maxLength},enumerable:!0,configurable:!0}),o.prototype.pop=function(){return this._array[this._getCyclicIndex(this._length---1)]},o.prototype.splice=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];if(t){for(var i=e;i<this._length-t;i++)this._array[this._getCyclicIndex(i)]=this._array[this._getCyclicIndex(i+t)];this._length-=t}for(i=this._length-1;e<=i;i--)this._array[this._getCyclicIndex(i+r.length)]=this._array[this._getCyclicIndex(i)];for(i=0;i<r.length;i++)this._array[this._getCyclicIndex(e+i)]=r[i];if(this._length+r.length>this._maxLength){var o=this._length+r.length-this._maxLength;this._startIndex+=o,this._length=this._maxLength,this.onTrimEmitter.fire(o)}else this._length+=r.length},o.prototype.trimStart=function(e){e>this._length&&(e=this._length),this._startIndex+=e,this._length-=e,this.onTrimEmitter.fire(e)},o.prototype.shiftElements=function(e,t,r){if(!(t<=0)){if(e<0||e>=this._length)throw new Error("start argument out of range");if(e+r<0)throw new Error("Cannot shift elements in list beyond index 0");if(0<r){for(var n=t-1;0<=n;n--)this.set(e+n+r,this.get(e+n));var i=e+t+r-this._length;if(0<i)for(this._length+=i;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(n=0;n<t;n++)this.set(e+n+r,this.get(e+n))}},o.prototype._getCyclicIndex=function(e){return(this._startIndex+e)%this._maxLength},o);function o(e){this._maxLength=e,this.onDeleteEmitter=new n.EventEmitter2,this.onInsertEmitter=new n.EventEmitter2,this.onTrimEmitter=new n.EventEmitter2,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}r.CircularList=i},{"./EventEmitter2":41}],39:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.clone=function e(t,r){if(void 0===r&&(r=5),"object"!=typeof t)return t;if(null===t)return null;var n=Array.isArray(t)?[]:{};for(var i in t)n[i]=r<=1?t[i]:e(t[i],r-1);return n}},{}],40:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var o,s=e("./Lifecycle"),a=(o=s.Disposable,i(l,o),l.prototype.on=function(e,t){this._events[e]=this._events[e]||[],this._events[e].push(t)},l.prototype.addDisposableListener=function(e,t){var r=this;this.on(e,t);var n=!1;return{dispose:function(){n||(r.off(e,t),n=!0)}}},l.prototype.off=function(e,t){if(this._events[e])for(var r=this._events[e],n=r.length;n--;)if(r[n]===t)return void r.splice(n,1)},l.prototype.removeAllListeners=function(e){this._events[e]&&delete this._events[e]},l.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(this._events[e])for(var n=this._events[e],i=0;i<n.length;i++)n[i].apply(this,t)},l.prototype.emitMayRemoveListeners=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(this._events[e])for(var n=this._events[e],i=n.length,o=0;o<n.length;o++)n[o].apply(this,t),o-=i-n.length,i=n.length},l.prototype.listeners=function(e){return this._events[e]||[]},l.prototype.dispose=function(){o.prototype.dispose.call(this),this._events={}},l);function l(){var e=o.call(this)||this;return e._events=e._events||{},e}r.EventEmitter=a},{"./Lifecycle":42}],41:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=(Object.defineProperty(i.prototype,"event",{get:function(){var r=this;return this._event||(this._event=function(t){return r._listeners.push(t),{dispose:function(){for(var e=0;e<r._listeners.length;e++)if(r._listeners[e]===t)return void r._listeners.splice(e,1)}}}),this._event},enumerable:!0,configurable:!0}),i.prototype.fire=function(e){for(var t=[],r=0;r<this._listeners.length;r++)t.push(this._listeners[r]);for(r=0;r<t.length;r++)t[r].call(void 0,e)},i);function i(){this._listeners=[]}r.EventEmitter2=n},{}],42:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=(i.prototype.dispose=function(){this._isDisposed=!0,this._disposables.forEach(function(e){return e.dispose()}),this._disposables.length=0},i.prototype.register=function(e){this._disposables.push(e)},i.prototype.unregister=function(e){var t=this._disposables.indexOf(e);-1!==t&&this._disposables.splice(t,1)},i);function i(){this._disposables=[],this._isDisposed=!1}r.Disposable=n},{}],43:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="undefined"==typeof navigator,i=n?"node":navigator.userAgent,o=n?"node":navigator.platform;function s(e,t){return 0<=e.indexOf(t)}r.isFirefox=!!~i.indexOf("Firefox"),r.isSafari=/^((?!chrome|android).)*safari/i.test(i),r.isMSIE=!!~i.indexOf("MSIE")||!!~i.indexOf("Trident"),r.isMac=s(["Macintosh","MacIntel","MacPPC","Mac68K"],o),r.isIpad="iPad"===o,r.isIphone="iPhone"===o,r.isMSWindows=s(["Windows","Win16","Win32","WinCE"],o),r.isLinux=0<=o.indexOf("Linux")},{}],44:[function(e,t,r){"use strict";function i(e,t,r,n){if(void 0===r&&(r=0),void 0===n&&(n=e.length),r>=e.length)return e;r=(e.length+r)%e.length,n=n>=e.length?e.length:(e.length+n)%e.length;for(var i=r;i<n;++i)e[i]=t;return e}Object.defineProperty(r,"__esModule",{value:!0}),r.fill=function(e,t,r,n){return e.fill?e.fill(t,r,n):i(e,t,r,n)},r.fillFallback=i,r.concat=function(e,t){var r=new e.constructor(e.length+t.length);return r.set(e),r.set(t,e.length),r}},{}],45:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.DEFAULT_COLOR=256},{}],46:[function(e,t,r){"use strict";var n,i;Object.defineProperty(r,"__esModule",{value:!0}),(n=r.C0||(r.C0={})).NUL="\0",n.SOH="",n.STX="",n.ETX="",n.EOT="",n.ENQ="",n.ACK="",n.BEL="",n.BS="\b",n.HT="\t",n.LF="\n",n.VT="\v",n.FF="\f",n.CR="\r",n.SO="",n.SI="",n.DLE="",n.DC1="",n.DC2="",n.DC3="",n.DC4="",n.NAK="",n.SYN="",n.ETB="",n.CAN="",n.EM="",n.SUB="",n.ESC="",n.FS="",n.GS="",n.RS="",n.US="",n.SP=" ",n.DEL="",(i=r.C1||(r.C1={})).PAD="",i.HOP="",i.BPH="",i.NBH="",i.IND="",i.NEL="",i.SSA="",i.ESA="",i.HTS="",i.HTJ="",i.VTS="",i.PLD="",i.PLU="",i.RI="",i.SS2="",i.SS3="",i.DCS="",i.PU1="",i.PU2="",i.STS="",i.CCH="",i.MW="",i.SPA="",i.EPA="",i.SOS="",i.SGCI="",i.SCI="",i.CSI="",i.ST="",i.OSC="",i.PM="",i.APC=""},{}],47:[function(e,t,s){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(s,"__esModule",{value:!0});var a=e("../input/TextDecoder"),i=e("../../common/Types");s.DEFAULT_ATTR=256|i.DEFAULT_COLOR<<9,s.CHAR_DATA_ATTR_INDEX=0,s.CHAR_DATA_CHAR_INDEX=1,s.CHAR_DATA_WIDTH_INDEX=2,s.CHAR_DATA_CODE_INDEX=3,s.NULL_CELL_CHAR="",s.NULL_CELL_WIDTH=1,s.NULL_CELL_CODE=0,s.WHITESPACE_CELL_CHAR=" ",s.WHITESPACE_CELL_WIDTH=1,s.WHITESPACE_CELL_CODE=32;var o=(l.toColorRGB=function(e){return[e>>>16&255,e>>>8&255,255&e]},l.fromColorRGB=function(e){return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},l.prototype.clone=function(){var e=new l;return e.fg=this.fg,e.bg=this.bg,e},l.prototype.isInverse=function(){return 67108864&this.fg},l.prototype.isBold=function(){return 134217728&this.fg},l.prototype.isUnderline=function(){return 268435456&this.fg},l.prototype.isBlink=function(){return 536870912&this.fg},l.prototype.isInvisible=function(){return 1073741824&this.fg},l.prototype.isItalic=function(){return 67108864&this.bg},l.prototype.isDim=function(){return 134217728&this.bg},l.prototype.getFgColorMode=function(){return 50331648&this.fg},l.prototype.getBgColorMode=function(){return 50331648&this.bg},l.prototype.isFgRGB=function(){return 50331648==(50331648&this.fg)},l.prototype.isBgRGB=function(){return 50331648==(50331648&this.bg)},l.prototype.isFgPalette=function(){return 16777216==(50331648&this.fg)||33554432==(50331648&this.fg)},l.prototype.isBgPalette=function(){return 16777216==(50331648&this.bg)||33554432==(50331648&this.bg)},l.prototype.isFgDefault=function(){return 0==(50331648&this.fg)},l.prototype.isBgDefault=function(){return 0==(50331648&this.bg)},l.prototype.getFgColor=function(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}},l.prototype.getBgColor=function(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}},l);function l(){this.fg=0,this.bg=0}s.AttributeData=o,s.DEFAULT_ATTR_DATA=Object.freeze(new o);var c,u=(r(h,c=o),h.fromCharData=function(e){var t=new h;return t.setFromCharData(e),t},h.prototype.isCombined=function(){return 2097152&this.content},h.prototype.getWidth=function(){return this.content>>22},h.prototype.getChars=function(){return 2097152&this.content?this.combinedData:2097151&this.content?a.stringFromCodePoint(2097151&this.content):""},h.prototype.getCode=function(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content},h.prototype.setFromCharData=function(e){this.fg=e[s.CHAR_DATA_ATTR_INDEX],this.bg=0;var t=!1;if(2<e[s.CHAR_DATA_CHAR_INDEX].length)t=!0;else if(2===e[s.CHAR_DATA_CHAR_INDEX].length){var r=e[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=r&&r<=56319){var n=e[s.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=n&&n<=57343?this.content=1024*(r-55296)+n-56320+65536|e[s.CHAR_DATA_WIDTH_INDEX]<<22:t=!0}else t=!0}else this.content=e[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|e[s.CHAR_DATA_WIDTH_INDEX]<<22;t&&(this.combinedData=e[s.CHAR_DATA_CHAR_INDEX],this.content=2097152|e[s.CHAR_DATA_WIDTH_INDEX]<<22)},h.prototype.getAsCharData=function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]},h);function h(){var e=null!==c&&c.apply(this,arguments)||this;return e.content=0,e.fg=0,e.bg=0,e.combinedData="",e}s.CellData=u;var f=(d.prototype.get=function(e){var t=this._data[3*e+0],r=2097151&t;return[this._data[3*e+1],2097152&t?this._combined[e]:r?a.stringFromCodePoint(r):"",t>>22,2097152&t?this._combined[e].charCodeAt(this._combined[e].length-1):r]},d.prototype.set=function(e,t){this._data[3*e+1]=t[s.CHAR_DATA_ATTR_INDEX],1<t[s.CHAR_DATA_CHAR_INDEX].length?(this._combined[e]=t[1],this._data[3*e+0]=2097152|e|t[s.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*e+0]=t[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|t[s.CHAR_DATA_WIDTH_INDEX]<<22},d.prototype.getWidth=function(e){return this._data[3*e+0]>>22},d.prototype.hasWidth=function(e){return 12582912&this._data[3*e+0]},d.prototype.getFg=function(e){return this._data[3*e+1]},d.prototype.getBg=function(e){return this._data[3*e+2]},d.prototype.hasContent=function(e){return 4194303&this._data[3*e+0]},d.prototype.getCodePoint=function(e){var t=this._data[3*e+0];return 2097152&t?this._combined[e].charCodeAt(this._combined[e].length-1):2097151&t},d.prototype.isCombined=function(e){return 2097152&this._data[3*e+0]},d.prototype.getString=function(e){var t=this._data[3*e+0];return 2097152&t?this._combined[e]:2097151&t?a.stringFromCodePoint(2097151&t):""},d.prototype.loadCell=function(e,t){var r=3*e;return t.content=this._data[0+r],t.fg=this._data[1+r],t.bg=this._data[2+r],2097152&t.content&&(t.combinedData=this._combined[e]),t},d.prototype.setCell=function(e,t){2097152&t.content&&(this._combined[e]=t.combinedData),this._data[3*e+0]=t.content,this._data[3*e+1]=t.fg,this._data[3*e+2]=t.bg},d.prototype.setCellFromCodePoint=function(e,t,r,n,i){this._data[3*e+0]=t|r<<22,this._data[3*e+1]=n,this._data[3*e+2]=i},d.prototype.addCodepointToCell=function(e,t){var r=this._data[3*e+0];2097152&r?this._combined[e]+=a.stringFromCodePoint(t):(2097151&r?(this._combined[e]=a.stringFromCodePoint(2097151&r)+a.stringFromCodePoint(t),r&=-2097152,r|=2097152):r=t|1<<22,this._data[3*e+0]=r)},d.prototype.insertCells=function(e,t,r){if(e%=this.length,t<this.length-e){for(var n=new u,i=this.length-e-t-1;0<=i;--i)this.setCell(e+t+i,this.loadCell(e+i,n));for(i=0;i<t;++i)this.setCell(e+i,r)}else for(i=e;i<this.length;++i)this.setCell(i,r)},d.prototype.deleteCells=function(e,t,r){if(e%=this.length,t<this.length-e){for(var n=new u,i=0;i<this.length-e-t;++i)this.setCell(e+i,this.loadCell(e+t+i,n));for(i=this.length-t;i<this.length;++i)this.setCell(i,r)}else for(i=e;i<this.length;++i)this.setCell(i,r)},d.prototype.replaceCells=function(e,t,r){for(;e<t&&e<this.length;)this.setCell(e++,r)},d.prototype.resize=function(e,t){if(e!==this.length){if(e>this.length){var r=new Uint32Array(3*e);this.length&&(3*e<this._data.length?r.set(this._data.subarray(0,3*e)):r.set(this._data)),this._data=r;for(var n=this.length;n<e;++n)this.setCell(n,t)}else if(e){(r=new Uint32Array(3*e)).set(this._data.subarray(0,3*e)),this._data=r;var i=Object.keys(this._combined);for(n=0;n<i.length;n++){var o=parseInt(i[n],10);e<=o&&delete this._combined[o]}}else this._data=new Uint32Array(0),this._combined={};this.length=e}},d.prototype.fill=function(e){this._combined={};for(var t=0;t<this.length;++t)this.setCell(t,e)},d.prototype.copyFrom=function(e){for(var t in this.length!==e.length?this._data=new Uint32Array(e._data):this._data.set(e._data),this.length=e.length,this._combined={},e._combined)this._combined[t]=e._combined[t];this.isWrapped=e.isWrapped},d.prototype.clone=function(){var e=new d(0);for(var t in e._data=new Uint32Array(this._data),e.length=this.length,this._combined)e._combined[t]=this._combined[t];return e.isWrapped=this.isWrapped,e},d.prototype.getTrimmedLength=function(){for(var e=this.length-1;0<=e;--e)if(4194303&this._data[3*e+0])return e+(this._data[3*e+0]>>22);return 0},d.prototype.copyCellsFrom=function(e,t,r,n,i){var o=e._data;if(i)for(var s=n-1;0<=s;s--)for(var a=0;a<3;a++)this._data[3*(r+s)+a]=o[3*(t+s)+a];else for(s=0;s<n;s++)for(a=0;a<3;a++)this._data[3*(r+s)+a]=o[3*(t+s)+a];var l=Object.keys(e._combined);for(a=0;a<l.length;a++){var c=parseInt(l[a],10);t<=c&&(this._combined[c-t+r]=e._combined[c])}},d.prototype.translateToString=function(e,t,r){void 0===e&&(e=!1),void 0===t&&(t=0),void 0===r&&(r=this.length),e&&(r=Math.min(r,this.getTrimmedLength()));for(var n="";t<r;){var i=this._data[3*t+0],o=2097151&i;n+=2097152&i?this._combined[t]:o?a.stringFromCodePoint(o):s.WHITESPACE_CELL_CHAR,t+=i>>22||1}return n},d);function d(e,t,r){void 0===r&&(r=!1),this.isWrapped=r,this._combined={},this._data=new Uint32Array(3*e);for(var n=t||u.fromCharData([0,s.NULL_CELL_CHAR,s.NULL_CELL_WIDTH,s.NULL_CELL_CODE]),i=0;i<e;++i)this.setCell(i,n);this.length=e}s.BufferLine=f},{"../../common/Types":45,"../input/TextDecoder":52}],48:[function(e,t,r){"use strict";function b(e,t,r){if(t===e.length-1)return e[t].getTrimmedLength();var n=!e[t].hasContent(r-1)&&1===e[t].getWidth(r-1),i=2===e[t+1].getWidth(0);return n&&i?r-1:r}Object.defineProperty(r,"__esModule",{value:!0}),r.reflowLargerGetLinesToRemove=function(e,t,r,n,i){for(var o=[],s=0;s<e.length-1;s++){var a=s,l=e.get(++a);if(l.isWrapped){for(var c=[e.get(s)];a<e.length&&l.isWrapped;)c.push(l),l=e.get(++a);if(s<=n&&n<a)s+=c.length-1;else{for(var u=0,h=b(c,u,t),f=1,d=0;f<c.length;){var p=b(c,f,t),_=p-d,m=r-h,y=Math.min(_,m);c[u].copyCellsFrom(c[f],d,h,y,!1),(h+=y)===r&&(u++,h=0),(d+=y)===p&&(f++,d=0),0===h&&0!==u&&2===c[u-1].getWidth(r-1)&&(c[u].copyCellsFrom(c[u-1],r-1,h++,1,!1),c[u-1].setCell(r-1,i))}c[u].replaceCells(h,r,i);for(var g=0,v=c.length-1;0<v&&(u<v||0===c[v].getTrimmedLength());v--)g++;0<g&&(o.push(s+c.length-g),o.push(g)),s+=c.length-1}}}return o},r.reflowLargerCreateNewLayout=function(e,t){for(var r=[],n=0,i=t[n],o=0,s=0;s<e.length;s++)if(i===s){var a=t[++n];e.onDeleteEmitter.fire({index:s-o,amount:a}),s+=a-1,o+=a,i=t[++n]}else r.push(s);return{layout:r,countRemoved:o}},r.reflowLargerApplyNewLayout=function(e,t){for(var r=[],n=0;n<t.length;n++)r.push(e.get(t[n]));for(n=0;n<r.length;n++)e.set(n,r[n]);e.length=t.length},r.reflowSmallerGetNewLineLengths=function(r,n,e){for(var t=[],i=r.map(function(e,t){return b(r,t,n)}).reduce(function(e,t){return e+t}),o=0,s=0,a=0;a<i;){if(i-a<e){t.push(i-a);break}o+=e;var l=b(r,s,n);l<o&&(o-=l,s++);var c=2===r[s].getWidth(o-1);c&&o--;var u=c?e-1:e;t.push(u),a+=u}return t},r.getWrappedLineTrimmedLength=b},{}],49:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var o,s=e("../../common/EventEmitter2"),a=e("../../common/Lifecycle"),l=(o=a.Disposable,i(c,o),Object.defineProperty(c.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"onDispose",{get:function(){return this._onDispose.event},enumerable:!0,configurable:!0}),c.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._onDispose.fire())},c._nextId=1,c);function c(e){var t=o.call(this)||this;return t.line=e,t._id=c._nextId++,t.isDisposed=!1,t._onDispose=new s.EventEmitter2,t}r.Marker=l},{"../../common/EventEmitter2":41,"../../common/Lifecycle":42}],50:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CHARSETS={},r.DEFAULT_CHARSET=r.CHARSETS.B,r.CHARSETS[0]={"`":"",a:"",b:"\t",c:"\f",d:"\r",e:"\n",f:"",g:"",h:"",i:"\v",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""},r.CHARSETS.A={"#":""},r.CHARSETS.B=null,r.CHARSETS[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""},r.CHARSETS.C=r.CHARSETS[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},r.CHARSETS.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},r.CHARSETS.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},r.CHARSETS.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},r.CHARSETS.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""},r.CHARSETS.E=r.CHARSETS[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},r.CHARSETS.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""},r.CHARSETS.H=r.CHARSETS[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},r.CHARSETS["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""}},{}],51:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var c=e("../../common/data/EscapeSequences"),u={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};r.evaluateKeyboardEvent=function(e,t,r,n){var i={type:0,cancel:!1,key:void 0},o=(e.shiftKey?1:0)|(e.altKey?2:0)|(e.ctrlKey?4:0)|(e.metaKey?8:0);switch(e.keyCode){case 0:"UIKeyInputUpArrow"===e.key?i.key=t?c.C0.ESC+"OA":c.C0.ESC+"[A":"UIKeyInputLeftArrow"===e.key?i.key=t?c.C0.ESC+"OD":c.C0.ESC+"[D":"UIKeyInputRightArrow"===e.key?i.key=t?c.C0.ESC+"OC":c.C0.ESC+"[C":"UIKeyInputDownArrow"===e.key&&(i.key=t?c.C0.ESC+"OB":c.C0.ESC+"[B");break;case 8:if(e.shiftKey){i.key=c.C0.BS;break}if(e.altKey){i.key=c.C0.ESC+c.C0.DEL;break}i.key=c.C0.DEL;break;case 9:if(e.shiftKey){i.key=c.C0.ESC+"[Z";break}i.key=c.C0.HT,i.cancel=!0;break;case 13:i.key=c.C0.CR,i.cancel=!0;break;case 27:i.key=c.C0.ESC,i.cancel=!0;break;case 37:o?(i.key=c.C0.ESC+"[1;"+(1+o)+"D",i.key===c.C0.ESC+"[1;3D"&&(i.key=r?c.C0.ESC+"b":c.C0.ESC+"[1;5D")):i.key=t?c.C0.ESC+"OD":c.C0.ESC+"[D";break;case 39:o?(i.key=c.C0.ESC+"[1;"+(1+o)+"C",i.key===c.C0.ESC+"[1;3C"&&(i.key=r?c.C0.ESC+"f":c.C0.ESC+"[1;5C")):i.key=t?c.C0.ESC+"OC":c.C0.ESC+"[C";break;case 38:o?(i.key=c.C0.ESC+"[1;"+(1+o)+"A",i.key===c.C0.ESC+"[1;3A"&&(i.key=c.C0.ESC+"[1;5A")):i.key=t?c.C0.ESC+"OA":c.C0.ESC+"[A";break;case 40:o?(i.key=c.C0.ESC+"[1;"+(1+o)+"B",i.key===c.C0.ESC+"[1;3B"&&(i.key=c.C0.ESC+"[1;5B")):i.key=t?c.C0.ESC+"OB":c.C0.ESC+"[B";break;case 45:e.shiftKey||e.ctrlKey||(i.key=c.C0.ESC+"[2~");break;case 46:i.key=o?c.C0.ESC+"[3;"+(1+o)+"~":c.C0.ESC+"[3~";break;case 36:i.key=o?c.C0.ESC+"[1;"+(1+o)+"H":t?c.C0.ESC+"OH":c.C0.ESC+"[H";break;case 35:i.key=o?c.C0.ESC+"[1;"+(1+o)+"F":t?c.C0.ESC+"OF":c.C0.ESC+"[F";break;case 33:e.shiftKey?i.type=2:i.key=c.C0.ESC+"[5~";break;case 34:e.shiftKey?i.type=3:i.key=c.C0.ESC+"[6~";break;case 112:i.key=o?c.C0.ESC+"[1;"+(1+o)+"P":c.C0.ESC+"OP";break;case 113:i.key=o?c.C0.ESC+"[1;"+(1+o)+"Q":c.C0.ESC+"OQ";break;case 114:i.key=o?c.C0.ESC+"[1;"+(1+o)+"R":c.C0.ESC+"OR";break;case 115:i.key=o?c.C0.ESC+"[1;"+(1+o)+"S":c.C0.ESC+"OS";break;case 116:i.key=o?c.C0.ESC+"[15;"+(1+o)+"~":c.C0.ESC+"[15~";break;case 117:i.key=o?c.C0.ESC+"[17;"+(1+o)+"~":c.C0.ESC+"[17~";break;case 118:i.key=o?c.C0.ESC+"[18;"+(1+o)+"~":c.C0.ESC+"[18~";break;case 119:i.key=o?c.C0.ESC+"[19;"+(1+o)+"~":c.C0.ESC+"[19~";break;case 120:i.key=o?c.C0.ESC+"[20;"+(1+o)+"~":c.C0.ESC+"[20~";break;case 121:i.key=o?c.C0.ESC+"[21;"+(1+o)+"~":c.C0.ESC+"[21~";break;case 122:i.key=o?c.C0.ESC+"[23;"+(1+o)+"~":c.C0.ESC+"[23~";break;case 123:i.key=o?c.C0.ESC+"[24;"+(1+o)+"~":c.C0.ESC+"[24~";break;default:if(!e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)if(r&&!n||!e.altKey||e.metaKey)r&&!e.altKey&&!e.ctrlKey&&e.metaKey?65===e.keyCode&&(i.type=1):e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&48<=e.keyCode&&1===e.key.length?i.key=e.key:e.key&&e.ctrlKey&&"_"===e.key&&(i.key=c.C0.US);else{var s=u[e.keyCode],a=s&&s[e.shiftKey?1:0];if(a)i.key=c.C0.ESC+a;else if(65<=e.keyCode&&e.keyCode<=90){var l=e.ctrlKey?e.keyCode-64:e.keyCode+32;i.key=c.C0.ESC+String.fromCharCode(l)}}else 65<=e.keyCode&&e.keyCode<=90?i.key=String.fromCharCode(e.keyCode-64):32===e.keyCode?i.key=String.fromCharCode(0):51<=e.keyCode&&e.keyCode<=55?i.key=String.fromCharCode(e.keyCode-51+27):56===e.keyCode?i.key=String.fromCharCode(127):219===e.keyCode?i.key=String.fromCharCode(27):220===e.keyCode?i.key=String.fromCharCode(28):221===e.keyCode&&(i.key=String.fromCharCode(29))}return i}},{"../../common/data/EscapeSequences":46}],52:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.stringFromCodePoint=function(e){return 65535<e?(e-=65536,String.fromCharCode(55296+(e>>10))+String.fromCharCode(e%1024+56320)):String.fromCharCode(e)},r.utf32ToString=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=e.length);for(var n="",i=t;i<r;++i){var o=e[i];65535<o?(o-=65536,n+=String.fromCharCode(55296+(o>>10))+String.fromCharCode(o%1024+56320)):n+=String.fromCharCode(o)}return n};var n=(i.prototype.clear=function(){this._interim=0},i.prototype.decode=function(e,t){var r=e.length;if(!r)return 0;var n=0,i=0;this._interim&&(56320<=(a=e.charCodeAt(i++))&&a<=57343?t[n++]=1024*(this._interim-55296)+a-56320+65536:(t[n++]=this._interim,t[n++]=a),this._interim=0);for(var o=i;o<r;++o){var s=e.charCodeAt(o);if(55296<=s&&s<=56319){if(++o>=r)return this._interim=s,n;var a;56320<=(a=e.charCodeAt(o))&&a<=57343?t[n++]=1024*(s-55296)+a-56320+65536:(t[n++]=s,t[n++]=a)}else t[n++]=s}return n},i);function i(){this._interim=0}r.StringToUtf32=n;var o=(s.prototype.clear=function(){this.interim.fill(0)},s.prototype.decode=function(e,t){var r=e.length;if(!r)return 0;var n,i,o,s,a=0,l=0,c=0;if(this.interim[0]){var u=!1,h=this.interim[0];h&=192==(224&h)?31:224==(240&h)?15:7;for(var f=0,d=void 0;(d=63&this.interim[++f])&&f<4;)h<<=6,h|=d;for(var p=192==(224&this.interim[0])?2:224==(240&this.interim[0])?3:4,_=p-f;c<_;){if(r<=c)return 0;if(128!=(192&(d=e[c++]))){c--,u=!0;break}h<<=6,h|=63&(this.interim[f++]=d)}u||(2==p?h<128?c--:t[a++]=h:3==p?h<2048||55296<=h&&h<=57343||(t[a++]=h):l<65536||1114111<l||(t[a++]=h)),this.interim.fill(0)}for(var m=r-4,y=c;y<r;){for(;!(!(y<m)||128&(n=e[y])||128&(i=e[y+1])||128&(o=e[y+2])||128&(s=e[y+3]));)t[a++]=n,t[a++]=i,t[a++]=o,t[a++]=s,y+=4;if((n=e[y++])<128)t[a++]=n;else if(192==(224&n)){if(r<=y)return this.interim[0]=n,a;if(128!=(192&(i=e[y++]))){y--;continue}if((l=(31&n)<<6|63&i)<128){y--;continue}t[a++]=l}else if(224==(240&n)){if(r<=y)return this.interim[0]=n,a;if(128!=(192&(i=e[y++]))){y--;continue}if(r<=y)return this.interim[0]=n,this.interim[1]=i,a;if(128!=(192&(o=e[y++]))){y--;continue}if((l=(15&n)<<12|(63&i)<<6|63&o)<2048||55296<=l&&l<=57343)continue;t[a++]=l}else if(240==(248&n)){if(r<=y)return this.interim[0]=n,a;if(128!=(192&(i=e[y++]))){y--;continue}if(r<=y)return this.interim[0]=n,this.interim[1]=i,a;if(128!=(192&(o=e[y++]))){y--;continue}if(r<=y)return this.interim[0]=n,this.interim[1]=i,this.interim[2]=o,a;if(128!=(192&(s=e[y++]))){y--;continue}if((l=(7&n)<<18|(63&i)<<12|(63&o)<<6|63&s)<65536||1114111<l)continue;t[a++]=l}}return a},s);function s(){this.interim=new Uint8Array(3)}r.Utf8ToUtf32=o},{}],53:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("../common/data/EscapeSequences"),i=(o.prototype.move=function(){this._mouseEvent.altKey&&void 0!==this._endCol&&void 0!==this._endRow&&this._terminal.handler(this._arrowSequences())},o.prototype._arrowSequences=function(){return this._terminal.buffer.hasScrollback?this._moveHorizontallyOnly():this._resetStartingRow()+this._moveToRequestedRow()+this._moveToRequestedCol()},o.prototype._resetStartingRow=function(){return 0===this._moveToRequestedRow().length?"":s(this._bufferLine(this._startCol,this._startRow,this._startCol,this._startRow-this._wrappedRowsForRow(this._startRow),!1).length,this._sequence("D"))},o.prototype._moveToRequestedRow=function(){var e=this._startRow-this._wrappedRowsForRow(this._startRow),t=this._endRow-this._wrappedRowsForRow(this._endRow);return s(Math.abs(e-t)-this._wrappedRowsCount(),this._sequence(this._verticalDirection()))},o.prototype._moveToRequestedCol=function(){var e;e=0<this._moveToRequestedRow().length?this._endRow-this._wrappedRowsForRow(this._endRow):this._startRow;var t=this._endRow,r=this._horizontalDirection();return s(this._bufferLine(this._startCol,e,this._endCol,t,"C"===r).length,this._sequence(r))},o.prototype._moveHorizontallyOnly=function(){var e=this._horizontalDirection();return s(Math.abs(this._startCol-this._endCol),this._sequence(e))},o.prototype._wrappedRowsCount=function(){for(var e=0,t=this._startRow-this._wrappedRowsForRow(this._startRow),r=this._endRow-this._wrappedRowsForRow(this._endRow),n=0;n<Math.abs(t-r);n++){var i="A"===this._verticalDirection()?-1:1;this._lines.get(t+i*n).isWrapped&&e++}return e},o.prototype._wrappedRowsForRow=function(e){for(var t=0,r=this._lines.get(e).isWrapped;r&&0<=e&&e<this._terminal.rows;)t++,e--,r=this._lines.get(e).isWrapped;return t},o.prototype._horizontalDirection=function(){var e;return e=0<this._moveToRequestedRow().length?this._endRow-this._wrappedRowsForRow(this._endRow):this._startRow,this._startCol<this._endCol&&e<=this._endRow||this._startCol>=this._endCol&&e<this._endRow?"C":"D"},o.prototype._verticalDirection=function(){return this._startRow>this._endRow?"A":"B"},o.prototype._bufferLine=function(e,t,r,n,i){for(var o=e,s=t,a="";o!==r||s!==n;)o+=i?1:-1,i&&o>this._terminal.cols-1?(a+=this._terminal.buffer.translateBufferLineToString(s,!1,e,o),e=o=0,s++):!i&&o<0&&(a+=this._terminal.buffer.translateBufferLineToString(s,!1,0,e+1),e=o=this._terminal.cols-1,s--);return a+this._terminal.buffer.translateBufferLineToString(s,!1,e,o)},o.prototype._sequence=function(e){var t=this._terminal.applicationCursor?"O":"[";return n.C0.ESC+t+e},o);function o(e,t){var r;this._mouseEvent=e,this._terminal=t,this._lines=this._terminal.buffer.lines,this._startCol=this._terminal.buffer.x,this._startRow=this._terminal.buffer.y;var n=this._terminal.mouseHelper.getCoords(this._mouseEvent,this._terminal.element,this._terminal.charMeasure,this._terminal.cols,this._terminal.rows,!1);n&&(r=n.map(function(e){return e-1}),this._endCol=r[0],this._endRow=r[1])}function s(e,t){e=Math.floor(e);for(var r="",n=0;n<e;n++)r+=t;return r}r.AltClickHandler=i},{"../common/data/EscapeSequences":46}],54:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=(i.prototype.dispose=function(){for(var e=this._addons.length-1;0<=e;e--)this._addons[e].instance.dispose()},i.prototype.loadAddon=function(e,t){var r=this,n={instance:t,dispose:t.dispose,isDisposed:!1};this._addons.push(n),t.dispose=function(){return r._wrappedAddonDispose(n)},t.activate(e)},i.prototype._wrappedAddonDispose=function(e){if(!e.isDisposed){for(var t=-1,r=0;r<this._addons.length;r++)if(this._addons[r]===e){t=r;break}if(-1===t)throw new Error("Could not dispose an addon that has not been loaded");e.isDisposed=!0,e.dispose.apply(e.instance),this._addons.splice(t,1)}},i);function i(){this._addons=[]}r.AddonManager=n},{}],55:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("../Terminal"),i=e("../Strings"),o=e("./AddonManager"),s=(Object.defineProperty(a.prototype,"onCursorMove",{get:function(){return this._core.onCursorMove},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onLineFeed",{get:function(){return this._core.onLineFeed},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onSelectionChange",{get:function(){return this._core.onSelectionChange},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onData",{get:function(){return this._core.onData},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onTitleChange",{get:function(){return this._core.onTitleChange},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onScroll",{get:function(){return this._core.onScroll},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onKey",{get:function(){return this._core.onKey},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onRender",{get:function(){return this._core.onRender},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onResize",{get:function(){return this._core.onResize},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"element",{get:function(){return this._core.element},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"textarea",{get:function(){return this._core.textarea},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"rows",{get:function(){return this._core.rows},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"cols",{get:function(){return this._core.cols},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"buffer",{get:function(){return new l(this._core.buffer)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"markers",{get:function(){return this._core.markers},enumerable:!0,configurable:!0}),a.prototype.blur=function(){this._core.blur()},a.prototype.focus=function(){this._core.focus()},a.prototype.on=function(e,t){this._core.on(e,t)},a.prototype.off=function(e,t){this._core.off(e,t)},a.prototype.emit=function(e,t){this._core.emit(e,t)},a.prototype.addDisposableListener=function(e,t){return this._core.addDisposableListener(e,t)},a.prototype.resize=function(e,t){this._core.resize(e,t)},a.prototype.writeln=function(e){this._core.writeln(e)},a.prototype.open=function(e){this._core.open(e)},a.prototype.attachCustomKeyEventHandler=function(e){this._core.attachCustomKeyEventHandler(e)},a.prototype.addCsiHandler=function(e,t){return this._core.addCsiHandler(e,t)},a.prototype.addOscHandler=function(e,t){return this._core.addOscHandler(e,t)},a.prototype.registerLinkMatcher=function(e,t,r){return this._core.registerLinkMatcher(e,t,r)},a.prototype.deregisterLinkMatcher=function(e){this._core.deregisterLinkMatcher(e)},a.prototype.registerCharacterJoiner=function(e){return this._core.registerCharacterJoiner(e)},a.prototype.deregisterCharacterJoiner=function(e){this._core.deregisterCharacterJoiner(e)},a.prototype.addMarker=function(e){return this._core.addMarker(e)},a.prototype.hasSelection=function(){return this._core.hasSelection()},a.prototype.select=function(e,t,r){this._core.select(e,t,r)},a.prototype.getSelection=function(){return this._core.getSelection()},a.prototype.getSelectionPosition=function(){return this._core.getSelectionPosition()},a.prototype.clearSelection=function(){this._core.clearSelection()},a.prototype.selectAll=function(){this._core.selectAll()},a.prototype.selectLines=function(e,t){this._core.selectLines(e,t)},a.prototype.dispose=function(){this._addonManager.dispose(),this._core.dispose()},a.prototype.destroy=function(){this._core.destroy()},a.prototype.scrollLines=function(e){this._core.scrollLines(e)},a.prototype.scrollPages=function(e){this._core.scrollPages(e)},a.prototype.scrollToTop=function(){this._core.scrollToTop()},a.prototype.scrollToBottom=function(){this._core.scrollToBottom()},a.prototype.scrollToLine=function(e){this._core.scrollToLine(e)},a.prototype.clear=function(){this._core.clear()},a.prototype.write=function(e){this._core.write(e)},a.prototype.writeUtf8=function(e){this._core.writeUtf8(e)},a.prototype.getOption=function(e){return this._core.getOption(e)},a.prototype.setOption=function(e,t){this._core.setOption(e,t)},a.prototype.refresh=function(e,t){this._core.refresh(e,t)},a.prototype.reset=function(){this._core.reset()},a.applyAddon=function(e){e.apply(a)},a.prototype.loadAddon=function(e){return this._addonManager.loadAddon(this,e)},Object.defineProperty(a,"strings",{get:function(){return i},enumerable:!0,configurable:!0}),a);function a(e){this._core=new n.Terminal(e),this._addonManager=new o.AddonManager}r.Terminal=s;var l=(Object.defineProperty(c.prototype,"cursorY",{get:function(){return this._buffer.y},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"cursorX",{get:function(){return this._buffer.x},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"viewportY",{get:function(){return this._buffer.ydisp},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"baseY",{get:function(){return this._buffer.ybase},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"length",{get:function(){return this._buffer.lines.length},enumerable:!0,configurable:!0}),c.prototype.getLine=function(e){var t=this._buffer.lines.get(e);if(t)return new u(t)},c);function c(e){this._buffer=e}var u=(Object.defineProperty(h.prototype,"isWrapped",{get:function(){return this._line.isWrapped},enumerable:!0,configurable:!0}),h.prototype.getCell=function(e){if(!(e<0||e>=this._line.length))return new f(this._line,e)},h.prototype.translateToString=function(e,t,r){return this._line.translateToString(e,t,r)},h);function h(e){this._line=e}var f=(Object.defineProperty(d.prototype,"char",{get:function(){return this._line.getString(this._x)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"width",{get:function(){return this._line.getWidth(this._x)},enumerable:!0,configurable:!0}),d);function d(e,t){this._line=e,this._x=t}},{"../Strings":33,"../Terminal":34,"./AddonManager":54}],56:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s=e("../common/Types"),a=e("./atlas/Types"),n=e("./atlas/CharAtlasCache"),l=e("../core/buffer/BufferLine"),i=(o.prototype.dispose=function(){this._container.removeChild(this._canvas),this._charAtlas&&this._charAtlas.dispose()},o.prototype._initCanvas=function(){this._ctx=this._canvas.getContext("2d",{alpha:this._alpha}),this._alpha||this.clearAll()},o.prototype.onOptionsChanged=function(e){},o.prototype.onBlur=function(e){},o.prototype.onFocus=function(e){},o.prototype.onCursorMove=function(e){},o.prototype.onGridChanged=function(e,t,r){},o.prototype.onSelectionChanged=function(e,t,r,n){void 0===n&&(n=!1)},o.prototype.setColors=function(e,t){this._refreshCharAtlas(e,t)},o.prototype.setTransparency=function(e,t){if(t!==this._alpha){var r=this._canvas;this._alpha=t,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,r),this._refreshCharAtlas(e,this._colors),this.onGridChanged(e,0,e.rows-1)}},o.prototype._refreshCharAtlas=function(e,t){this._scaledCharWidth<=0&&this._scaledCharHeight<=0||(this._charAtlas=n.acquireCharAtlas(e,t,this._scaledCharWidth,this._scaledCharHeight),this._charAtlas.warmUp())},o.prototype.resize=function(e,t){this._scaledCellWidth=t.scaledCellWidth,this._scaledCellHeight=t.scaledCellHeight,this._scaledCharWidth=t.scaledCharWidth,this._scaledCharHeight=t.scaledCharHeight,this._scaledCharLeft=t.scaledCharLeft,this._scaledCharTop=t.scaledCharTop,this._canvas.width=t.scaledCanvasWidth,this._canvas.height=t.scaledCanvasHeight,this._canvas.style.width=t.canvasWidth+"px",this._canvas.style.height=t.canvasHeight+"px",this._alpha||this.clearAll(),this._refreshCharAtlas(e,this._colors)},o.prototype.fillCells=function(e,t,r,n){this._ctx.fillRect(e*this._scaledCellWidth,t*this._scaledCellHeight,r*this._scaledCellWidth,n*this._scaledCellHeight)},o.prototype.fillBottomLineAtCells=function(e,t,r){void 0===r&&(r=1),this._ctx.fillRect(e*this._scaledCellWidth,(t+1)*this._scaledCellHeight-window.devicePixelRatio-1,r*this._scaledCellWidth,window.devicePixelRatio)},o.prototype.fillLeftLineAtCell=function(e,t){this._ctx.fillRect(e*this._scaledCellWidth,t*this._scaledCellHeight,window.devicePixelRatio,this._scaledCellHeight)},o.prototype.strokeRectAtCell=function(e,t,r,n){this._ctx.lineWidth=window.devicePixelRatio,this._ctx.strokeRect(e*this._scaledCellWidth+window.devicePixelRatio/2,t*this._scaledCellHeight+window.devicePixelRatio/2,r*this._scaledCellWidth-window.devicePixelRatio,n*this._scaledCellHeight-window.devicePixelRatio)},o.prototype.clearAll=function(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))},o.prototype.clearCells=function(e,t,r,n){this._alpha?this._ctx.clearRect(e*this._scaledCellWidth,t*this._scaledCellHeight,r*this._scaledCellWidth,n*this._scaledCellHeight):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(e*this._scaledCellWidth,t*this._scaledCellHeight,r*this._scaledCellWidth,n*this._scaledCellHeight))},o.prototype.fillCharTrueColor=function(e,t,r,n){this._ctx.font=this._getFont(e,!1,!1),this._ctx.textBaseline="middle",this._clipRow(e,n),this._ctx.fillText(t.getChars(),r*this._scaledCellWidth+this._scaledCharLeft,n*this._scaledCellHeight+this._scaledCharTop+this._scaledCharHeight/2)},o.prototype.drawChars=function(e,t,r,n){var i,o;t.isFgRGB()||t.isBgRGB()?this._drawUncachedChars(e,t,r,n):(t.isInverse()?(i=t.isBgDefault()?a.INVERTED_DEFAULT_COLOR:t.getBgColor(),o=t.isFgDefault()?a.INVERTED_DEFAULT_COLOR:t.getFgColor()):(o=t.isBgDefault()?s.DEFAULT_COLOR:t.getBgColor(),i=t.isFgDefault()?s.DEFAULT_COLOR:t.getFgColor()),i+=e.options.drawBoldTextInBrightColors&&t.isBold()&&i<8&&i!==a.INVERTED_DEFAULT_COLOR?8:0,this._currentGlyphIdentifier.chars=t.getChars()||l.WHITESPACE_CELL_CHAR,this._currentGlyphIdentifier.code=t.getCode()||l.WHITESPACE_CELL_CODE,this._currentGlyphIdentifier.bg=o,this._currentGlyphIdentifier.fg=i,this._currentGlyphIdentifier.bold=t.isBold()&&e.options.enableBold,this._currentGlyphIdentifier.dim=!!t.isDim(),this._currentGlyphIdentifier.italic=!!t.isItalic(),this._charAtlas&&this._charAtlas.draw(this._ctx,this._currentGlyphIdentifier,r*this._scaledCellWidth+this._scaledCharLeft,n*this._scaledCellHeight+this._scaledCharTop)||this._drawUncachedChars(e,t,r,n))},o.prototype._drawUncachedChars=function(e,t,r,n){if(this._ctx.save(),this._ctx.font=this._getFont(e,t.isBold()&&e.options.enableBold,!!t.isItalic()),this._ctx.textBaseline="middle",t.isInverse())t.isBgDefault()?this._ctx.fillStyle=this._colors.background.css:t.isBgRGB()?this._ctx.fillStyle="rgb("+l.AttributeData.toColorRGB(t.getBgColor()).join(",")+")":this._ctx.fillStyle=this._colors.ansi[t.getBgColor()].css;else if(t.isFgDefault())this._ctx.fillStyle=this._colors.foreground.css;else if(t.isFgRGB())this._ctx.fillStyle="rgb("+l.AttributeData.toColorRGB(t.getFgColor()).join(",")+")";else{var i=t.getFgColor();e.options.drawBoldTextInBrightColors&&t.isBold()&&i<8&&(i+=8),this._ctx.fillStyle=this._colors.ansi[i].css}this._clipRow(e,n),t.isDim()&&(this._ctx.globalAlpha=a.DIM_OPACITY),this._ctx.fillText(t.getChars(),r*this._scaledCellWidth+this._scaledCharLeft,n*this._scaledCellHeight+this._scaledCharTop+this._scaledCharHeight/2),this._ctx.restore()},o.prototype._clipRow=function(e,t){this._ctx.beginPath(),this._ctx.rect(0,t*this._scaledCellHeight,e.cols*this._scaledCellWidth,this._scaledCellHeight),this._ctx.clip()},o.prototype._getFont=function(e,t,r){return(r?"italic":"")+" "+(t?e.options.fontWeightBold:e.options.fontWeight)+" "+e.options.fontSize*window.devicePixelRatio+"px "+e.options.fontFamily},o);function o(e,t,r,n,i){this._container=e,this._alpha=n,this._colors=i,this._scaledCharWidth=0,this._scaledCharHeight=0,this._scaledCellWidth=0,this._scaledCellHeight=0,this._scaledCharLeft=0,this._scaledCharTop=0,this._currentGlyphIdentifier={chars:"",code:0,bg:0,fg:0,bold:!1,dim:!1,italic:!1},this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-"+t+"-layer"),this._canvas.style.zIndex=r.toString(),this._initCanvas(),this._container.appendChild(this._canvas)}r.BaseRenderLayer=i},{"../common/Types":45,"../core/buffer/BufferLine":47,"./atlas/CharAtlasCache":66,"./atlas/Types":73}],57:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var o,f=e("../core/buffer/BufferLine"),s=(o=f.AttributeData,i(a,o),a.prototype.isCombined=function(){return 2097152},a.prototype.getWidth=function(){return this._width},a.prototype.getChars=function(){return this.combinedData},a.prototype.getCode=function(){return 2097151},a.prototype.setFromCharData=function(e){throw new Error("not implemented")},a.prototype.getAsCharData=function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]},a);function a(e,t,r){var n=o.call(this)||this;return n.content=0,n.combinedData="",n.fg=e.fg,n.bg=e.bg,n.combinedData=t,n._width=r,n}r.JoinedCellData=s;var l=(u.prototype.registerCharacterJoiner=function(e){var t={id:this._nextCharacterJoinerId++,handler:e};return this._characterJoiners.push(t),t.id},u.prototype.deregisterCharacterJoiner=function(e){for(var t=0;t<this._characterJoiners.length;t++)if(this._characterJoiners[t].id===e)return this._characterJoiners.splice(t,1),!0;return!1},u.prototype.getJoinedCharacters=function(e){if(0===this._characterJoiners.length)return[];var t=this._terminal.buffer.lines.get(e);if(0===t.length)return[];for(var r=[],n=t.translateToString(!0),i=0,o=0,s=0,a=t.getFg(0),l=t.getBg(0),c=0;c<t.getTrimmedLength();c++)if(t.loadCell(c,this._workCell),0!==this._workCell.getWidth()){if(this._workCell.fg!==a||this._workCell.bg!==l){if(1<c-i)for(var u=this._getJoinedRanges(n,s,o,t,i),h=0;h<u.length;h++)r.push(u[h]);i=c,s=o,a=this._workCell.fg,l=this._workCell.bg}o+=this._workCell.getChars().length||f.WHITESPACE_CELL_CHAR.length}if(1<this._terminal.cols-i)for(u=this._getJoinedRanges(n,s,o,t,i),h=0;h<u.length;h++)r.push(u[h]);return r},u.prototype._getJoinedRanges=function(e,t,r,n,i){for(var o=e.substring(t,r),s=this._characterJoiners[0].handler(o),a=1;a<this._characterJoiners.length;a++)for(var l=this._characterJoiners[a].handler(o),c=0;c<l.length;c++)u._mergeRanges(s,l[c]);return this._stringRangesToCellRanges(s,n,i),s},u.prototype._stringRangesToCellRanges=function(e,t,r){var n=0,i=!1,o=0,s=e[n];if(s){for(var a=r;a<this._terminal.cols;a++){var l=t.getWidth(a),c=t.getString(a).length||f.WHITESPACE_CELL_CHAR.length;if(0!==l){if(!i&&s[0]<=o&&(s[0]=a,i=!0),s[1]<=o){if(s[1]=a,!(s=e[++n]))break;i=s[0]<=o&&(s[0]=a,!0)}o+=c}}s&&(s[1]=this._terminal.cols)}},u._mergeRanges=function(e,t){for(var r=!1,n=0;n<e.length;n++){var i=e[n];if(r){if(t[1]<=i[0])return e[n-1][1]=t[1],e;if(t[1]<=i[1])return e[n-1][1]=Math.max(t[1],i[1]),e.splice(n,1),r=!1,e;e.splice(n,1),n--}else{if(t[1]<=i[0])return e.splice(n,0,t),e;if(t[1]<=i[1])return i[0]=Math.min(t[0],i[0]),e;t[0]<i[1]&&(i[0]=Math.min(t[0],i[0]),r=!0)}}return r?e[e.length-1][1]=t[1]:e.push(t),e},u);function u(e){this._terminal=e,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new f.CellData}r.CharacterJoinerRegistry=l},{"../core/buffer/BufferLine":47}],58:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var o,s=e("./BaseRenderLayer"),a=e("../core/buffer/BufferLine"),l=(o=s.BaseRenderLayer,i(c,o),c.prototype.resize=function(e,t){o.prototype.resize.call(this,e,t),this._state={x:null,y:null,isFocused:null,style:null,width:null}},c.prototype.reset=function(e){this._clearCursor(),this._cursorBlinkStateManager&&(this._cursorBlinkStateManager.dispose(),this._cursorBlinkStateManager=null,this.onOptionsChanged(e))},c.prototype.onBlur=function(e){this._cursorBlinkStateManager&&this._cursorBlinkStateManager.pause(),e.refresh(e.buffer.y,e.buffer.y)},c.prototype.onFocus=function(e){this._cursorBlinkStateManager?this._cursorBlinkStateManager.resume(e):e.refresh(e.buffer.y,e.buffer.y)},c.prototype.onOptionsChanged=function(e){var t=this;e.options.cursorBlink?this._cursorBlinkStateManager||(this._cursorBlinkStateManager=new u(e,function(){t._render(e,!0)})):(this._cursorBlinkStateManager&&(this._cursorBlinkStateManager.dispose(),this._cursorBlinkStateManager=null),e.refresh(e.buffer.y,e.buffer.y))},c.prototype.onCursorMove=function(e){this._cursorBlinkStateManager&&this._cursorBlinkStateManager.restartBlinkAnimation(e)},c.prototype.onGridChanged=function(e,t,r){!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isPaused?this._render(e,!1):this._cursorBlinkStateManager.restartBlinkAnimation(e)},c.prototype._render=function(e,t){if(e.cursorState&&!e.cursorHidden){var r=e.buffer.ybase+e.buffer.y,n=r-e.buffer.ydisp;if(n<0||n>=e.rows)this._clearCursor();else if(e.buffer.lines.get(r).loadCell(e.buffer.x,this._cell),void 0!==this._cell.content){if(!e.isFocused)return this._clearCursor(),this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._renderBlurCursor(e,e.buffer.x,n,this._cell),this._ctx.restore(),this._state.x=e.buffer.x,this._state.y=n,this._state.isFocused=!1,this._state.style=e.options.cursorStyle,void(this._state.width=this._cell.getWidth());if(!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isCursorVisible){if(this._state){if(this._state.x===e.buffer.x&&this._state.y===n&&this._state.isFocused===e.isFocused&&this._state.style===e.options.cursorStyle&&this._state.width===this._cell.getWidth())return;this._clearCursor()}this._ctx.save(),this._cursorRenderers[e.options.cursorStyle||"block"](e,e.buffer.x,n,this._cell),this._ctx.restore(),this._state.x=e.buffer.x,this._state.y=n,this._state.isFocused=!1,this._state.style=e.options.cursorStyle,this._state.width=this._cell.getWidth()}else this._clearCursor()}}else this._clearCursor()},c.prototype._clearCursor=function(){this._state&&(this.clearCells(this._state.x,this._state.y,this._state.width,1),this._state={x:null,y:null,isFocused:null,style:null,width:null})},c.prototype._renderBarCursor=function(e,t,r,n){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this.fillLeftLineAtCell(t,r),this._ctx.restore()},c.prototype._renderBlockCursor=function(e,t,r,n){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this.fillCells(t,r,n.getWidth(),1),this._ctx.fillStyle=this._colors.cursorAccent.css,this.fillCharTrueColor(e,n,t,r),this._ctx.restore()},c.prototype._renderUnderlineCursor=function(e,t,r,n){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this.fillBottomLineAtCells(t,r),this._ctx.restore()},c.prototype._renderBlurCursor=function(e,t,r,n){this._ctx.save(),this._ctx.strokeStyle=this._colors.cursor.css,this.strokeRectAtCell(t,r,n.getWidth(),1),this._ctx.restore()},c);function c(e,t,r){var n=o.call(this,e,"cursor",t,!0,r)||this;return n._cell=new a.CellData,n._state={x:null,y:null,isFocused:null,style:null,width:null},n._cursorRenderers={bar:n._renderBarCursor.bind(n),block:n._renderBlockCursor.bind(n),underline:n._renderUnderlineCursor.bind(n)},n}r.CursorRenderLayer=l;var u=(Object.defineProperty(h.prototype,"isPaused",{get:function(){return!(this._blinkStartTimeout||this._blinkInterval)},enumerable:!0,configurable:!0}),h.prototype.dispose=function(){this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=null),this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=null),this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=null)},h.prototype.restartBlinkAnimation=function(e){var t=this;this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=window.requestAnimationFrame(function(){t._renderCallback(),t._animationFrame=null})))},h.prototype._restartInterval=function(e){var t=this;void 0===e&&(e=600),this._blinkInterval&&window.clearInterval(this._blinkInterval),this._blinkStartTimeout=setTimeout(function(){if(t._animationTimeRestarted){var e=600-(Date.now()-t._animationTimeRestarted);if(t._animationTimeRestarted=null,0<e)return void t._restartInterval(e)}t.isCursorVisible=!1,t._animationFrame=window.requestAnimationFrame(function(){t._renderCallback(),t._animationFrame=null}),t._blinkInterval=setInterval(function(){if(t._animationTimeRestarted){var e=600-(Date.now()-t._animationTimeRestarted);return t._animationTimeRestarted=null,void t._restartInterval(e)}t.isCursorVisible=!t.isCursorVisible,t._animationFrame=window.requestAnimationFrame(function(){t._renderCallback(),t._animationFrame=null})},600)},e)},h.prototype.pause=function(){this.isCursorVisible=!0,this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=null),this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=null),this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=null)},h.prototype.resume=function(e){this._animationTimeRestarted=null,this._restartInterval(),this.restartBlinkAnimation(e)},h);function h(e,t){this._renderCallback=t,this.isCursorVisible=!0,e.isFocused&&this._restartInterval()}},{"../core/buffer/BufferLine":47,"./BaseRenderLayer":56}],59:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=(i.prototype.resize=function(e,t){for(var r=0;r<e;r++){this.cache.length<=r&&this.cache.push([]);for(var n=this.cache[r].length;n<t;n++)this.cache[r].push(null);this.cache[r].length=t}this.cache.length=e},i.prototype.clear=function(){for(var e=0;e<this.cache.length;e++)for(var t=0;t<this.cache[e].length;t++)this.cache[e][t]=null},i);function i(){this.cache=[]}r.GridCache=n},{}],60:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var o,s=e("./BaseRenderLayer"),a=e("./atlas/Types"),l=e("./atlas/CharAtlasUtils"),c=(o=s.BaseRenderLayer,i(u,o),u.prototype.resize=function(e,t){o.prototype.resize.call(this,e,t),this._state=null},u.prototype.reset=function(e){this._clearCurrentLink()},u.prototype._clearCurrentLink=function(){if(this._state){this.clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);var e=this._state.y2-this._state.y1-1;0<e&&this.clearCells(0,this._state.y1+1,this._state.cols,e),this.clearCells(0,this._state.y2,this._state.x2,1),this._state=null}},u.prototype._onLinkHover=function(e){if(e.fg===a.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._colors.background.css:l.is256Color(e.fg)?this._ctx.fillStyle=this._colors.ansi[e.fg].css:this._ctx.fillStyle=this._colors.foreground.css,e.y1===e.y2)this.fillBottomLineAtCells(e.x1,e.y1,e.x2-e.x1);else{this.fillBottomLineAtCells(e.x1,e.y1,e.cols-e.x1);for(var t=e.y1+1;t<e.y2;t++)this.fillBottomLineAtCells(0,t,e.cols);this.fillBottomLineAtCells(0,e.y2,e.x2)}this._state=e},u.prototype._onLinkLeave=function(e){this._clearCurrentLink()},u);function u(e,t,r,n){var i=o.call(this,e,"link",t,!0,r)||this;return i._state=null,n.linkifier.onLinkHover(function(e){return i._onLinkHover(e)}),n.linkifier.onLinkLeave(function(e){return i._onLinkLeave(e)}),i}r.LinkRenderLayer=c},{"./BaseRenderLayer":56,"./atlas/CharAtlasUtils":68,"./atlas/Types":73}],61:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var o,s=e("../ui/RenderDebouncer"),a=e("../common/EventEmitter2"),l=e("../common/Lifecycle"),c=e("../ui/ScreenDprMonitor"),u=e("../ui/Lifecycle"),h=(o=l.Disposable,i(f,o),Object.defineProperty(f.prototype,"onDimensionsChange",{get:function(){return this._onDimensionsChange.event},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"onRender",{get:function(){return this._onRender.event},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"onRefreshRequest",{get:function(){return this._onRefreshRequest.event},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"dimensions",{get:function(){return this._renderer.dimensions},enumerable:!0,configurable:!0}),f.prototype._onIntersectionChange=function(e){this._isPaused=0===e.intersectionRatio,!this._isPaused&&this._needsFullRefresh&&(this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)},f.prototype.refreshRows=function(e,t){this._isPaused?this._needsFullRefresh=!0:this._renderDebouncer.refresh(e,t,this._rowCount)},f.prototype._renderRows=function(e,t){this._renderer.renderRows(e,t),this._onRender.fire({start:e,end:t})},f.prototype.resize=function(e,t){this._rowCount=t,this._fireOnCanvasResize()},f.prototype.changeOptions=function(){this._renderer.onOptionsChanged(),this._fireOnCanvasResize()},f.prototype._fireOnCanvasResize=function(){this._renderer.dimensions.canvasWidth===this._canvasWidth&&this._renderer.dimensions.canvasHeight===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions)},f.prototype.setRenderer=function(e){this._renderer.dispose(),this._renderer=e},f.prototype._fullRefresh=function(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount)},f.prototype.setColors=function(e){this._renderer.setColors(e),this._fullRefresh()},f.prototype.onDevicePixelRatioChange=function(){this._renderer.onDevicePixelRatioChange()},f.prototype.onResize=function(e,t){this._renderer.onResize(e,t),this._fullRefresh()},f.prototype.onCharSizeChanged=function(){this._renderer.onCharSizeChanged()},f.prototype.onBlur=function(){this._renderer.onBlur()},f.prototype.onFocus=function(){this._renderer.onFocus()},f.prototype.onSelectionChanged=function(e,t,r){this._renderer.onSelectionChanged(e,t,r)},f.prototype.onCursorMove=function(){this._renderer.onCursorMove()},f.prototype.onOptionsChanged=function(){this._renderer.onOptionsChanged()},f.prototype.clear=function(){this._renderer.clear()},f.prototype.registerCharacterJoiner=function(e){return this._renderer.registerCharacterJoiner(e)},f.prototype.deregisterCharacterJoiner=function(e){return this._renderer.deregisterCharacterJoiner(e)},f);function f(e,t,r){var n=o.call(this)||this;if(n._renderer=e,n._rowCount=t,n._isPaused=!1,n._needsFullRefresh=!1,n._canvasWidth=0,n._canvasHeight=0,n._onDimensionsChange=new a.EventEmitter2,n._onRender=new a.EventEmitter2,n._onRefreshRequest=new a.EventEmitter2,n._renderDebouncer=new s.RenderDebouncer(function(e,t){return n._renderRows(e,t)}),n.register(n._renderDebouncer),n._screenDprMonitor=new c.ScreenDprMonitor,n._screenDprMonitor.setListener(function(){return n._renderer.onDevicePixelRatioChange()}),n.register(n._screenDprMonitor),n.register(u.addDisposableDomListener(window,"resize",function(){return n._renderer.onDevicePixelRatioChange()})),"IntersectionObserver"in window){var i=new IntersectionObserver(function(e){return n._onIntersectionChange(e[e.length-1])},{threshold:0});i.observe(r),n.register({dispose:function(){return i.disconnect()}})}return n}r.RenderCoordinator=h},{"../common/EventEmitter2":41,"../common/Lifecycle":42,"../ui/Lifecycle":77,"../ui/RenderDebouncer":78,"../ui/ScreenDprMonitor":79}],62:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var o,s=e("./TextRenderLayer"),a=e("./SelectionRenderLayer"),l=e("./CursorRenderLayer"),c=e("./LinkRenderLayer"),u=e("../renderer/CharacterJoinerRegistry"),h=e("../common/Lifecycle"),f=(o=h.Disposable,i(d,o),d.prototype.dispose=function(){o.prototype.dispose.call(this),this._renderLayers.forEach(function(e){return e.dispose()})},d.prototype.onDevicePixelRatioChange=function(){this._devicePixelRatio!==window.devicePixelRatio&&(this._devicePixelRatio=window.devicePixelRatio,this.onResize(this._terminal.cols,this._terminal.rows))},d.prototype.setColors=function(e){var t=this;this._colors=e,this._renderLayers.forEach(function(e){e.setColors(t._terminal,t._colors),e.reset(t._terminal)})},d.prototype.onResize=function(e,t){var r=this;this._updateDimensions(),this._renderLayers.forEach(function(e){return e.resize(r._terminal,r.dimensions)}),this._terminal.screenElement.style.width=this.dimensions.canvasWidth+"px",this._terminal.screenElement.style.height=this.dimensions.canvasHeight+"px"},d.prototype.onCharSizeChanged=function(){this.onResize(this._terminal.cols,this._terminal.rows)},d.prototype.onBlur=function(){var t=this;this._runOperation(function(e){return e.onBlur(t._terminal)})},d.prototype.onFocus=function(){var t=this;this._runOperation(function(e){return e.onFocus(t._terminal)})},d.prototype.onSelectionChanged=function(t,r,n){var i=this;void 0===n&&(n=!1),this._runOperation(function(e){return e.onSelectionChanged(i._terminal,t,r,n)})},d.prototype.onCursorMove=function(){var t=this;this._runOperation(function(e){return e.onCursorMove(t._terminal)})},d.prototype.onOptionsChanged=function(){var t=this;this._runOperation(function(e){return e.onOptionsChanged(t._terminal)})},d.prototype.clear=function(){var t=this;this._runOperation(function(e){return e.reset(t._terminal)})},d.prototype._runOperation=function(t){this._renderLayers.forEach(function(e){return t(e)})},d.prototype.renderRows=function(t,r){var n=this;this._renderLayers.forEach(function(e){return e.onGridChanged(n._terminal,t,r)})},d.prototype._updateDimensions=function(){this._terminal.charMeasure.width&&this._terminal.charMeasure.height&&(this.dimensions.scaledCharWidth=Math.floor(this._terminal.charMeasure.width*window.devicePixelRatio),this.dimensions.scaledCharHeight=Math.ceil(this._terminal.charMeasure.height*window.devicePixelRatio),this.dimensions.scaledCellHeight=Math.floor(this.dimensions.scaledCharHeight*this._terminal.options.lineHeight),this.dimensions.scaledCharTop=1===this._terminal.options.lineHeight?0:Math.round((this.dimensions.scaledCellHeight-this.dimensions.scaledCharHeight)/2),this.dimensions.scaledCellWidth=this.dimensions.scaledCharWidth+Math.round(this._terminal.options.letterSpacing),this.dimensions.scaledCharLeft=Math.floor(this._terminal.options.letterSpacing/2),this.dimensions.scaledCanvasHeight=this._terminal.rows*this.dimensions.scaledCellHeight,this.dimensions.scaledCanvasWidth=this._terminal.cols*this.dimensions.scaledCellWidth,this.dimensions.canvasHeight=Math.round(this.dimensions.scaledCanvasHeight/window.devicePixelRatio),this.dimensions.canvasWidth=Math.round(this.dimensions.scaledCanvasWidth/window.devicePixelRatio),this.dimensions.actualCellHeight=this.dimensions.canvasHeight/this._terminal.rows,this.dimensions.actualCellWidth=this.dimensions.canvasWidth/this._terminal.cols)},d.prototype.registerCharacterJoiner=function(e){return this._characterJoinerRegistry.registerCharacterJoiner(e)},d.prototype.deregisterCharacterJoiner=function(e){return this._characterJoinerRegistry.deregisterCharacterJoiner(e)},d);function d(e,t){var r=o.call(this)||this;r._terminal=e,r._colors=t;var n=r._terminal.options.allowTransparency;return r._characterJoinerRegistry=new u.CharacterJoinerRegistry(e),r._renderLayers=[new s.TextRenderLayer(r._terminal.screenElement,0,r._colors,r._characterJoinerRegistry,n),new a.SelectionRenderLayer(r._terminal.screenElement,1,r._colors),new c.LinkRenderLayer(r._terminal.screenElement,2,r._colors,r._terminal),new l.CursorRenderLayer(r._terminal.screenElement,3,r._colors)],r.dimensions={scaledCharWidth:null,scaledCharHeight:null,scaledCellWidth:null,scaledCellHeight:null,scaledCharLeft:null,scaledCharTop:null,scaledCanvasWidth:null,scaledCanvasHeight:null,canvasWidth:null,canvasHeight:null,actualCellWidth:null,actualCellHeight:null},r._devicePixelRatio=window.devicePixelRatio,r._updateDimensions(),r.onOptionsChanged(),r}r.Renderer=f},{"../common/Lifecycle":42,"../renderer/CharacterJoinerRegistry":57,"./CursorRenderLayer":58,"./LinkRenderLayer":60,"./SelectionRenderLayer":63,"./TextRenderLayer":64}],63:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var o,s=e("./BaseRenderLayer"),a=(o=s.BaseRenderLayer,i(l,o),l.prototype._clearState=function(){this._state={start:null,end:null,columnSelectMode:null,ydisp:null}},l.prototype.resize=function(e,t){o.prototype.resize.call(this,e,t),this._clearState()},l.prototype.reset=function(e){this._state.start&&this._state.end&&(this._clearState(),this.clearAll())},l.prototype.onSelectionChanged=function(e,t,r,n){if(this._didStateChange(t,r,n,e.buffer.ydisp))if(this.clearAll(),t&&r){var i=t[1]-e.buffer.ydisp,o=r[1]-e.buffer.ydisp,s=Math.max(i,0),a=Math.min(o,e.rows-1);if(!(s>=e.rows||a<0)){if(this._ctx.fillStyle=this._colors.selection.css,n){var l=t[0],c=r[0]-l,u=a-s+1;this.fillCells(l,s,c,u)}else{l=i===s?t[0]:0;var h=s===a?r[0]:e.cols;this.fillCells(l,s,h-l,1);var f=Math.max(a-s-1,0);if(this.fillCells(0,s+1,e.cols,f),s!==a){var d=o===a?r[0]:e.cols;this.fillCells(0,a,d,1)}}this._state.start=[t[0],t[1]],this._state.end=[r[0],r[1]],this._state.columnSelectMode=n,this._state.ydisp=e.buffer.ydisp}}else this._clearState()},l.prototype._didStateChange=function(e,t,r,n){return!this._areCoordinatesEqual(e,this._state.start)||!this._areCoordinatesEqual(t,this._state.end)||r!==this._state.columnSelectMode||n!==this._state.ydisp},l.prototype._areCoordinatesEqual=function(e,t){return!(!e||!t)&&e[0]===t[0]&&e[1]===t[1]},l);function l(e,t,r){var n=o.call(this,e,"selection",t,!0,r)||this;return n._clearState(),n}r.SelectionRenderLayer=a},{"./BaseRenderLayer":56}],64:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var s,a=e("./GridCache"),o=e("./BaseRenderLayer"),p=e("../core/buffer/BufferLine"),_=e("./CharacterJoinerRegistry"),l=(s=o.BaseRenderLayer,i(c,s),c.prototype.resize=function(e,t){s.prototype.resize.call(this,e,t);var r=this._getFont(e,!1,!1);this._characterWidth===t.scaledCharWidth&&this._characterFont===r||(this._characterWidth=t.scaledCharWidth,this._characterFont=r,this._characterOverlapCache={}),this._state.clear(),this._state.resize(e.cols,e.rows)},c.prototype.reset=function(e){this._state.clear(),this.clearAll()},c.prototype._forEachCell=function(e,t,r,n,i){for(var o=t;o<=r;o++)for(var s=o+e.buffer.ydisp,a=e.buffer.lines.get(s),l=n?n.getJoinedCharacters(s):[],c=0;c<e.cols;c++){a.loadCell(c,this._workCell);var u=this._workCell,h=!1,f=c;if(0!==u.getWidth()){if(0<l.length&&c===l[0][0]){h=!0;var d=l.shift();u=new _.JoinedCellData(this._workCell,a.translateToString(!0,d[0],d[1]),d[1]-d[0]),f=d[1]-1}!h&&this._isOverlapping(u)&&f<a.length-1&&a.getCodePoint(f+1)===p.NULL_CELL_CODE&&(u.content&=-12582913,u.content|=2<<22),i(u,c,o),c=f}}},c.prototype._drawBackground=function(e,t,r){var i=this,o=this._ctx,s=e.cols,a=0,l=0,c=null;o.save(),this._forEachCell(e,t,r,null,function(e,t,r){var n=null;e.isInverse()?n=e.isFgDefault()?i._colors.foreground.css:e.isFgRGB()?"rgb("+p.AttributeData.toColorRGB(e.getFgColor()).join(",")+")":i._colors.ansi[e.getFgColor()].css:e.isBgRGB()?n="rgb("+p.AttributeData.toColorRGB(e.getBgColor()).join(",")+")":e.isBgPalette()&&(n=i._colors.ansi[e.getBgColor()].css),null===c&&(a=t,l=r),r!==l?(o.fillStyle=c,i.fillCells(a,l,s-a,1),a=t,l=r):c!==n&&(o.fillStyle=c,i.fillCells(a,l,t-a,1),a=t,l=r),c=n}),null!==c&&(o.fillStyle=c,this.fillCells(a,l,s-a,1)),o.restore()},c.prototype._drawForeground=function(i,e,t){var o=this;this._forEachCell(i,e,t,this._characterJoinerRegistry,function(e,t,r){if(!e.isInvisible()&&(o.drawChars(i,e,t,r),e.isUnderline())){if(o._ctx.save(),e.isInverse())e.isBgDefault()?o._ctx.fillStyle=o._colors.background.css:e.isBgRGB()?o._ctx.fillStyle="rgb("+p.AttributeData.toColorRGB(e.getBgColor()).join(",")+")":o._ctx.fillStyle=o._colors.ansi[e.getBgColor()].css;else if(e.isFgDefault())o._ctx.fillStyle=o._colors.foreground.css;else if(e.isFgRGB())o._ctx.fillStyle="rgb("+p.AttributeData.toColorRGB(e.getFgColor()).join(",")+")";else{var n=e.getFgColor();i.options.drawBoldTextInBrightColors&&e.isBold()&&n<8&&(n+=8),o._ctx.fillStyle=o._colors.ansi[n].css}o.fillBottomLineAtCells(t,r,e.getWidth()),o._ctx.restore()}})},c.prototype.onGridChanged=function(e,t,r){0!==this._state.cache.length&&(this._charAtlas&&this._charAtlas.beginFrame(),this.clearCells(0,t,e.cols,r-t+1),this._drawBackground(e,t,r),this._drawForeground(e,t,r))},c.prototype.onOptionsChanged=function(e){this.setTransparency(e,e.options.allowTransparency)},c.prototype._isOverlapping=function(e){if(1!==e.getWidth())return!1;if(e.getCode()<256)return!1;var t=e.getChars();if(this._characterOverlapCache.hasOwnProperty(t))return this._characterOverlapCache[t];this._ctx.save(),this._ctx.font=this._characterFont;var r=Math.floor(this._ctx.measureText(t).width)>this._characterWidth;return this._ctx.restore(),this._characterOverlapCache[t]=r},c);function c(e,t,r,n,i){var o=s.call(this,e,"text",t,i,r)||this;return o._characterOverlapCache={},o._workCell=new p.CellData,o._state=new a.GridCache,o._characterJoinerRegistry=n,o}r.TextRenderLayer=l},{"../core/buffer/BufferLine":47,"./BaseRenderLayer":56,"./CharacterJoinerRegistry":57,"./GridCache":59}],65:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=(i.prototype.dispose=function(){},i.prototype.warmUp=function(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)},i.prototype._doWarmUp=function(){},i.prototype.beginFrame=function(){},i);function i(){this._didWarmUp=!1}r.default=n},{}],66:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var c=e("./CharAtlasUtils"),n=e("./DynamicCharAtlas"),i=e("./NoneCharAtlas"),o=e("./StaticCharAtlas"),u={none:i.default,static:o.default,dynamic:n.default},h=[];r.acquireCharAtlas=function(e,t,r,n){for(var i=c.generateConfig(r,n,e,t),o=0;o<h.length;o++){var s=(a=h[o]).ownedBy.indexOf(e);if(0<=s){if(c.configEquals(a.config,i))return a.atlas;1===a.ownedBy.length?(a.atlas.dispose(),h.splice(o,1)):a.ownedBy.splice(s,1);break}}for(o=0;o<h.length;o++){var a=h[o];if(c.configEquals(a.config,i))return a.ownedBy.push(e),a.atlas}var l={atlas:new u[e.options.experimentalCharAtlas](document,i),config:i,ownedBy:[e]};return h.push(l),l.atlas},r.removeTerminalFromCache=function(e){for(var t=0;t<h.length;t++){var r=h[t].ownedBy.indexOf(e);if(-1!==r){1===h[t].ownedBy.length?(h[t].atlas.dispose(),h.splice(t,1)):h[t].ownedBy.splice(r,1);break}}}},{"./CharAtlasUtils":68,"./DynamicCharAtlas":69,"./NoneCharAtlas":71,"./StaticCharAtlas":72}],67:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var h=e("../../common/Platform"),f=e("./Types");function d(e,t){for(var r=!0,n=t.rgba>>>24,i=t.rgba>>>16&255,o=t.rgba>>>8&255,s=0;s<e.data.length;s+=4)e.data[s]===n&&e.data[s+1]===i&&e.data[s+2]===o?e.data[s+3]=0:r=!1;return r}function p(e,t){return e+" "+t.fontSize*t.devicePixelRatio+"px "+t.fontFamily}r.generateStaticCharAtlasTexture=function(e,t,r){var n=r.scaledCharWidth+f.CHAR_ATLAS_CELL_SPACING,i=r.scaledCharHeight+f.CHAR_ATLAS_CELL_SPACING,o=t(255*n,34*i),s=o.getContext("2d",{alpha:r.allowTransparency});s.fillStyle=r.colors.background.css,s.fillRect(0,0,o.width,o.height),s.save(),s.fillStyle=r.colors.foreground.css,s.font=p(r.fontWeight,r),s.textBaseline="middle";for(var a=0;a<256;a++)s.save(),s.beginPath(),s.rect(a*n,0,n,i),s.clip(),s.fillText(String.fromCharCode(a),a*n,i/2),s.restore();for(s.save(),s.font=p(r.fontWeightBold,r),a=0;a<256;a++)s.save(),s.beginPath(),s.rect(a*n,i,n,i),s.clip(),s.fillText(String.fromCharCode(a),a*n,1.5*i),s.restore();s.restore(),s.font=p(r.fontWeight,r);for(var l=0;l<16;l++){var c=(l+2)*i;for(a=0;a<256;a++)s.save(),s.beginPath(),s.rect(a*n,c,n,i),s.clip(),s.fillStyle=r.colors.ansi[l].css,s.fillText(String.fromCharCode(a),a*n,c+i/2),s.restore()}for(s.font=p(r.fontWeightBold,r),l=0;l<16;l++)for(c=(l+2+16)*i,a=0;a<256;a++)s.save(),s.beginPath(),s.rect(a*n,c,n,i),s.clip(),s.fillStyle=r.colors.ansi[l].css,s.fillText(String.fromCharCode(a),a*n,c+i/2),s.restore();if(s.restore(),!("createImageBitmap"in e)||h.isFirefox||h.isSafari)return o;var u=s.getImageData(0,0,o.width,o.height);return d(u,r.colors.background),e.createImageBitmap(u)},r.clearColor=d},{"../../common/Platform":43,"./Types":73}],68:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("../../common/Types");r.generateConfig=function(e,t,r,n){var i={foreground:n.foreground,background:n.background,cursor:null,cursorAccent:null,selection:null,ansi:n.ansi.slice(0,16)};return{type:r.options.experimentalCharAtlas,devicePixelRatio:window.devicePixelRatio,scaledCharWidth:e,scaledCharHeight:t,fontFamily:r.options.fontFamily,fontSize:r.options.fontSize,fontWeight:r.options.fontWeight,fontWeightBold:r.options.fontWeightBold,allowTransparency:r.options.allowTransparency,colors:i}},r.configEquals=function(e,t){for(var r=0;r<e.colors.ansi.length;r++)if(e.colors.ansi[r].rgba!==t.colors.ansi[r].rgba)return!1;return e.type===t.type&&e.devicePixelRatio===t.devicePixelRatio&&e.fontFamily===t.fontFamily&&e.fontSize===t.fontSize&&e.fontWeight===t.fontWeight&&e.fontWeightBold===t.fontWeightBold&&e.allowTransparency===t.allowTransparency&&e.scaledCharWidth===t.scaledCharWidth&&e.scaledCharHeight===t.scaledCharHeight&&e.colors.foreground===t.colors.foreground&&e.colors.background===t.colors.background},r.is256Color=function(e){return e<n.DEFAULT_COLOR}},{"../../common/Types":45}],69:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var u=e("./Types"),o=e("./BaseCharAtlas"),s=e("../../ui/ColorManager"),h=e("./CharAtlasGenerator"),a=e("./LRUMap"),l=e("../../common/Platform"),c={css:"rgba(0, 0, 0, 0)",rgba:0};function f(e){return e.code<<21|e.bg<<12|e.fg<<3|(e.bold?0:4)+(e.dim?0:2)+(e.italic?0:1)}r.getGlyphCacheKey=f;var d,p=(d=o.default,i(_,d),_.prototype.dispose=function(){null!==this._bitmapCommitTimeout&&(window.clearTimeout(this._bitmapCommitTimeout),this._bitmapCommitTimeout=null)},_.prototype.beginFrame=function(){this._drawToCacheCount=0},_.prototype.draw=function(e,t,r,n){if(32===t.code)return!0;if(!this._canCache(t))return!1;var i=f(t),o=this._cacheMap.get(i);if(null!=o)return this._drawFromCache(e,o,r,n),!0;if(this._drawToCacheCount<100){var s=void 0;s=this._cacheMap.size<this._cacheMap.capacity?this._cacheMap.size:this._cacheMap.peek().index;var a=this._drawToCache(t,s);return this._cacheMap.set(i,a),this._drawFromCache(e,a,r,n),!0}return!1},_.prototype._canCache=function(e){return e.code<256},_.prototype._toCoordinateX=function(e){return e%this._width*this._config.scaledCharWidth},_.prototype._toCoordinateY=function(e){return Math.floor(e/this._width)*this._config.scaledCharHeight},_.prototype._drawFromCache=function(e,t,r,n){if(!t.isEmpty){var i=this._toCoordinateX(t.index),o=this._toCoordinateY(t.index);e.drawImage(t.inBitmap?this._bitmap:this._cacheCanvas,i,o,this._config.scaledCharWidth,this._config.scaledCharHeight,r,n,this._config.scaledCharWidth,this._config.scaledCharHeight)}},_.prototype._getColorFromAnsiIndex=function(e){return e<this._config.colors.ansi.length?this._config.colors.ansi[e]:s.DEFAULT_ANSI_COLORS[e]},_.prototype._getBackgroundColor=function(e){return this._config.allowTransparency?c:e.bg===u.INVERTED_DEFAULT_COLOR?this._config.colors.foreground:e.bg<256?this._getColorFromAnsiIndex(e.bg):this._config.colors.background},_.prototype._getForegroundColor=function(e){return e.fg===u.INVERTED_DEFAULT_COLOR?this._config.colors.background:e.fg<256?this._getColorFromAnsiIndex(e.fg):this._config.colors.foreground},_.prototype._drawToCache=function(e,t){this._drawToCacheCount++,this._tmpCtx.save();var r=this._getBackgroundColor(e);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=r.css,this._tmpCtx.fillRect(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight),this._tmpCtx.globalCompositeOperation="source-over";var n=e.bold?this._config.fontWeightBold:this._config.fontWeight,i=e.italic?"italic":"";this._tmpCtx.font=i+" "+n+" "+this._config.fontSize*this._config.devicePixelRatio+"px "+this._config.fontFamily,this._tmpCtx.textBaseline="middle",this._tmpCtx.fillStyle=this._getForegroundColor(e).css,e.dim&&(this._tmpCtx.globalAlpha=u.DIM_OPACITY),this._tmpCtx.fillText(e.chars,0,this._config.scaledCharHeight/2),this._tmpCtx.restore();var o=this._tmpCtx.getImageData(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight),s=!1;this._config.allowTransparency||(s=h.clearColor(o,r));var a=this._toCoordinateX(t),l=this._toCoordinateY(t);this._cacheCtx.putImageData(o,a,l);var c={index:t,isEmpty:s,inBitmap:!1};return this._addGlyphToBitmap(c),c},_.prototype._addGlyphToBitmap=function(e){var t=this;"createImageBitmap"in window&&!l.isFirefox&&!l.isSafari&&(this._glyphsWaitingOnBitmap.push(e),null===this._bitmapCommitTimeout&&(this._bitmapCommitTimeout=window.setTimeout(function(){return t._generateBitmap()},100)))},_.prototype._generateBitmap=function(){var r=this,n=this._glyphsWaitingOnBitmap;this._glyphsWaitingOnBitmap=[],window.createImageBitmap(this._cacheCanvas).then(function(e){r._bitmap=e;for(var t=0;t<n.length;t++)n[t].inBitmap=!0}),this._bitmapCommitTimeout=null},_);function _(e,t){var r=d.call(this)||this;r._config=t,r._drawToCacheCount=0,r._glyphsWaitingOnBitmap=[],r._bitmapCommitTimeout=null,r._bitmap=null,r._cacheCanvas=e.createElement("canvas"),r._cacheCanvas.width=1024,r._cacheCanvas.height=1024,r._cacheCtx=r._cacheCanvas.getContext("2d",{alpha:!0});var n=e.createElement("canvas");n.width=r._config.scaledCharWidth,n.height=r._config.scaledCharHeight,r._tmpCtx=n.getContext("2d",{alpha:r._config.allowTransparency}),r._width=Math.floor(1024/r._config.scaledCharWidth),r._height=Math.floor(1024/r._config.scaledCharHeight);var i=r._width*r._height;return r._cacheMap=new a.default(i),r._cacheMap.prealloc(i),r}r.default=p},{"../../common/Platform":43,"../../ui/ColorManager":76,"./BaseCharAtlas":65,"./CharAtlasGenerator":67,"./LRUMap":70,"./Types":73}],70:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=(i.prototype._unlinkNode=function(e){var t=e.prev,r=e.next;e===this._head&&(this._head=r),e===this._tail&&(this._tail=t),null!==t&&(t.next=r),null!==r&&(r.prev=t)},i.prototype._appendNode=function(e){var t=this._tail;null!==t&&(t.next=e),e.prev=t,e.next=null,this._tail=e,null===this._head&&(this._head=e)},i.prototype.prealloc=function(e){for(var t=this._nodePool,r=0;r<e;r++)t.push({prev:null,next:null,key:null,value:null})},i.prototype.get=function(e){var t=this._map[e];return void 0!==t?(this._unlinkNode(t),this._appendNode(t),t.value):null},i.prototype.peekValue=function(e){var t=this._map[e];return void 0!==t?t.value:null},i.prototype.peek=function(){var e=this._head;return null===e?null:e.value},i.prototype.set=function(e,t){var r=this._map[e];if(void 0!==r)r=this._map[e],this._unlinkNode(r),r.value=t;else if(this.size>=this.capacity)r=this._head,this._unlinkNode(r),delete this._map[r.key],r.key=e,r.value=t,this._map[e]=r;else{var n=this._nodePool;0<n.length?((r=n.pop()).key=e,r.value=t):r={prev:null,next:null,key:e,value:t},this._map[e]=r,this.size++}this._appendNode(r)},i);function i(e){this.capacity=e,this._map={},this._head=null,this._tail=null,this._nodePool=[],this.size=0}r.default=n},{}],71:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var o,s=e("./BaseCharAtlas"),a=(o=s.default,i(l,o),l.prototype.draw=function(e,t,r,n){return!1},l);function l(e,t){return o.call(this)||this}r.default=a},{"./BaseCharAtlas":65}],72:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var o,a=e("./Types"),s=e("./CharAtlasGenerator"),l=e("./BaseCharAtlas"),c=e("./CharAtlasUtils"),u=e("../../common/Types"),h=(o=l.default,i(f,o),f.prototype._doWarmUp=function(){var t=this,e=s.generateStaticCharAtlasTexture(window,this._canvasFactory,this._config);e instanceof HTMLCanvasElement?this._texture=e:e.then(function(e){t._texture=e})},f.prototype._isCached=function(e,t){var r=e.code<256,n=e.fg<16,i=e.fg===u.DEFAULT_COLOR,o=e.bg===u.DEFAULT_COLOR;return r&&(n||i)&&o&&!e.italic},f.prototype.draw=function(e,t,r,n){if(null===this._texture||void 0===this._texture)return!1;var i=0;if(c.is256Color(t.fg)?i=2+t.fg+(t.bold?16:0):t.fg===u.DEFAULT_COLOR&&t.bold&&(i=1),!this._isCached(t,i))return!1;e.save();var o=this._config.scaledCharWidth+a.CHAR_ATLAS_CELL_SPACING,s=this._config.scaledCharHeight+a.CHAR_ATLAS_CELL_SPACING;return t.dim&&(e.globalAlpha=a.DIM_OPACITY),e.drawImage(this._texture,t.code*o,i*s,o,this._config.scaledCharHeight,r,n,o,this._config.scaledCharHeight),e.restore(),!0},f);function f(e,t){var n=o.call(this)||this;return n._document=e,n._config=t,n._canvasFactory=function(e,t){var r=n._document.createElement("canvas");return r.width=e,r.height=t,r},n}r.default=h},{"../../common/Types":45,"./BaseCharAtlas":65,"./CharAtlasGenerator":67,"./CharAtlasUtils":68,"./Types":73}],73:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.INVERTED_DEFAULT_COLOR=257,r.DIM_OPACITY=.5,r.CHAR_ATLAS_CELL_SPACING=1},{}],74:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var o,s=e("./DomRendererRowFactory"),a=e("../atlas/Types"),l=e("../../common/Lifecycle"),c="xterm-dom-renderer-owner-",u="xterm-rows",h="xterm-focus",f="xterm-selection",d=1,p=(o=l.Disposable,i(_,o),_.prototype.dispose=function(){this._terminal.element.classList.remove(c+this._terminalClass),this._terminal.screenElement.removeChild(this._rowContainer),this._terminal.screenElement.removeChild(this._selectionContainer),this._terminal.screenElement.removeChild(this._themeStyleElement),this._terminal.screenElement.removeChild(this._dimensionsStyleElement),o.prototype.dispose.call(this)},_.prototype._updateDimensions=function(){var t=this;this.dimensions.scaledCharWidth=this._terminal.charMeasure.width*window.devicePixelRatio,this.dimensions.scaledCharHeight=Math.ceil(this._terminal.charMeasure.height*window.devicePixelRatio),this.dimensions.scaledCellWidth=this.dimensions.scaledCharWidth+Math.round(this._terminal.options.letterSpacing),this.dimensions.scaledCellHeight=Math.floor(this.dimensions.scaledCharHeight*this._terminal.options.lineHeight),this.dimensions.scaledCharLeft=0,this.dimensions.scaledCharTop=0,this.dimensions.scaledCanvasWidth=this.dimensions.scaledCellWidth*this._terminal.cols,this.dimensions.scaledCanvasHeight=this.dimensions.scaledCellHeight*this._terminal.rows,this.dimensions.canvasWidth=Math.round(this.dimensions.scaledCanvasWidth/window.devicePixelRatio),this.dimensions.canvasHeight=Math.round(this.dimensions.scaledCanvasHeight/window.devicePixelRatio),this.dimensions.actualCellWidth=this.dimensions.canvasWidth/this._terminal.cols,this.dimensions.actualCellHeight=this.dimensions.canvasHeight/this._terminal.rows,this._rowElements.forEach(function(e){e.style.width=t.dimensions.canvasWidth+"px",e.style.height=t.dimensions.actualCellHeight+"px",e.style.lineHeight=t.dimensions.actualCellHeight+"px",e.style.overflow="hidden"}),this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._terminal.screenElement.appendChild(this._dimensionsStyleElement));var e=this._terminalSelector+" ."+u+" span { display: inline-block; height: 100%; vertical-align: top; width: "+this.dimensions.actualCellWidth+"px}";this._dimensionsStyleElement.innerHTML=e,this._selectionContainer.style.height=this._terminal._viewportElement.style.height,this._terminal.screenElement.style.width=this.dimensions.canvasWidth+"px",this._terminal.screenElement.style.height=this.dimensions.canvasHeight+"px"},_.prototype.setColors=function(e){this._colors=e,this._injectCss()},_.prototype._injectCss=function(){var r=this;this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._terminal.screenElement.appendChild(this._themeStyleElement));var n=this._terminalSelector+" ."+u+" { color: "+this._colors.foreground.css+"; background-color: "+this._colors.background.css+"; font-family: "+this._terminal.options.fontFamily+"; font-size: "+this._terminal.options.fontSize+"px;}";n+=this._terminalSelector+" span:not(."+s.BOLD_CLASS+") { font-weight: "+this._terminal.options.fontWeight+";}"+this._terminalSelector+" span."+s.BOLD_CLASS+" { font-weight: "+this._terminal.options.fontWeightBold+";}"+this._terminalSelector+" span."+s.ITALIC_CLASS+" { font-style: italic;}",n+="@keyframes blink { 0% { opacity: 1.0; } 50% { opacity: 0.0; } 100% { opacity: 1.0; }}",n+=this._terminalSelector+" ."+u+":not(."+h+") ."+s.CURSOR_CLASS+" { outline: 1px solid "+this._colors.cursor.css+"; outline-offset: -1px;}"+this._terminalSelector+" ."+u+"."+h+" ."+s.CURSOR_CLASS+"."+s.CURSOR_BLINK_CLASS+" { animation: blink 1s step-end infinite;}"+this._terminalSelector+" ."+u+"."+h+" ."+s.CURSOR_CLASS+"."+s.CURSOR_STYLE_BLOCK_CLASS+" { background-color: "+this._colors.cursor.css+"; color: "+this._colors.cursorAccent.css+";}"+this._terminalSelector+" ."+u+"."+h+" ."+s.CURSOR_CLASS+"."+s.CURSOR_STYLE_BAR_CLASS+" { box-shadow: 1px 0 0 "+this._colors.cursor.css+" inset;}"+this._terminalSelector+" ."+u+"."+h+" ."+s.CURSOR_CLASS+"."+s.CURSOR_STYLE_UNDERLINE_CLASS+" { box-shadow: 0 -1px 0 "+this._colors.cursor.css+" inset;}",n+=this._terminalSelector+" ."+f+" { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}"+this._terminalSelector+" ."+f+" div { position: absolute; background-color: "+this._colors.selection.css+";}",this._colors.ansi.forEach(function(e,t){n+=r._terminalSelector+" .xterm-fg-"+t+" { color: "+e.css+"; }"+r._terminalSelector+" .xterm-bg-"+t+" { background-color: "+e.css+"; }"}),n+=this._terminalSelector+" .xterm-fg-"+a.INVERTED_DEFAULT_COLOR+" { color: "+this._colors.background.css+"; }"+this._terminalSelector+" .xterm-bg-"+a.INVERTED_DEFAULT_COLOR+" { background-color: "+this._colors.foreground.css+"; }",this._themeStyleElement.innerHTML=n},_.prototype.onDevicePixelRatioChange=function(){this._updateDimensions()},_.prototype._refreshRowElements=function(e,t){for(var r=this._rowElements.length;r<=t;r++){var n=document.createElement("div");this._rowContainer.appendChild(n),this._rowElements.push(n)}for(;this._rowElements.length>t;)this._rowContainer.removeChild(this._rowElements.pop())},_.prototype.onResize=function(e,t){this._refreshRowElements(e,t),this._updateDimensions()},_.prototype.onCharSizeChanged=function(){this._updateDimensions()},_.prototype.onBlur=function(){this._rowContainer.classList.remove(h)},_.prototype.onFocus=function(){this._rowContainer.classList.add(h)},_.prototype.onSelectionChanged=function(e,t,r){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(e&&t){var n=e[1]-this._terminal.buffer.ydisp,i=t[1]-this._terminal.buffer.ydisp,o=Math.max(n,0),s=Math.min(i,this._terminal.rows-1);if(!(o>=this._terminal.rows||s<0)){var a=document.createDocumentFragment();if(r)a.appendChild(this._createSelectionElement(o,e[0],t[0],s-o+1));else{var l=n===o?e[0]:0,c=o===s?t[0]:this._terminal.cols;a.appendChild(this._createSelectionElement(o,l,c));var u=s-o-1;if(a.appendChild(this._createSelectionElement(o+1,0,this._terminal.cols,u)),o!==s){var h=i===s?t[0]:this._terminal.cols;a.appendChild(this._createSelectionElement(s,0,h))}}this._selectionContainer.appendChild(a)}}},_.prototype._createSelectionElement=function(e,t,r,n){void 0===n&&(n=1);var i=document.createElement("div");return i.style.height=n*this.dimensions.actualCellHeight+"px",i.style.top=e*this.dimensions.actualCellHeight+"px",i.style.left=t*this.dimensions.actualCellWidth+"px",i.style.width=this.dimensions.actualCellWidth*(r-t)+"px",i},_.prototype.onCursorMove=function(){},_.prototype.onOptionsChanged=function(){this._updateDimensions(),this._injectCss(),this._terminal.refresh(0,this._terminal.rows-1)},_.prototype.clear=function(){this._rowElements.forEach(function(e){return e.innerHTML=""})},_.prototype.renderRows=function(e,t){for(var r=this._terminal,n=r.buffer.ybase+r.buffer.y,i=this._terminal.buffer.x,o=this._terminal.options.cursorBlink,s=e;s<=t;s++){var a=this._rowElements[s];a.innerHTML="";var l=s+r.buffer.ydisp,c=r.buffer.lines.get(l),u=r.options.cursorStyle;a.appendChild(this._rowFactory.createRow(c,l===n,u,i,o,this.dimensions.actualCellWidth,r.cols))}},Object.defineProperty(_.prototype,"_terminalSelector",{get:function(){return"."+c+this._terminalClass},enumerable:!0,configurable:!0}),_.prototype.registerCharacterJoiner=function(e){return-1},_.prototype.deregisterCharacterJoiner=function(e){return!1},_.prototype._onLinkHover=function(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!0)},_.prototype._onLinkLeave=function(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!1)},_.prototype._setCellUnderline=function(e,t,r,n,i,o){for(;e!==t||r!==n;){var s=this._rowElements[r];if(!s)return;var a=s.children[e];a&&(a.style.textDecoration=o?"underline":"none"),++e>=i&&(e=0,r++)}},_);function _(e,t){var r=o.call(this)||this;return r._terminal=e,r._colors=t,r._terminalClass=d++,r._rowElements=[],r._rowContainer=document.createElement("div"),r._rowContainer.classList.add(u),r._rowContainer.style.lineHeight="normal",r._rowContainer.setAttribute("aria-hidden","true"),r._refreshRowElements(r._terminal.cols,r._terminal.rows),r._selectionContainer=document.createElement("div"),r._selectionContainer.classList.add(f),r._selectionContainer.setAttribute("aria-hidden","true"),r.dimensions={scaledCharWidth:null,scaledCharHeight:null,scaledCellWidth:null,scaledCellHeight:null,scaledCharLeft:null,scaledCharTop:null,scaledCanvasWidth:null,scaledCanvasHeight:null,canvasWidth:null,canvasHeight:null,actualCellWidth:null,actualCellHeight:null},r._updateDimensions(),r._injectCss(),r._rowFactory=new s.DomRendererRowFactory(e.options,document),r._terminal.element.classList.add(c+r._terminalClass),r._terminal.screenElement.appendChild(r._rowContainer),r._terminal.screenElement.appendChild(r._selectionContainer),r._terminal.linkifier.onLinkHover(function(e){return r._onLinkHover(e)}),r._terminal.linkifier.onLinkLeave(function(e){return r._onLinkLeave(e)}),r}r.DomRenderer=p},{"../../common/Lifecycle":42,"../atlas/Types":73,"./DomRendererRowFactory":75}],75:[function(e,t,_){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var m=e("../atlas/Types"),y=e("../../core/buffer/BufferLine");_.BOLD_CLASS="xterm-bold",_.DIM_CLASS="xterm-dim",_.ITALIC_CLASS="xterm-italic",_.UNDERLINE_CLASS="xterm-underline",_.CURSOR_CLASS="xterm-cursor",_.CURSOR_BLINK_CLASS="xterm-cursor-blink",_.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",_.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",_.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";var r=(n.prototype.createRow=function(e,t,r,n,i,o,s){for(var a=this._document.createDocumentFragment(),l=0,c=Math.min(e.length,s)-1;0<=c;c--)if(e.loadCell(c,this._workCell).getCode()!==y.NULL_CELL_CODE||t&&c===n){l=c+1;break}for(c=0;c<l;c++){e.loadCell(c,this._workCell);var u=this._workCell.getWidth();if(0!==u){var h=this._document.createElement("span");if(1<u&&(h.style.width=o*u+"px"),t&&c===n)switch(h.classList.add(_.CURSOR_CLASS),i&&h.classList.add(_.CURSOR_BLINK_CLASS),r){case"bar":h.classList.add(_.CURSOR_STYLE_BAR_CLASS);break;case"underline":h.classList.add(_.CURSOR_STYLE_UNDERLINE_CLASS);break;default:h.classList.add(_.CURSOR_STYLE_BLOCK_CLASS)}this._workCell.isBold()&&this._terminalOptions.enableBold&&h.classList.add(_.BOLD_CLASS),this._workCell.isItalic()&&h.classList.add(_.ITALIC_CLASS),this._workCell.isDim()&&h.classList.add(_.DIM_CLASS),this._workCell.isUnderline()&&h.classList.add(_.UNDERLINE_CLASS),h.textContent=this._workCell.getChars()||y.WHITESPACE_CELL_CHAR;var f=this._workCell.isInverse();if(this._workCell.isFgRGB()){var d=h.getAttribute("style")||"";d+=(f?"background-":"")+"color:rgb("+y.AttributeData.toColorRGB(this._workCell.getFgColor()).join(",")+");",h.setAttribute("style",d)}else if(this._workCell.isFgPalette()){var p=this._workCell.getFgColor();this._workCell.isBold()&&p<8&&!f&&this._terminalOptions.enableBold&&this._terminalOptions.drawBoldTextInBrightColors&&(p+=8),h.classList.add("xterm-"+(f?"b":"f")+"g-"+p)}else f&&h.classList.add("xterm-bg-"+m.INVERTED_DEFAULT_COLOR);this._workCell.isBgRGB()?(d=h.getAttribute("style")||"",d+=(f?"":"background-")+"color:rgb("+y.AttributeData.toColorRGB(this._workCell.getBgColor()).join(",")+");",h.setAttribute("style",d)):this._workCell.isBgPalette()?h.classList.add("xterm-"+(f?"f":"b")+"g-"+this._workCell.getBgColor()):f&&h.classList.add("xterm-fg-"+m.INVERTED_DEFAULT_COLOR),a.appendChild(h)}}return a},n);function n(e,t){this._terminalOptions=e,this._document=t,this._workCell=new y.CellData}_.DomRendererRowFactory=r},{"../../core/buffer/BufferLine":47,"../atlas/Types":73}],76:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=u("#ffffff"),s=u("#000000"),a=u("#ffffff"),l=u("#000000"),c={css:"rgba(255, 255, 255, 0.3)",rgba:4294967159};function u(e){return{css:e,rgba:parseInt(e.slice(1),16)<<8|255}}function h(e){var t=e.toString(16);return t.length<2?"0"+t:t}i.DEFAULT_ANSI_COLORS=function(){for(var e=[u("#2e3436"),u("#cc0000"),u("#4e9a06"),u("#c4a000"),u("#3465a4"),u("#75507b"),u("#06989a"),u("#d3d7cf"),u("#555753"),u("#ef2929"),u("#8ae234"),u("#fce94f"),u("#729fcf"),u("#ad7fa8"),u("#34e2e2"),u("#eeeeec")],t=[0,95,135,175,215,255],r=0;r<216;r++){var n=t[r/36%6|0],i=t[r/6%6|0],o=t[r%6];e.push({css:"#"+h(n)+h(i)+h(o),rgba:(n<<24|i<<16|o<<8|255)>>>0})}for(r=0;r<24;r++){var s=8+10*r,a=h(s);e.push({css:"#"+a+a+a,rgba:(s<<24|s<<16|s<<8|255)>>>0})}return e}();var r=(n.prototype.setTheme=function(e){void 0===e&&(e={}),this.colors.foreground=this._parseColor(e.foreground,o),this.colors.background=this._parseColor(e.background,s),this.colors.cursor=this._parseColor(e.cursor,a,!0),this.colors.cursorAccent=this._parseColor(e.cursorAccent,l,!0),this.colors.selection=this._parseColor(e.selection,c,!0),this.colors.ansi[0]=this._parseColor(e.black,i.DEFAULT_ANSI_COLORS[0]),this.colors.ansi[1]=this._parseColor(e.red,i.DEFAULT_ANSI_COLORS[1]),this.colors.ansi[2]=this._parseColor(e.green,i.DEFAULT_ANSI_COLORS[2]),this.colors.ansi[3]=this._parseColor(e.yellow,i.DEFAULT_ANSI_COLORS[3]),this.colors.ansi[4]=this._parseColor(e.blue,i.DEFAULT_ANSI_COLORS[4]),this.colors.ansi[5]=this._parseColor(e.magenta,i.DEFAULT_ANSI_COLORS[5]),this.colors.ansi[6]=this._parseColor(e.cyan,i.DEFAULT_ANSI_COLORS[6]),this.colors.ansi[7]=this._parseColor(e.white,i.DEFAULT_ANSI_COLORS[7]),this.colors.ansi[8]=this._parseColor(e.brightBlack,i.DEFAULT_ANSI_COLORS[8]),this.colors.ansi[9]=this._parseColor(e.brightRed,i.DEFAULT_ANSI_COLORS[9]),this.colors.ansi[10]=this._parseColor(e.brightGreen,i.DEFAULT_ANSI_COLORS[10]),this.colors.ansi[11]=this._parseColor(e.brightYellow,i.DEFAULT_ANSI_COLORS[11]),this.colors.ansi[12]=this._parseColor(e.brightBlue,i.DEFAULT_ANSI_COLORS[12]),this.colors.ansi[13]=this._parseColor(e.brightMagenta,i.DEFAULT_ANSI_COLORS[13]),this.colors.ansi[14]=this._parseColor(e.brightCyan,i.DEFAULT_ANSI_COLORS[14]),this.colors.ansi[15]=this._parseColor(e.brightWhite,i.DEFAULT_ANSI_COLORS[15])},n.prototype._parseColor=function(e,t,r){if(void 0===r&&(r=this.allowTransparency),void 0===e)return t;if(this._ctx.fillStyle=this._litmusColor,this._ctx.fillStyle=e,"string"!=typeof this._ctx.fillStyle)return console.warn("Color: "+e+" is invalid using fallback "+t.css),t;this._ctx.fillRect(0,0,1,1);var n=this._ctx.getImageData(0,0,1,1).data;return r||255===n[3]?{css:e,rgba:(n[0]<<24|n[1]<<16|n[2]<<8|n[3])>>>0}:(console.warn("Color: "+e+" is using transparency, but allowTransparency is false. Using fallback "+t.css+"."),t)},n);function n(e,t){this.allowTransparency=t;var r=e.createElement("canvas");r.width=1,r.height=1;var n=r.getContext("2d");if(!n)throw new Error("Could not get rendering context");this._ctx=n,this._ctx.globalCompositeOperation="copy",this._litmusColor=this._ctx.createLinearGradient(0,0,1,1),this.colors={foreground:o,background:s,cursor:a,cursorAccent:l,selection:c,ansi:i.DEFAULT_ANSI_COLORS.slice()}}i.ColorManager=r},{}],77:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.addDisposableDomListener=function(e,t,r,n){return e.addEventListener(t,r,n),{dispose:function(){r&&e.removeEventListener(t,r,n)}}}},{}],78:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=(i.prototype.dispose=function(){this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},i.prototype.refresh=function(e,t,r){var n=this;this._rowCount=r,e=void 0!==e?e:0,t=void 0!==t?t:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,e):e,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,t):t,this._animationFrame||(this._animationFrame=window.requestAnimationFrame(function(){return n._innerRefresh()}))},i.prototype._innerRefresh=function(){void 0!==this._rowStart&&void 0!==this._rowEnd&&void 0!==this._rowCount&&(this._rowStart=Math.max(this._rowStart,0),this._rowEnd=Math.min(this._rowEnd,this._rowCount-1),this._renderCallback(this._rowStart,this._rowEnd),this._rowStart=void 0,this._rowEnd=void 0,this._animationFrame=void 0)},i);function i(e){this._renderCallback=e}r.RenderDebouncer=n},{}],79:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var o,s=e("../common/Lifecycle"),a=(o=s.Disposable,i(l,o),l.prototype.setListener=function(e){var t=this;this._listener&&this.clearListener(),this._listener=e,this._outerListener=function(){t._listener&&(t._listener(window.devicePixelRatio,t._currentDevicePixelRatio),t._updateDpr())},this._updateDpr()},l.prototype.dispose=function(){o.prototype.dispose.call(this),this.clearListener()},l.prototype._updateDpr=function(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._currentDevicePixelRatio=window.devicePixelRatio,this._resolutionMediaMatchList=window.matchMedia("screen and (resolution: "+window.devicePixelRatio+"dppx)"),this._resolutionMediaMatchList.addListener(this._outerListener))},l.prototype.clearListener=function(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)},l);function l(){var e=null!==o&&o.apply(this,arguments)||this;return e._currentDevicePixelRatio=window.devicePixelRatio,e}r.ScreenDprMonitor=a},{"../common/Lifecycle":42}]},{},[7]);
//# sourceMappingURL=bundle.js.map
